import{S as x,i as ee,s as G,A as Q,B as d,f as C,D as V,E as H,p as z,a6 as It,F as N,K as Y,q as ge,b as j,a3 as Qe,ah as $e,a5 as xe,C as yt,O,I as J,ad as Ct,a2 as bt,G as q,ak as kt,o as w,k as Z,t as A,n as K,N as zt,r as pt,V as ke,ac as vt,x as me,c as B,m as S,l as R,M as Ue,an as Mt,e as _e,j as P,a as X,W as Tt,X as Bt,Y as St,Z as Rt,v as Dt,a7 as Et,g as jt,h as Lt}from"./index.a7e12ebe.js";import{a as Ut}from"./Empty.svelte_svelte_type_style_lang.74438aac.js";import{B as wt}from"./BlockLabel.f1968ceb.js";/* empty css                                                    */import{I as qe}from"./Image.8396c25c.js";import{C as qt,i as Nt,U as Ft,W as Wt}from"./StaticImage.svelte_svelte_type_style_lang.db8103f0.js";import{I as pe,C as Ot,M as Ne}from"./ModifyUpload.0c1399d5.js";import{C as Vt}from"./Copy.3a9e9f32.js";import{U as Ht}from"./Upload.9ce11967.js";import{E as Yt}from"./Empty.04a17357.js";import{D as Jt}from"./Download.166ccb52.js";import"./Blocks.ace4596b.js";import{U as Pt}from"./UploadText.a31d1eb3.js";import{E as ir}from"./Image.09543672.js";import"./ModifyUpload.svelte_svelte_type_style_lang.e946db2d.js";function Xt(t){let e,n,r;return{c(){e=Q("svg"),n=Q("path"),r=Q("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(r,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(r,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(i,u){C(i,e,u),V(e,n),V(e,r)},p:H,i:H,o:H,d(i){i&&z(e)}}}class Qt extends x{constructor(e){super(),ee(this,e,null,Xt,G,{})}}function Gt(t){let e,n,r,i,u,s,o;return{c(){e=Q("svg"),n=Q("circle"),r=Q("circle"),i=Q("circle"),u=Q("circle"),s=Q("circle"),o=Q("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(r,"cx","16"),d(r,"cy","9"),d(r,"r","2"),d(r,"fill","currentColor"),d(i,"cx","22"),d(i,"cy","12"),d(i,"r","2"),d(i,"fill","currentColor"),d(u,"cx","23"),d(u,"cy","18"),d(u,"r","2"),d(u,"fill","currentColor"),d(s,"cx","19"),d(s,"cy","23"),d(s,"r","2"),d(s,"fill","currentColor"),d(o,"fill","currentColor"),d(o,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(l,h){C(l,e,h),V(e,n),V(e,r),V(e,i),V(e,u),V(e,s),V(e,o)},p:H,i:H,o:H,d(l){l&&z(e)}}}class Zt extends x{constructor(e){super(),ee(this,e,null,Gt,G,{})}}function Kt(t){let e,n;return{c(){e=Q("svg"),n=Q("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(r,i){C(r,e,i),V(e,n)},p:H,i:H,o:H,d(r){r&&z(e)}}}class et extends x{constructor(e){super(),ee(this,e,null,Kt,G,{})}}function $t(t){let e,n;return{c(){e=N("img"),Y(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(r,i){C(r,e,i),t[4](e)},p(r,[i]){i&1&&!Y(e.src,n=r[0])&&d(e,"src",n)},i:H,o:H,d(r){r&&z(e),t[4](null)}}}function xt(t,e,n){let{image:r}=e,i;const u=ge();let s;function o(){s.destroy()}function l(){s&&o(),s=new qt(i,{autoCropArea:1,cropend(){const f=s.getCroppedCanvas().toDataURL();u("crop",f)}}),u("crop",r)}function h(f){j[f?"unshift":"push"](()=>{i=f,n(1,i)})}return t.$$set=f=>{"image"in f&&n(0,r=f.image)},[r,i,o,l,h]}class At extends x{constructor(e){super(),ee(this,e,xt,$t,G,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),It()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class tt{constructor(e,n){this.x=e,this.y=n}}class nt extends tt{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const r=e+Math.PI/2;this.x=this.x+Math.sin(r)*n,this.y=this.y-Math.cos(r)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new tt(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const en=30;class tn{constructor({radius:e=en,enabled:n=!0,initialPoint:r={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new nt(r.x,r.y),this.brush=new nt(r.x,r.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function rt(t,e,n){const r=t.slice();return r[61]=e[n].name,r[62]=e[n].zIndex,r[63]=e,r[64]=n,r}function st(t){let e,n,r;return{c(){e=N("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-1nz44y8")},m(i,u){C(i,e,u),r=!0},i(i){r||(Qe(()=>{n||(n=$e(e,xe,{duration:50},!0)),n.run(1)}),r=!0)},o(i){n||(n=$e(e,xe,{duration:50},!1)),n.run(0),r=!1},d(i){i&&z(e),i&&n&&n.end()}}}function it(t){let e,n,r=t[61],i,u;const s=()=>t[30](e,r),o=()=>t[30](null,r);return{c(){e=N("canvas"),d(e,"key",n=t[61]),yt(e,"z-index",t[62]),d(e,"class","svelte-1nz44y8"),O(e,"lr",t[5]),O(e,"tb",!t[5])},m(l,h){C(l,e,h),s(),i||(u=[J(e,"mousedown",t[61]==="interface"?t[7]:void 0),J(e,"mousemove",t[61]==="interface"?t[8]:void 0),J(e,"mouseup",t[61]==="interface"?t[9]:void 0),J(e,"mouseout",t[61]==="interface"?t[9]:void 0),J(e,"blur",t[61]==="interface"?t[9]:void 0),J(e,"touchstart",t[61]==="interface"?t[7]:void 0),J(e,"touchmove",t[61]==="interface"?t[8]:void 0),J(e,"touchend",t[61]==="interface"?t[9]:void 0),J(e,"touchcancel",t[61]==="interface"?t[9]:void 0),J(e,"click",Ct(t[29]))],i=!0)},p(l,h){t=l,r!==t[61]&&(o(),r=t[61],s()),h[0]&32&&O(e,"lr",t[5]),h[0]&32&&O(e,"tb",!t[5])},d(l){l&&z(e),o(),i=!1,bt(u)}}}function nn(t){let e,n,r,i,u=t[4]===0&&st(),s=t[6],o=[];for(let l=0;l<s.length;l+=1)o[l]=it(rt(t,s,l));return{c(){e=N("div"),u&&u.c(),n=q();for(let l=0;l<o.length;l+=1)o[l].c();d(e,"class","wrap svelte-1nz44y8"),Qe(()=>t[32].call(e))},m(l,h){C(l,e,h),u&&u.m(e,null),V(e,n);for(let f=0;f<o.length;f+=1)o[f].m(e,null);t[31](e),r=kt(e,t[32].bind(e)),i=!0},p(l,h){if(l[4]===0?u?h[0]&16&&w(u,1):(u=st(),u.c(),w(u,1),u.m(e,n)):u&&(Z(),A(u,1,1,()=>{u=null}),K()),h[0]&993){s=l[6];let f;for(f=0;f<s.length;f+=1){const g=rt(l,s,f);o[f]?o[f].p(g,h):(o[f]=it(g),o[f].c(),o[f].m(e,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=s.length}},i(l){i||(w(u),i=!0)},o(l){A(u),i=!1},d(l){l&&z(e),u&&u.d(),zt(o,l),t[31](null),r()}}}let rn="#aaa";function lt(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function sn(t,e,n){let r;const i=ge();let{value:u}=e,{value_img:s}=e,{mode:o="sketch"}=e,{brush_color:l="#0b0f19"}=e,{brush_radius:h}=e,{source:f}=e,{width:g=400}=e,{height:a=200}=e,{container_height:_=200}=e,{shape:b}=e,I,v=g,L=a,te;const de=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let D={},k={},F=[],U=[],ne=!0,fe=!0,re=!1,se=!1,W=null,p=null,$=null,ie=0;function le(){if(!b){k.temp.drawImage(s,0,0,g,a);return}let c=s.naturalWidth,y=s.naturalHeight;const M=b[0]/b[1],T=c/y;let E=0,m=0;M<T?(c=b[1]*T,y=b[1],E=(b[0]-c)/2):M>T?(c=b[0],y=b[0]/T,m=(b[1]-y)/2):(E=0,m=0,c=b[0],y=b[1]),k.temp.drawImage(s,E,m,c,y)}pt(async()=>{Object.keys(D).forEach(c=>{n(26,k[c]=D[c].getContext("2d"),k)}),await ke(),s&&(s.addEventListener("load",c=>{f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):le(),k.drawing.drawImage(D.temp,0,0,g,a),oe()}),setTimeout(()=>{f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):le(),k.drawing.drawImage(D.temp,0,0,g,a),be({lines:U.slice()}),oe()},100)),n(28,W=new tn({radius:h*.05,enabled:!0,initialPoint:{x:g/2,y:a/2}})),$=new Nt((c,y,...M)=>{Be(c,y)}),$.observe(p),Ie(),n(24,I=!0),requestAnimationFrame(()=>{ue(),requestAnimationFrame(()=>{ce()})})});function ue(){const c=g/2,y=a/2;W.update({x:c,y},{both:!0}),W.update({x:c,y},{both:!1}),ne=!0,fe=!0}vt(()=>{n(24,I=!1),$.unobserve(p)});function Fe(){const c=U.slice(0,-1);Ae(),s&&(f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):le(),(!U||!U.length)&&k.drawing.drawImage(D.temp,0,0,g,a)),be({lines:c}),n(4,ie=c.length),U.length&&n(27,U=c),U.length==0&&i("clear"),oe()}function We(){console.log("first init",U,s),Ae(),s&&le(),be({lines:U}),n(4,ie=U.length),U.length==0&&i("clear"),oe()}let be=({lines:c})=>{const y=l;c.forEach(M=>{let{points:T,brush_color:E,brush_radius:m}=M;we(o==="mask"?{points:T,brush_color:y,brush_radius:m}:{points:T,brush_color:E,brush_radius:m}),o==="mask"&&De({points:T,brush_color:y,brush_radius:m}),F=T}),je({brush_color:l,brush_radius:h}),o==="mask"&&Ee()},Oe=c=>{c.preventDefault(),se=!0;const{x:y,y:M}=Se(c);c.touches&&c.touches.length>0&&W.update({x:y,y:M},{both:!0}),Re(y,M),n(4,ie+=1)},Ce=c=>{c.preventDefault();const{x:y,y:M}=Se(c);Re(y,M)},Ve=c=>{c.preventDefault(),Ce(c),re=!1,se=!1,je(),o==="mask"&&Ee()},ze=0,ve=0,Me=0,Te=!1,Be=async()=>{if(b&&p){const M=p?.getBoundingClientRect(),T=b[0]/b[1],E=M.width/M.height;n(5,Te=T<E)}if(g===ze&&a===ve&&Me===_)return;const c={width:g,height:a},y={height:_,width:_*(c.width/c.height)};await Promise.all([he(D.interface,c,y),he(D.drawing,c,y),he(D.temp,c,y),he(D.temp_fake,c,y),he(D.mask,c,y,!1)]),h||n(10,h=20*(c.width/y.width)),Ie({once:!0}),setTimeout(()=>{ve=a,ze=g,Me=_},10),await ke(),ce()},he=async(c,y,M,T=!0)=>{if(!I)return;await ke();const E=window.devicePixelRatio||1;c.width=y.width*(T?E:1),c.height=y.height*(T?E:1);const m=c.getContext("2d");T&&m.scale(E,E),c.style.width=`${M.width}px`,c.style.height=`${M.height}px`},Se=c=>{const y=D.interface.getBoundingClientRect();let M=c.clientX,T=c.clientY;return c.changedTouches&&c.changedTouches.length>0&&(M=c.changedTouches[0].clientX,T=c.changedTouches[0].clientY),{x:(M-y.left)/y.width*g,y:(T-y.top)/y.height*a}},Re=(c,y)=>{W.update({x:c,y});const M=!W.isEnabled();(se&&!re||M&&se)&&(re=!0,F.push(W.brush.toObject())),re&&(F.push(W.brush.toObject()),we({points:F,brush_color:l,brush_radius:h}),o==="mask"&&De({points:F,brush_color:l,brush_radius:h})),ne=!0},we=({points:c,brush_color:y,brush_radius:M})=>{if(!c||c.length<2||(n(26,k.temp.lineJoin="round",k),n(26,k.temp.lineCap="round",k),n(26,k.temp.strokeStyle=y,k),n(26,k.temp.lineWidth=M,k),!c||c.length<2))return;let T=c[0],E=c[1];k.temp.moveTo(E.x,E.y),k.temp.beginPath();for(var m=1,ae=c.length;m<ae;m++){var ye=lt(T,E);k.temp.quadraticCurveTo(T.x,T.y,ye.x,ye.y),T=c[m],E=c[m+1]}k.temp.lineTo(T.x,T.y),k.temp.stroke()},De=({points:c,brush_color:y,brush_radius:M})=>{if(!c||c.length<2)return;n(26,k.temp_fake.lineJoin="round",k),n(26,k.temp_fake.lineCap="round",k),n(26,k.temp_fake.strokeStyle="#fff",k),n(26,k.temp_fake.lineWidth=M,k);let T=c[0],E=c[1];k.temp_fake.moveTo(E.x,E.y),k.temp_fake.beginPath();for(var m=1,ae=c.length;m<ae;m++){var ye=lt(T,E);k.temp_fake.quadraticCurveTo(T.x,T.y,ye.x,ye.y),T=c[m],E=c[m+1]}k.temp_fake.lineTo(T.x,T.y),k.temp_fake.stroke()},Ee=()=>{F.length<1||(F.length=0,k.mask.drawImage(D.temp_fake,0,0,g,a),oe())},je=()=>{F.length<1||(U.push({points:F.slice(),brush_color:l,brush_radius:h}),o!=="mask"&&(F.length=0),k.drawing.drawImage(D.temp,0,0,g,a),oe())},oe=()=>{const c=Le();i("change",c)};function ce(){return n(27,U=[]),Ae(),n(4,ie=0),!0}function Ae(){fe=!0,k.temp.clearRect(0,0,g,a),n(26,k.temp.fillStyle=o==="mask"?"transparent":"#FFFFFF",k),k.temp.fillRect(0,0,g,a),o==="mask"&&(k.temp_fake.clearRect(0,0,D.temp_fake.width,D.temp_fake.height),k.mask.clearRect(0,0,g,a),n(26,k.mask.fillStyle="#000",k),k.mask.fillRect(0,0,g,a))}let Ie=({once:c=!1}={})=>{if(ne||fe){const y=W.getPointerCoordinates(),M=W.getBrushCoordinates();He(k.interface,y,M),ne=!1,fe=!1}c||window.requestAnimationFrame(()=>{Ie()})},He=(c,y,M)=>{c.clearRect(0,0,g,a),c.beginPath(),c.fillStyle=l,c.arc(M.x,M.y,h/2,0,Math.PI*2,!0),c.fill(),c.beginPath(),c.fillStyle=rn,c.arc(M.x,M.y,r,0,Math.PI*2,!0),c.fill()};function Le(){return o==="mask"?D.mask.toDataURL("image/jpg"):D.drawing.toDataURL("image/jpg")}function Ye(c){me.call(this,t,c)}function Je(c,y){j[c?"unshift":"push"](()=>{D[y]=c,n(0,D)})}function Pe(c){j[c?"unshift":"push"](()=>{p=c,n(3,p)})}function Xe(){v=this.offsetWidth,L=this.offsetHeight,n(1,v),n(2,L)}return t.$$set=c=>{"value"in c&&n(13,u=c.value),"value_img"in c&&n(14,s=c.value_img),"mode"in c&&n(15,o=c.mode),"brush_color"in c&&n(16,l=c.brush_color),"brush_radius"in c&&n(10,h=c.brush_radius),"source"in c&&n(17,f=c.source),"width"in c&&n(11,g=c.width),"height"in c&&n(12,a=c.height),"container_height"in c&&n(18,_=c.container_height),"shape"in c&&n(19,b=c.shape)},t.$$.update=()=>{t.$$.dirty[0]&530432&&b&&(g||a)&&(n(11,g=b[0]),n(12,a=b[1])),t.$$.dirty[0]&16785408&&I&&!u&&ce(),t.$$.dirty[0]&251811841&&I&&s!==te&&(n(25,te=s),ce(),setTimeout(()=>{f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):le(),k.drawing.drawImage(D.temp,0,0,g,a),be({lines:U.slice()}),oe()},50)),t.$$.dirty[0]&268436480&&W&&(ue(),W.setRadius(h*.05)),t.$$.dirty[0]&6144&&(g||a)&&Be(),t.$$.dirty[0]&1024&&(r=h*.075)},[D,v,L,p,ie,Te,de,Oe,Ce,Ve,h,g,a,u,s,o,l,f,_,b,Fe,We,ce,Le,I,te,k,U,W,Ye,Je,Pe,Xe]}class Ge extends x{constructor(e){super(),ee(this,e,sn,nn,G,{value:13,value_img:14,mode:15,brush_color:16,brush_radius:10,source:17,width:11,height:12,container_height:18,shape:19,undo:20,redraw:21,clear:22,get_image_data:23},null,[-1,-1,-1])}get undo(){return this.$$.ctx[20]}get redraw(){return this.$$.ctx[21]}get clear(){return this.$$.ctx[22]}get get_image_data(){return this.$$.ctx[23]}}function ln(t){let e,n,r,i,u,s,o;return n=new pe({props:{Icon:Ft,label:"Undo"}}),n.$on("click",t[1]),i=new pe({props:{Icon:Vt,label:"Redraw"}}),i.$on("click",t[2]),s=new pe({props:{Icon:Ot,label:"Clear"}}),s.$on("click",t[3]),{c(){e=N("div"),B(n.$$.fragment),r=q(),B(i.$$.fragment),u=q(),B(s.$$.fragment),d(e,"class","svelte-s6ybro")},m(l,h){C(l,e,h),S(n,e,null),V(e,r),S(i,e,null),V(e,u),S(s,e,null),o=!0},p:H,i(l){o||(w(n.$$.fragment,l),w(i.$$.fragment,l),w(s.$$.fragment,l),o=!0)},o(l){A(n.$$.fragment,l),A(i.$$.fragment,l),A(s.$$.fragment,l),o=!1},d(l){l&&z(e),R(n),R(i),R(s)}}}function un(t){const e=ge();return[e,()=>e("undo"),()=>e("redraw"),u=>{e("clear"),u.stopPropagation()}]}class Ze extends x{constructor(e){super(),ee(this,e,un,ln,G,{})}}function ut(t){let e,n,r,i,u;return{c(){e=N("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[5])),d(e,"max",r=75*(t[2]/t[5])),d(e,"class","svelte-p4aq0j")},m(s,o){C(s,e,o),Ue(e,t[0]),i||(u=[J(e,"change",t[10]),J(e,"input",t[10])],i=!0)},p(s,o){o&36&&n!==(n=.5*(s[2]/s[5]))&&d(e,"min",n),o&36&&r!==(r=75*(s[2]/s[5]))&&d(e,"max",r),o&1&&Ue(e,s[0])},d(s){s&&z(e),i=!1,bt(u)}}}function on(t){let e,n,r,i;n=new pe({props:{Icon:Zt,label:"Select brush color"}}),n.$on("click",t[11]);let u=t[4]&&ot(t);return{c(){e=N("span"),B(n.$$.fragment),r=q(),u&&u.c(),d(e,"class","col svelte-p4aq0j")},m(s,o){C(s,e,o),S(n,e,null),V(e,r),u&&u.m(e,null),i=!0},p(s,o){s[4]?u?u.p(s,o):(u=ot(s),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(s){i||(w(n.$$.fragment,s),i=!0)},o(s){A(n.$$.fragment,s),i=!1},d(s){s&&z(e),R(n),u&&u.d()}}}function ot(t){let e,n,r;return{c(){e=N("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-p4aq0j")},m(i,u){C(i,e,u),Ue(e,t[1]),n||(r=J(e,"input",t[12]),n=!0)},p(i,u){u&2&&Ue(e,i[1])},d(i){i&&z(e),n=!1,r()}}}function an(t){let e,n,r,i,u,s;r=new pe({props:{Icon:Qt,label:"Use brush"}}),r.$on("click",t[9]);let o=t[3]&&ut(t),l=on(t);return{c(){e=N("div"),n=N("span"),B(r.$$.fragment),i=q(),o&&o.c(),u=q(),l&&l.c(),d(n,"class","brush svelte-p4aq0j"),d(e,"class","wrap svelte-p4aq0j")},m(h,f){C(h,e,f),V(e,n),S(r,n,null),V(n,i),o&&o.m(n,null),V(e,u),l&&l.m(e,null),s=!0},p(h,[f]){h[3]?o?o.p(h,f):(o=ut(h),o.c(),o.m(n,null)):o&&(o.d(1),o=null),l.p(h,f)},i(h){s||(w(r.$$.fragment,h),w(l),s=!0)},o(h){A(r.$$.fragment,h),A(l),s=!1},d(h){h&&z(e),R(r),o&&o.d(),l&&l.d()}}}function fn(t,e,n){let r;ge();let i=!1,u=!1,{brush_radius:s=20}=e,{brush_color:o="#000"}=e,{container_height:l}=e,{img_width:h}=e,{img_height:f}=e,{mode:g="other"}=e;const a=()=>n(3,i=!i);function _(){s=Mt(this.value),n(0,s)}const b=()=>n(4,u=!u);function I(){o=this.value,n(1,o)}return t.$$set=v=>{"brush_radius"in v&&n(0,s=v.brush_radius),"brush_color"in v&&n(1,o=v.brush_color),"container_height"in v&&n(6,l=v.container_height),"img_width"in v&&n(2,h=v.img_width),"img_height"in v&&n(7,f=v.img_height),"mode"in v&&n(8,g=v.mode)},t.$$.update=()=>{t.$$.dirty&196&&n(5,r=l*(h/f))},[s,o,h,i,u,r,l,f,g,a,_,b,I]}class Ke extends x{constructor(e){super(),ee(this,e,fn,an,G,{brush_radius:0,brush_color:1,container_height:6,img_width:2,img_height:7,mode:8})}}function _n(t){let e,n;return{c(){e=N("img"),Y(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-rlgzoo"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(r,i){C(r,e,i)},p(r,i){i[0]&1&&!Y(e.src,n=r[0].image||r[0])&&d(e,"src",n),i[0]&544&&O(e,"webcam",r[5]==="webcam"&&r[9])},i:H,o:H,d(r){r&&z(e)}}}function hn(t){let e=t[20],n,r,i,u=at(t),s=t[15]>0&&ft(t);return{c(){u.c(),n=q(),s&&s.c(),r=_e()},m(o,l){u.m(o,l),C(o,n,l),s&&s.m(o,l),C(o,r,l),i=!0},p(o,l){l[0]&1048576&&G(e,e=o[20])?(u.d(1),u=at(o),u.c(),u.m(n.parentNode,n)):u.p(o,l),o[15]>0?s?(s.p(o,l),l[0]&32768&&w(s,1)):(s=ft(o),s.c(),w(s,1),s.m(r.parentNode,r)):s&&(Z(),A(s,1,1,()=>{s=null}),K())},i(o){i||(w(s),i=!0)},o(o){A(s),i=!1},d(o){u.d(o),o&&z(n),s&&s.d(o),o&&z(r)}}}function cn(t){let e,n,r,i,u;return e=new Ne({props:{editable:!0}}),e.$on("edit",t[51]),e.$on("clear",t[23]),{c(){B(e.$$.fragment),n=q(),r=N("img"),Y(r.src,i=t[0])||d(r,"src",i),d(r,"alt",""),d(r,"class","svelte-rlgzoo"),O(r,"webcam",t[5]==="webcam"&&t[9])},m(s,o){S(e,s,o),C(s,n,o),C(s,r,o),u=!0},p(s,o){(!u||o[0]&1&&!Y(r.src,i=s[0]))&&d(r,"src",i),o[0]&544&&O(r,"webcam",s[5]==="webcam"&&s[9])},i(s){u||(w(e.$$.fragment,s),u=!0)},o(s){A(e.$$.fragment,s),u=!1},d(s){R(e,s),s&&z(n),s&&z(r)}}}function mn(t){let e,n,r,i,u={image:t[0]};return e=new At({props:u}),t[49](e),e.$on("crop",t[24]),r=new Ne({}),r.$on("clear",t[50]),{c(){B(e.$$.fragment),n=q(),B(r.$$.fragment)},m(s,o){S(e,s,o),C(s,n,o),S(r,s,o),i=!0},p(s,o){const l={};o[0]&1&&(l.image=s[0]),e.$set(l)},i(s){i||(w(e.$$.fragment,s),w(r.$$.fragment,s),i=!0)},o(s){A(e.$$.fragment,s),A(r.$$.fragment,s),i=!1},d(s){t[49](null),R(e,s),s&&z(n),R(r,s)}}}function gn(t){let e,n,r=t[5]==="webcam"&&!t[20]&&ht(t);return{c(){r&&r.c(),e=_e()},m(i,u){r&&r.m(i,u),C(i,e,u),n=!0},p(i,u){i[5]==="webcam"&&!i[20]?r?(r.p(i,u),u[0]&1048608&&w(r,1)):(r=ht(i),r.c(),w(r,1),r.m(e.parentNode,e)):r&&(Z(),A(r,1,1,()=>{r=null}),K())},i(i){n||(w(r),n=!0)},o(i){A(r),n=!1},d(i){r&&r.d(i),i&&z(e)}}}function dn(t){let e,n,r,i,u,s,o;e=new Ze({}),e.$on("undo",t[40]),e.$on("redraw",t[41]),e.$on("clear",t[26]);let l=t[1]==="color-sketch"&&ct(t);function h(a){t[44](a)}function f(a){t[45](a)}let g={value:t[0],mode:t[12],width:t[15]||t[19],height:t[14]||t[18],container_height:t[16]||t[18],shape:t[6]};return t[2]!==void 0&&(g.brush_radius=t[2]),t[21]!==void 0&&(g.brush_color=t[21]),i=new Ge({props:g}),j.push(()=>X(i,"brush_radius",h)),j.push(()=>X(i,"brush_color",f)),t[46](i),i.$on("change",t[24]),i.$on("clear",t[26]),{c(){B(e.$$.fragment),n=q(),l&&l.c(),r=q(),B(i.$$.fragment)},m(a,_){S(e,a,_),C(a,n,_),l&&l.m(a,_),C(a,r,_),S(i,a,_),o=!0},p(a,_){a[1]==="color-sketch"?l?(l.p(a,_),_[0]&2&&w(l,1)):(l=ct(a),l.c(),w(l,1),l.m(r.parentNode,r)):l&&(Z(),A(l,1,1,()=>{l=null}),K());const b={};_[0]&1&&(b.value=a[0]),_[0]&4096&&(b.mode=a[12]),_[0]&557056&&(b.width=a[15]||a[19]),_[0]&278528&&(b.height=a[14]||a[18]),_[0]&327680&&(b.container_height=a[16]||a[18]),_[0]&64&&(b.shape=a[6]),!u&&_[0]&4&&(u=!0,b.brush_radius=a[2],P(()=>u=!1)),!s&&_[0]&2097152&&(s=!0,b.brush_color=a[21],P(()=>s=!1)),i.$set(b)},i(a){o||(w(e.$$.fragment,a),w(l),w(i.$$.fragment,a),o=!0)},o(a){A(e.$$.fragment,a),A(l),A(i.$$.fragment,a),o=!1},d(a){R(e,a),a&&z(n),l&&l.d(a),a&&z(r),t[46](null),R(i,a)}}}function bn(t){let e,n,r;function i(s){t[39](s)}let u={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[yn]},$$scope:{ctx:t}};return t[11]!==void 0&&(u.dragging=t[11]),e=new Ht({props:u}),j.push(()=>X(e,"dragging",i)),e.$on("load",t[22]),{c(){B(e.$$.fragment)},m(s,o){S(e,s,o),r=!0},p(s,o){const l={};o[0]&1&&(l.disable_click=!!s[0]),o[0]&4191975|o[1]&1073741824&&(l.$$scope={dirty:o,ctx:s}),!n&&o[0]&2048&&(n=!0,l.dragging=s[11],P(()=>n=!1)),e.$set(l)},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){R(e,s)}}}function at(t){let e,n,r,i;return{c(){e=N("img"),d(e,"class","absolute-img svelte-rlgzoo"),Y(e.src,n=t[20]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt","load-1"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(u,s){C(u,e,s),t[52](e),r||(i=J(e,"load",t[25]),r=!0)},p(u,s){s[0]&1048577&&!Y(e.src,n=u[20]||u[0]?.image||u[0])&&d(e,"src",n),s[0]&544&&O(e,"webcam",u[5]==="webcam"&&u[9])},d(u){u&&z(e),t[52](null),r=!1,i()}}}function ft(t){let e,n,r,i,u,s,o,l;function h(_){t[54](_)}function f(_){t[55](_)}let g={value:t[0],mode:t[12],width:t[15]||t[19],height:t[14]||t[18],container_height:t[16]||t[18],value_img:t[17],source:t[5]};t[2]!==void 0&&(g.brush_radius=t[2]),t[21]!==void 0&&(g.brush_color=t[21]),e=new Ge({props:g}),t[53](e),j.push(()=>X(e,"brush_radius",h)),j.push(()=>X(e,"brush_color",f)),e.$on("change",t[24]),u=new Ze({}),u.$on("undo",t[56]),u.$on("redraw",t[57]),u.$on("clear",t[26]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&_t(t);return{c(){B(e.$$.fragment),i=q(),B(u.$$.fragment),s=q(),a&&a.c(),o=_e()},m(_,b){S(e,_,b),C(_,i,b),S(u,_,b),C(_,s,b),a&&a.m(_,b),C(_,o,b),l=!0},p(_,b){const I={};b[0]&1&&(I.value=_[0]),b[0]&4096&&(I.mode=_[12]),b[0]&557056&&(I.width=_[15]||_[19]),b[0]&278528&&(I.height=_[14]||_[18]),b[0]&327680&&(I.container_height=_[16]||_[18]),b[0]&131072&&(I.value_img=_[17]),b[0]&32&&(I.source=_[5]),!n&&b[0]&4&&(n=!0,I.brush_radius=_[2],P(()=>n=!1)),!r&&b[0]&2097152&&(r=!0,I.brush_color=_[21],P(()=>r=!1)),e.$set(I),_[1]==="color-sketch"||_[1]==="sketch"?a?(a.p(_,b),b[0]&2&&w(a,1)):(a=_t(_),a.c(),w(a,1),a.m(o.parentNode,o)):a&&(Z(),A(a,1,1,()=>{a=null}),K())},i(_){l||(w(e.$$.fragment,_),w(u.$$.fragment,_),w(a),l=!0)},o(_){A(e.$$.fragment,_),A(u.$$.fragment,_),A(a),l=!1},d(_){t[53](null),R(e,_),_&&z(i),R(u,_),_&&z(s),a&&a.d(_),_&&z(o)}}}function _t(t){let e,n,r,i;function u(l){t[58](l)}function s(l){t[59](l)}let o={container_height:t[16]||t[18],img_width:t[15]||t[19],img_height:t[14]||t[18],mode:t[12]};return t[2]!==void 0&&(o.brush_radius=t[2]),t[21]!==void 0&&(o.brush_color=t[21]),e=new Ke({props:o}),j.push(()=>X(e,"brush_radius",u)),j.push(()=>X(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(l,h){S(e,l,h),i=!0},p(l,h){const f={};h[0]&327680&&(f.container_height=l[16]||l[18]),h[0]&557056&&(f.img_width=l[15]||l[19]),h[0]&278528&&(f.img_height=l[14]||l[18]),h[0]&4096&&(f.mode=l[12]),!n&&h[0]&4&&(n=!0,f.brush_radius=l[2],P(()=>n=!1)),!r&&h[0]&2097152&&(r=!0,f.brush_color=l[21],P(()=>r=!1)),e.$set(f)},i(l){i||(w(e.$$.fragment,l),i=!0)},o(l){A(e.$$.fragment,l),i=!1},d(l){R(e,l)}}}function ht(t){let e,n;return e=new Wt({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[47]),e.$on("stream",t[24]),e.$on("error",t[48]),{c(){B(e.$$.fragment)},m(r,i){S(e,r,i),n=!0},p(r,i){const u={};i[0]&128&&(u.streaming=r[7]),i[0]&256&&(u.pending=r[8]),i[0]&512&&(u.mirror_webcam=r[9]),e.$set(u)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function ct(t){let e,n,r,i;function u(l){t[42](l)}function s(l){t[43](l)}let o={container_height:t[16]||t[18],img_width:t[15]||t[19],img_height:t[14]||t[18]};return t[2]!==void 0&&(o.brush_radius=t[2]),t[21]!==void 0&&(o.brush_color=t[21]),e=new Ke({props:o}),j.push(()=>X(e,"brush_radius",u)),j.push(()=>X(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(l,h){S(e,l,h),i=!0},p(l,h){const f={};h[0]&327680&&(f.container_height=l[16]||l[18]),h[0]&557056&&(f.img_width=l[15]||l[19]),h[0]&278528&&(f.img_height=l[14]||l[18]),!n&&h[0]&4&&(n=!0,f.brush_radius=l[2],P(()=>n=!1)),!r&&h[0]&2097152&&(r=!0,f.brush_color=l[21],P(()=>r=!1)),e.$set(f)},i(l){i||(w(e.$$.fragment,l),i=!0)},o(l){A(e.$$.fragment,l),i=!1},d(l){R(e,l)}}}function kn(t){let e,n;return{c(){e=N("img"),Y(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt","hello"),d(e,"class","svelte-rlgzoo"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(r,i){C(r,e,i)},p(r,i){i[0]&1&&!Y(e.src,n=r[0].image||r[0])&&d(e,"src",n),i[0]&544&&O(e,"webcam",r[5]==="webcam"&&r[9])},i:H,o:H,d(r){r&&z(e)}}}function pn(t){let e=t[20],n,r,i,u=mt(t),s=t[15]>0&&gt(t);return{c(){u.c(),n=q(),s&&s.c(),r=_e()},m(o,l){u.m(o,l),C(o,n,l),s&&s.m(o,l),C(o,r,l),i=!0},p(o,l){l[0]&1048576&&G(e,e=o[20])?(u.d(1),u=mt(o),u.c(),u.m(n.parentNode,n)):u.p(o,l),o[15]>0?s?(s.p(o,l),l[0]&32768&&w(s,1)):(s=gt(o),s.c(),w(s,1),s.m(r.parentNode,r)):s&&(Z(),A(s,1,1,()=>{s=null}),K())},i(o){i||(w(s),i=!0)},o(o){A(s),i=!1},d(o){u.d(o),o&&z(n),s&&s.d(o),o&&z(r)}}}function wn(t){let e,n,r,i,u;return e=new Ne({props:{editable:!0}}),e.$on("edit",t[30]),e.$on("clear",t[23]),{c(){B(e.$$.fragment),n=q(),r=N("img"),Y(r.src,i=t[0])||d(r,"src",i),d(r,"alt",""),d(r,"class","svelte-rlgzoo"),O(r,"scale-x-[-1]",t[5]==="webcam"&&t[9])},m(s,o){S(e,s,o),C(s,n,o),C(s,r,o),u=!0},p(s,o){(!u||o[0]&1&&!Y(r.src,i=s[0]))&&d(r,"src",i),o[0]&544&&O(r,"scale-x-[-1]",s[5]==="webcam"&&s[9])},i(s){u||(w(e.$$.fragment,s),u=!0)},o(s){A(e.$$.fragment,s),u=!1},d(s){R(e,s),s&&z(n),s&&z(r)}}}function An(t){let e,n,r,i,u={image:t[0]};return e=new At({props:u}),t[28](e),e.$on("crop",t[24]),r=new Ne({}),r.$on("clear",t[29]),{c(){B(e.$$.fragment),n=q(),B(r.$$.fragment)},m(s,o){S(e,s,o),C(s,n,o),S(r,s,o),i=!0},p(s,o){const l={};o[0]&1&&(l.image=s[0]),e.$set(l)},i(s){i||(w(e.$$.fragment,s),w(r.$$.fragment,s),i=!0)},o(s){A(e.$$.fragment,s),A(r.$$.fragment,s),i=!1},d(s){t[28](null),R(e,s),s&&z(n),R(r,s)}}}function In(t){let e;const n=t[27].default,r=Tt(n,t,t[61],null);return{c(){r&&r.c()},m(i,u){r&&r.m(i,u),e=!0},p(i,u){r&&r.p&&(!e||u[1]&1073741824)&&Bt(r,n,i,i[61],e?Rt(n,i[61],u,null):St(i[61]),null)},i(i){e||(w(r,i),e=!0)},o(i){A(r,i),e=!1},d(i){r&&r.d(i)}}}function mt(t){let e,n,r,i;return{c(){e=N("img"),d(e,"class","absolute-img svelte-rlgzoo"),Y(e.src,n=t[20]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt","load-2"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(u,s){C(u,e,s),t[31](e),r||(i=J(e,"load",t[25]),r=!0)},p(u,s){s[0]&1048577&&!Y(e.src,n=u[20]||u[0]?.image||u[0])&&d(e,"src",n),s[0]&544&&O(e,"webcam",u[5]==="webcam"&&u[9])},d(u){u&&z(e),t[31](null),r=!1,i()}}}function gt(t){let e,n,r,i,u,s,o,l;function h(_){t[33](_)}function f(_){t[34](_)}let g={value:t[0],mode:t[12],width:t[15]||t[19],height:t[14]||t[18],container_height:t[16]||t[18],value_img:t[17],source:t[5],shape:t[6]};t[2]!==void 0&&(g.brush_radius=t[2]),t[21]!==void 0&&(g.brush_color=t[21]),e=new Ge({props:g}),t[32](e),j.push(()=>X(e,"brush_radius",h)),j.push(()=>X(e,"brush_color",f)),e.$on("change",t[24]),u=new Ze({}),u.$on("undo",t[35]),u.$on("redraw",t[36]),u.$on("clear",t[26]);let a=(t[1]==="color-sketch"||t[1]==="sketch")&&dt(t);return{c(){B(e.$$.fragment),i=q(),B(u.$$.fragment),s=q(),a&&a.c(),o=_e()},m(_,b){S(e,_,b),C(_,i,b),S(u,_,b),C(_,s,b),a&&a.m(_,b),C(_,o,b),l=!0},p(_,b){const I={};b[0]&1&&(I.value=_[0]),b[0]&4096&&(I.mode=_[12]),b[0]&557056&&(I.width=_[15]||_[19]),b[0]&278528&&(I.height=_[14]||_[18]),b[0]&327680&&(I.container_height=_[16]||_[18]),b[0]&131072&&(I.value_img=_[17]),b[0]&32&&(I.source=_[5]),b[0]&64&&(I.shape=_[6]),!n&&b[0]&4&&(n=!0,I.brush_radius=_[2],P(()=>n=!1)),!r&&b[0]&2097152&&(r=!0,I.brush_color=_[21],P(()=>r=!1)),e.$set(I),_[1]==="color-sketch"||_[1]==="sketch"?a?(a.p(_,b),b[0]&2&&w(a,1)):(a=dt(_),a.c(),w(a,1),a.m(o.parentNode,o)):a&&(Z(),A(a,1,1,()=>{a=null}),K())},i(_){l||(w(e.$$.fragment,_),w(u.$$.fragment,_),w(a),l=!0)},o(_){A(e.$$.fragment,_),A(u.$$.fragment,_),A(a),l=!1},d(_){t[32](null),R(e,_),_&&z(i),R(u,_),_&&z(s),a&&a.d(_),_&&z(o)}}}function dt(t){let e,n,r,i;function u(l){t[37](l)}function s(l){t[38](l)}let o={container_height:t[16]||t[18],img_width:t[15]||t[19],img_height:t[14]||t[18],mode:t[12]};return t[2]!==void 0&&(o.brush_radius=t[2]),t[21]!==void 0&&(o.brush_color=t[21]),e=new Ke({props:o}),j.push(()=>X(e,"brush_radius",u)),j.push(()=>X(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(l,h){S(e,l,h),i=!0},p(l,h){const f={};h[0]&327680&&(f.container_height=l[16]||l[18]),h[0]&557056&&(f.img_width=l[15]||l[19]),h[0]&278528&&(f.img_height=l[14]||l[18]),h[0]&4096&&(f.mode=l[12]),!n&&h[0]&4&&(n=!0,f.brush_radius=l[2],P(()=>n=!1)),!r&&h[0]&2097152&&(r=!0,f.brush_color=l[21],P(()=>r=!1)),e.$set(f)},i(l){i||(w(e.$$.fragment,l),i=!0)},o(l){A(e.$$.fragment,l),i=!1},d(l){R(e,l)}}}function yn(t){let e,n,r,i;const u=[In,An,wn,pn,kn],s=[];function o(l,h){return l[0]===null&&!l[20]||l[7]?0:l[1]==="select"?1:l[1]==="editor"?2:(l[1]==="sketch"||l[1]==="color-sketch")&&(l[0]!==null||l[20])?3:4}return e=o(t),n=s[e]=u[e](t),{c(){n.c(),r=_e()},m(l,h){s[e].m(l,h),C(l,r,h),i=!0},p(l,h){let f=e;e=o(l),e===f?s[e].p(l,h):(Z(),A(s[f],1,1,()=>{s[f]=null}),K(),n=s[e],n?n.p(l,h):(n=s[e]=u[e](l),n.c()),w(n,1),n.m(r.parentNode,r))},i(l){i||(w(n),i=!0)},o(l){A(n),i=!1},d(l){s[e].d(l),l&&z(r)}}}function Cn(t){let e,n,r,i,u,s,o;e=new wt({props:{show_label:t[4],Icon:t[5]==="canvas"?et:qe,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const l=[bn,dn,gn,mn,cn,hn,_n],h=[];function f(g,a){return g[5]==="upload"?0:g[5]==="canvas"?1:g[0]===null&&!g[20]||g[7]?2:g[1]==="select"?3:g[1]==="editor"?4:(g[1]==="sketch"||g[1]==="color-sketch")&&(g[0]!==null||g[20])?5:6}return i=f(t),u=h[i]=l[i](t),{c(){B(e.$$.fragment),n=q(),r=N("div"),u.c(),d(r,"data-testid","image"),d(r,"class","svelte-rlgzoo"),Qe(()=>t[60].call(r)),O(r,"fixed-height",t[5]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(g,a){S(e,g,a),C(g,n,a),C(g,r,a),h[i].m(r,null),s=kt(r,t[60].bind(r)),o=!0},p(g,a){const _={};a[0]&16&&(_.show_label=g[4]),a[0]&32&&(_.Icon=g[5]==="canvas"?et:qe),a[0]&40&&(_.label=g[3]||(g[5]==="canvas"?"Sketch":"Image")),e.$set(_);let b=i;i=f(g),i===b?h[i].p(g,a):(Z(),A(h[b],1,1,()=>{h[b]=null}),K(),u=h[i],u?u.p(g,a):(u=h[i]=l[i](g),u.c()),w(u,1),u.m(r,null)),a[0]&34&&O(r,"fixed-height",g[5]!=="webcam"||g[1]==="sketch"||g[1]==="color-sketch")},i(g){o||(w(e.$$.fragment,g),w(u),o=!0)},o(g){A(e.$$.fragment,g),A(u),o=!1},d(g){R(e,g),g&&z(n),g&&z(r),h[i].d(),s()}}}function zn(t,e,n){let r,{$$slots:i={},$$scope:u}=e,{value:s}=e,{label:o=void 0}=e,{show_label:l}=e,{source:h="upload"}=e,{tool:f="editor"}=e,{shape:g}=e,{streaming:a=!1}=e,{pending:_=!1}=e,{mirror_webcam:b}=e,{brush_radius:I}=e,v,L,te;s&&(h==="upload"||h==="webcam")&&f==="sketch"&&(s={image:s,mask:null});function de({detail:m}){f==="color-sketch"?n(20,ue=m):(n(0,s=(h==="upload"||h==="webcam")&&f==="sketch"?{image:m,mask:null}:m),te=s,localStorage.setItem("imgValue",te)),F("upload",m)}function D({detail:m}){n(0,s=null),n(20,ue=void 0),F("clear")}async function k({detail:m},ae){p==="mask"?h==="webcam"&&ae?n(0,s={image:m,mask:null}):n(0,s={image:typeof s=="string"?s:s?.image||null,mask:m}):(h==="upload"||h==="webcam")&&f==="sketch"?n(0,s={image:m,mask:null}):n(0,s=m),await ke(),F(a?"stream":"edit")}const F=ge();let U=!1;function ne(m){const ae=m.currentTarget;n(15,se=ae.naturalWidth),n(14,re=ae.naturalHeight),n(16,W=ae.getBoundingClientRect().height)}async function fe(){v.clear(),await ke(),n(0,s=null),n(20,ue=void 0)}let re=0,se=0,W=0,p,$,ie,le,ue;pt(async()=>{f==="color-sketch"&&s&&typeof s=="string"&&(n(20,ue=s),await ke(),ne({currentTarget:$}))});function Fe(m){j[m?"unshift":"push"](()=>{L=m,n(10,L),n(0,s)})}const We=m=>(D(m),n(1,f="editor")),be=()=>n(1,f="select");function Oe(m){j[m?"unshift":"push"](()=>{$=m,n(17,$)})}function Ce(m){j[m?"unshift":"push"](()=>{v=m,n(13,v)})}function Ve(m){I=m,n(2,I)}function ze(m){r=m,n(21,r),n(12,p),n(5,h),n(1,f)}const ve=()=>v.undo(),Me=()=>v.redraw();function Te(m){I=m,n(2,I)}function Be(m){r=m,n(21,r),n(12,p),n(5,h),n(1,f)}function he(m){U=m,n(11,U)}const Se=()=>v.undo(),Re=()=>v.redraw();function we(m){I=m,n(2,I)}function De(m){r=m,n(21,r),n(12,p),n(5,h),n(1,f)}function Ee(m){I=m,n(2,I)}function je(m){r=m,n(21,r),n(12,p),n(5,h),n(1,f)}function oe(m){j[m?"unshift":"push"](()=>{v=m,n(13,v)})}const ce=m=>f==="color-sketch"?de(m):k(m,!0);function Ae(m){me.call(this,t,m)}function Ie(m){j[m?"unshift":"push"](()=>{L=m,n(10,L),n(0,s)})}const He=m=>(D(m),n(1,f="editor")),Le=()=>n(1,f="select");function Ye(m){j[m?"unshift":"push"](()=>{$=m,n(17,$)})}function Je(m){j[m?"unshift":"push"](()=>{v=m,n(13,v)})}function Pe(m){I=m,n(2,I)}function Xe(m){r=m,n(21,r),n(12,p),n(5,h),n(1,f)}const c=()=>v.undo(),y=()=>v.redraw();function M(m){I=m,n(2,I)}function T(m){r=m,n(21,r),n(12,p),n(5,h),n(1,f)}function E(){ie=this.offsetHeight,le=this.offsetWidth,n(18,ie),n(19,le)}return t.$$set=m=>{"value"in m&&n(0,s=m.value),"label"in m&&n(3,o=m.label),"show_label"in m&&n(4,l=m.show_label),"source"in m&&n(5,h=m.source),"tool"in m&&n(1,f=m.tool),"shape"in m&&n(6,g=m.shape),"streaming"in m&&n(7,a=m.streaming),"pending"in m&&n(8,_=m.pending),"mirror_webcam"in m&&n(9,b=m.mirror_webcam),"brush_radius"in m&&n(2,I=m.brush_radius),"$$scope"in m&&n(61,u=m.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&F("change",s),t.$$.dirty[0]&2048&&F("drag",U),t.$$.dirty[0]&34&&(h==="canvas"&&f==="sketch"?n(12,p="bw-sketch"):f==="color-sketch"?n(12,p="color-sketch"):(h==="upload"||h==="webcam")&&f==="sketch"?n(12,p="mask"):n(12,p="editor")),t.$$.dirty[0]&4096&&n(21,r=p=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&n(20,ue=void 0),t.$$.dirty[0]&1025&&L&&(s?(n(10,L.image=s,L),L.create()):L.destroy())},[s,f,I,o,l,h,g,a,_,b,L,U,p,v,re,se,W,$,ie,le,ue,r,de,D,k,ne,fe,i,Fe,We,be,Oe,Ce,Ve,ze,ve,Me,Te,Be,he,Se,Re,we,De,Ee,je,oe,ce,Ae,Ie,He,Le,Ye,Je,Pe,Xe,c,y,M,T,E,u]}class vn extends x{constructor(e){super(),ee(this,e,zn,Cn,G,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2},null,[-1,-1,-1])}}function Mn(t){let e,n,r,i,u,s,o;return r=new pe({props:{Icon:Jt,label:"Download"}}),{c(){e=N("div"),n=N("a"),B(r.$$.fragment),i=q(),u=N("img"),d(n,"href",t[0]),d(n,"target",window.__is_colab__?"_blank":null),d(n,"download","image"),d(e,"class","download svelte-kt1jzh"),Y(u.src,s=t[0])||d(u,"src",s),d(u,"alt",""),d(u,"class","svelte-kt1jzh")},m(l,h){C(l,e,h),V(e,n),S(r,n,null),C(l,i,h),C(l,u,h),o=!0},p(l,h){(!o||h&1)&&d(n,"href",l[0]),(!o||h&1&&!Y(u.src,s=l[0]))&&d(u,"src",s)},i(l){o||(w(r.$$.fragment,l),o=!0)},o(l){A(r.$$.fragment,l),o=!1},d(l){l&&z(e),R(r),l&&z(i),l&&z(u)}}}function Tn(t){let e,n;return e=new Yt({props:{size:"large",unpadded_box:!0,$$slots:{default:[Bn]},$$scope:{ctx:t}}}),{c(){B(e.$$.fragment)},m(r,i){S(e,r,i),n=!0},p(r,i){const u={};i&16&&(u.$$scope={dirty:i,ctx:r}),e.$set(u)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Bn(t){let e,n;return e=new qe({}),{c(){B(e.$$.fragment)},m(r,i){S(e,r,i),n=!0},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Sn(t){let e,n,r,i,u,s;e=new wt({props:{show_label:t[2],Icon:qe,label:t[1]||"Image"}});const o=[Tn,Mn],l=[];function h(f,g){return f[0]===null?0:1}return r=h(t),i=l[r]=o[r](t),{c(){B(e.$$.fragment),n=q(),i.c(),u=_e()},m(f,g){S(e,f,g),C(f,n,g),l[r].m(f,g),C(f,u,g),s=!0},p(f,[g]){const a={};g&4&&(a.show_label=f[2]),g&2&&(a.label=f[1]||"Image"),e.$set(a);let _=r;r=h(f),r===_?l[r].p(f,g):(Z(),A(l[_],1,1,()=>{l[_]=null}),K(),i=l[r],i?i.p(f,g):(i=l[r]=o[r](f),i.c()),w(i,1),i.m(u.parentNode,u))},i(f){s||(w(e.$$.fragment,f),w(i),s=!0)},o(f){A(e.$$.fragment,f),A(i),s=!1},d(f){R(e,f),f&&z(n),l[r].d(f),f&&z(u)}}}function Rn(t,e,n){let{value:r}=e,{label:i=void 0}=e,{show_label:u}=e;const s=ge();return t.$$set=o=>{"value"in o&&n(0,r=o.value),"label"in o&&n(1,i=o.label),"show_label"in o&&n(2,u=o.show_label)},t.$$.update=()=>{t.$$.dirty&1&&r&&s("change",r)},[r,i,u]}class Dn extends x{constructor(e){super(),ee(this,e,Rn,Sn,G,{value:0,label:1,show_label:2})}}function En(t){let e,n,r;function i(s){t[17](s)}let u={brush_radius:t[14],shape:t[13],source:t[5],tool:t[6],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[12],$$slots:{default:[Ln]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.value=t[0]),e=new vn({props:u}),j.push(()=>X(e,"value",i)),e.$on("edit",t[18]),e.$on("clear",t[19]),e.$on("change",t[20]),e.$on("stream",t[21]),e.$on("drag",t[22]),e.$on("upload",t[23]),e.$on("error",t[24]),{c(){B(e.$$.fragment)},m(s,o){S(e,s,o),r=!0},p(s,o){const l={};o&16384&&(l.brush_radius=s[14]),o&8192&&(l.shape=s[13]),o&32&&(l.source=s[5]),o&64&&(l.tool=s[6]),o&128&&(l.label=s[7]),o&256&&(l.show_label=s[8]),o&1024&&(l.pending=s[10]),o&512&&(l.streaming=s[9]),o&4096&&(l.mirror_webcam=s[12]),o&67108864&&(l.$$scope={dirty:o,ctx:s}),!n&&o&1&&(n=!0,l.value=s[0],P(()=>n=!1)),e.$set(l)},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){R(e,s)}}}function jn(t){let e,n;return e=new Dn({props:{value:t[0],label:t[7],show_label:t[8]}}),{c(){B(e.$$.fragment)},m(r,i){S(e,r,i),n=!0},p(r,i){const u={};i&1&&(u.value=r[0]),i&128&&(u.label=r[7]),i&256&&(u.show_label=r[8]),e.$set(u)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Ln(t){let e,n;return e=new Pt({props:{type:"image"}}),{c(){B(e.$$.fragment)},m(r,i){S(e,r,i),n=!0},p:H,i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Un(t){let e,n,r,i,u,s;const o=[t[1]];let l={};for(let a=0;a<o.length;a+=1)l=Dt(l,o[a]);e=new Et({props:l});const h=[jn,En],f=[];function g(a,_){return a[15]==="static"?0:1}return r=g(t),i=f[r]=h[r](t),{c(){B(e.$$.fragment),n=q(),i.c(),u=_e()},m(a,_){S(e,a,_),C(a,n,_),f[r].m(a,_),C(a,u,_),s=!0},p(a,_){const b=_&2?jt(o,[Lt(a[1])]):{};e.$set(b);let I=r;r=g(a),r===I?f[r].p(a,_):(Z(),A(f[I],1,1,()=>{f[I]=null}),K(),i=f[r],i?i.p(a,_):(i=f[r]=h[r](a),i.c()),w(i,1),i.m(u.parentNode,u))},i(a){s||(w(e.$$.fragment,a),w(i),s=!0)},o(a){A(e.$$.fragment,a),A(i),s=!1},d(a){R(e,a),a&&z(n),f[r].d(a),a&&z(u)}}}function qn(t){let e,n;return e=new Ut({props:{visible:t[4],variant:t[15]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[16]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],style:{height:t[11].height,width:t[11].width},allow_overflow:!1,$$slots:{default:[Un]},$$scope:{ctx:t}}}),{c(){B(e.$$.fragment)},m(r,i){S(e,r,i),n=!0},p(r,[i]){const u={};i&16&&(u.visible=r[4]),i&32801&&(u.variant=r[15]==="dynamic"&&r[0]===null&&r[5]==="upload"?"dashed":"solid"),i&65536&&(u.border_mode=r[16]?"focus":"base"),i&4&&(u.elem_id=r[2]),i&8&&(u.elem_classes=r[3]),i&2048&&(u.style={height:r[11].height,width:r[11].width}),i&67237859&&(u.$$scope={dirty:i,ctx:r}),e.$set(u)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){R(e,r)}}}function Nn(t,e,n){let{elem_id:r=""}=e,{elem_classes:i=[]}=e,{visible:u=!0}=e,{value:s=null}=e,{source:o="upload"}=e,{tool:l="editor"}=e,{label:h}=e,{show_label:f}=e,{streaming:g}=e,{pending:a}=e,{style:_={}}=e,{mirror_webcam:b}=e,{shape:I}=e,{brush_radius:v}=e,{loading_status:L}=e,{mode:te}=e;const de=ge();let D;function k(p){s=p,n(0,s)}function F(p){me.call(this,t,p)}function U(p){me.call(this,t,p)}function ne(p){me.call(this,t,p)}function fe(p){me.call(this,t,p)}const re=({detail:p})=>n(16,D=p);function se(p){me.call(this,t,p)}const W=({detail:p})=>{n(1,L=L||{}),n(1,L.status="error",L),n(1,L.message=p,L)};return t.$$set=p=>{"elem_id"in p&&n(2,r=p.elem_id),"elem_classes"in p&&n(3,i=p.elem_classes),"visible"in p&&n(4,u=p.visible),"value"in p&&n(0,s=p.value),"source"in p&&n(5,o=p.source),"tool"in p&&n(6,l=p.tool),"label"in p&&n(7,h=p.label),"show_label"in p&&n(8,f=p.show_label),"streaming"in p&&n(9,g=p.streaming),"pending"in p&&n(10,a=p.pending),"style"in p&&n(11,_=p.style),"mirror_webcam"in p&&n(12,b=p.mirror_webcam),"shape"in p&&n(13,I=p.shape),"brush_radius"in p&&n(14,v=p.brush_radius),"loading_status"in p&&n(1,L=p.loading_status),"mode"in p&&n(15,te=p.mode)},t.$$.update=()=>{t.$$.dirty&1&&n(0,s=s||null),t.$$.dirty&1&&de("change")},[s,L,r,i,u,o,l,h,f,g,a,_,b,I,v,te,D,k,F,U,ne,fe,re,se,W]}class Fn extends x{constructor(e){super(),ee(this,e,Nn,qn,G,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,style:11,mirror_webcam:12,shape:13,brush_radius:14,loading_status:1,mode:15})}}var er=Fn;const tr=["static","dynamic"],nr=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{er as Component,ir as ExampleComponent,nr as document,tr as modes};
//# sourceMappingURL=index.5c1350a0.js.map
