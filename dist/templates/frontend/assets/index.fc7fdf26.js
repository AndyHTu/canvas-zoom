import{S as re,i as ne,s as $,A as K,B as d,f as y,D as Y,E as X,p as C,a6 as St,F as P,K as V,q as de,b as L,a3 as xe,ah as lt,a5 as it,C as Et,O as W,I as H,ad as Tt,a2 as et,G as U,ak as Ct,o as p,k as ee,t as A,n as te,N as Bt,r as zt,V as pe,ac as Dt,x as ge,c as S,m as E,l as T,M as Pe,an as Rt,e as fe,j as Q,a as G,L as tt,W as qt,X as jt,Y as Lt,Z as Ut,v as Nt,a7 as Pt,g as Ft,h as Ot}from"./index.cf380bf1.js";import{a as Wt}from"./Empty.svelte_svelte_type_style_lang.9d18f6ae.js";import{B as vt}from"./BlockLabel.2c91dd6f.js";/* empty css                                                    */import{I as Fe}from"./Image.31878d53.js";import{C as Yt,i as Xt,U as Ht,W as Vt}from"./StaticImage.svelte_svelte_type_style_lang.72dd3b59.js";import{I as we,C as Jt,M as Oe}from"./ModifyUpload.e64478c3.js";import{C as Qt}from"./Copy.e64eabfe.js";import{U as Gt}from"./Upload.08f51b4d.js";import{E as Zt}from"./Empty.5b26147e.js";import{D as Kt}from"./Download.8bf029f1.js";import"./Blocks.d4c4372f.js";import{U as $t}from"./UploadText.129b6ee0.js";import{E as _n}from"./Image.50f0c902.js";import"./ModifyUpload.svelte_svelte_type_style_lang.e946db2d.js";function xt(t){let e,r,n;return{c(){e=K("svg"),r=K("path"),n=K("path"),d(r,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(r,"fill","currentColor"),d(n,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(n,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(l,o){y(l,e,o),Y(e,r),Y(e,n)},p:X,i:X,o:X,d(l){l&&C(e)}}}class er extends re{constructor(e){super(),ne(this,e,null,xt,$,{})}}function tr(t){let e,r,n,l,o,s,a;return{c(){e=K("svg"),r=K("circle"),n=K("circle"),l=K("circle"),o=K("circle"),s=K("circle"),a=K("path"),d(r,"cx","10"),d(r,"cy","12"),d(r,"r","2"),d(r,"fill","currentColor"),d(n,"cx","16"),d(n,"cy","9"),d(n,"r","2"),d(n,"fill","currentColor"),d(l,"cx","22"),d(l,"cy","12"),d(l,"r","2"),d(l,"fill","currentColor"),d(o,"cx","23"),d(o,"cy","18"),d(o,"r","2"),d(o,"fill","currentColor"),d(s,"cx","19"),d(s,"cy","23"),d(s,"r","2"),d(s,"fill","currentColor"),d(a,"fill","currentColor"),d(a,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(i,h){y(i,e,h),Y(e,r),Y(e,n),Y(e,l),Y(e,o),Y(e,s),Y(e,a)},p:X,i:X,o:X,d(i){i&&C(e)}}}class rr extends re{constructor(e){super(),ne(this,e,null,tr,$,{})}}function nr(t){let e,r;return{c(){e=K("svg"),r=K("path"),d(r,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(n,l){y(n,e,l),Y(e,r)},p:X,i:X,o:X,d(n){n&&C(e)}}}class ot extends re{constructor(e){super(),ne(this,e,null,nr,$,{})}}function sr(t){let e,r;return{c(){e=P("img"),V(e.src,r=t[0])||d(e,"src",r),d(e,"alt","")},m(n,l){y(n,e,l),t[4](e)},p(n,[l]){l&1&&!V(e.src,r=n[0])&&d(e,"src",r)},i:X,o:X,d(n){n&&C(e),t[4](null)}}}function lr(t,e,r){let{image:n}=e,l;const o=de();let s;function a(){s.destroy()}function i(){s&&a(),s=new Yt(l,{autoCropArea:1,cropend(){const _=s.getCroppedCanvas().toDataURL();o("crop",_)}}),o("crop",n)}function h(_){L[_?"unshift":"push"](()=>{l=_,r(1,l)})}return t.$$set=_=>{"image"in _&&r(0,n=_.image)},[n,l,a,i,h]}class Mt extends re{constructor(e){super(),ne(this,e,lr,sr,$,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),St()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class at{constructor(e,r){this.x=e,this.y=r}}class ut extends at{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,r){const n=e+Math.PI/2;this.x=this.x+Math.sin(n)*r,this.y=this.y-Math.cos(n)*r}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new at(this.x-e.x,this.y-e.y)}getDistanceTo(e){const r=this.getDifferenceTo(e);return Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))}getAngleTo(e){const r=this.getDifferenceTo(e);return Math.atan2(r.y,r.x)}toObject(){return{x:this.x,y:this.y}}}const ir=30;class or{constructor({radius:e=ir,enabled:r=!0,initialPoint:n={x:0,y:0}}={}){this.radius=e,this._isEnabled=r,this.pointer=new ut(n.x,n.y),this.brush=new ut(n.x,n.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:r=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!r?!1:(this.pointer.update(e),r?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function ft(t,e,r){const n=t.slice();return n[66]=e[r].name,n[67]=e[r].zIndex,n[68]=e,n[69]=r,n}function _t(t){let e,r,n;return{c(){e=P("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-1g1hqr7")},m(l,o){y(l,e,o),n=!0},i(l){n||(xe(()=>{r||(r=lt(e,it,{duration:50},!0)),r.run(1)}),n=!0)},o(l){r||(r=lt(e,it,{duration:50},!1)),r.run(0),n=!1},d(l){l&&C(e),l&&r&&r.end()}}}function ht(t){let e,r,n=t[66],l,o;const s=()=>t[30](e,n),a=()=>t[30](null,n);return{c(){e=P("canvas"),d(e,"key",r=t[66]),Et(e,"z-index",t[67]),d(e,"class","svelte-1g1hqr7"),W(e,"lr",t[5]),W(e,"tb",!t[5])},m(i,h){y(i,e,h),s(),l||(o=[H(e,"mousedown",t[66]==="interface"?t[7]:void 0),H(e,"mousemove",t[66]==="interface"?t[8]:void 0),H(e,"mouseup",t[66]==="interface"?t[9]:void 0),H(e,"mouseout",t[66]==="interface"?t[9]:void 0),H(e,"blur",t[66]==="interface"?t[9]:void 0),H(e,"touchstart",t[66]==="interface"?t[7]:void 0),H(e,"touchmove",t[66]==="interface"?t[8]:void 0),H(e,"touchend",t[66]==="interface"?t[9]:void 0),H(e,"touchcancel",t[66]==="interface"?t[9]:void 0),H(e,"click",Tt(t[29]))],l=!0)},p(i,h){t=i,n!==t[66]&&(a(),n=t[66],s()),h[0]&32&&W(e,"lr",t[5]),h[0]&32&&W(e,"tb",!t[5])},d(i){i&&C(e),a(),l=!1,et(o)}}}function ar(t){let e,r,n,l,o=t[4]===0&&_t(),s=t[6],a=[];for(let i=0;i<s.length;i+=1)a[i]=ht(ft(t,s,i));return{c(){e=P("div"),o&&o.c(),r=U();for(let i=0;i<a.length;i+=1)a[i].c();d(e,"class","wrap svelte-1g1hqr7"),xe(()=>t[32].call(e))},m(i,h){y(i,e,h),o&&o.m(e,null),Y(e,r);for(let _=0;_<a.length;_+=1)a[_].m(e,null);t[31](e),n=Ct(e,t[32].bind(e)),l=!0},p(i,h){if(i[4]===0?o?h[0]&16&&p(o,1):(o=_t(),o.c(),p(o,1),o.m(e,r)):o&&(ee(),A(o,1,1,()=>{o=null}),te()),h[0]&993){s=i[6];let _;for(_=0;_<s.length;_+=1){const g=ft(i,s,_);a[_]?a[_].p(g,h):(a[_]=ht(g),a[_].c(),a[_].m(e,null))}for(;_<a.length;_+=1)a[_].d(1);a.length=s.length}},i(i){l||(p(o),l=!0)},o(i){A(o),l=!1},d(i){i&&C(e),o&&o.d(),Bt(a,i),t[31](null),n()}}}let ur="#aaa";function ct(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function fr(t,e,r){let n;const l=de();let{value:o}=e,{value_img:s}=e,{mode:a="sketch"}=e,{brush_color:i="#0b0f19"}=e,{brush_radius:h}=e,{source:_}=e,{width:g=400}=e,{height:u=200}=e,{container_height:m=200}=e,{shape:b}=e,I=localStorage.setItem("colorPickerEnable",!1),R=0,q=0,D,se=g,le=u,ie;const be=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let M={},k={},J=[],F=[],oe=!0,ae=!0,w=!1,O=!1,N=null,x=null,_e=null,Z=0;function he(){if(!b){k.temp.drawImage(s,0,0,g,u);return}let c=s.naturalWidth,f=s.naturalHeight;const z=b[0]/b[1],v=c/f;let B=0,j=0;z<v?(c=b[1]*v,f=b[1],B=(b[0]-c)/2):z>v?(c=b[0],f=b[0]/v,j=(b[1]-f)/2):(B=0,j=0,c=b[0],f=b[1]),k.temp.drawImage(s,B,j,c,f)}zt(async()=>{Object.keys(M).forEach(c=>{r(26,k[c]=M[c].getContext("2d"),k)}),await pe(),s&&(s.addEventListener("load",c=>{_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):he(),k.drawing.drawImage(M.temp,0,0,g,u),ue()}),setTimeout(()=>{_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):he(),k.drawing.drawImage(M.temp,0,0,g,u),ke({lines:F.slice()}),ue()},100)),r(28,N=new or({radius:h*.05,enabled:!0,initialPoint:{x:g/2,y:u/2}})),_e=new Xt((c,f,...z)=>{Be(c,f)}),_e.observe(x),ye(),r(24,D=!0),requestAnimationFrame(()=>{ze(),requestAnimationFrame(()=>{me()})})});function ze(){const c=g/2,f=u/2;N.update({x:c,y:f},{both:!0}),N.update({x:c,y:f},{both:!1}),oe=!0,ae=!0}Dt(()=>{r(24,D=!1),_e.unobserve(x)});function We(){const c=F.slice(0,-1);Ie(),s&&(_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):he(),(!F||!F.length)&&k.drawing.drawImage(M.temp,0,0,g,u)),ke({lines:c}),r(4,Z=c.length),F.length&&r(27,F=c),F.length==0&&l("clear"),ue()}function Ye(){Ie(),s&&he(),ke({lines:F}),r(4,Z=F.length),F.length==0&&l("clear"),ue()}let ke=({lines:c})=>{const f=i;c.forEach(z=>{let{points:v,brush_color:B,brush_radius:j}=z;Ae(a==="mask"?{points:v,brush_color:f,brush_radius:j}:{points:v,brush_color:B,brush_radius:j}),a==="mask"&&qe({points:v,brush_color:f,brush_radius:j}),J=v}),Le({brush_color:i,brush_radius:h}),a==="mask"&&je()},Xe=c=>{c.preventDefault();const{x:f,y:z}=De(c);if(c.button===0){if(I=localStorage.getItem("colorPickerEnable")==="true",I&&a!=="mask"){r(13,i=Je(f,z)),localStorage.setItem("colorPickerEnable","false");return}O=!0,c.touches&&c.touches.length>0&&N.update({x:f,y:z},{both:!0}),Re(f,z),r(4,Z+=1)}},ve=c=>{c.preventDefault();const{x:f,y:z}=De(c);R=f,q=z,Re(f,z)},He=c=>{c.preventDefault(),ve(c),w=!1,O=!1,Le(),a==="mask"&&je()},Me=0,Se=0,Ee=0,Te=!1,Be=async()=>{if(b&&x){const z=x?.getBoundingClientRect(),v=b[0]/b[1],B=z.width/z.height;r(5,Te=v<B)}if(g===Me&&u===Se&&Ee===m)return;const c={width:g,height:u},f={height:m,width:m*(c.width/c.height)};await Promise.all([ce(M.interface,c,f),ce(M.drawing,c,f),ce(M.temp,c,f),ce(M.temp_fake,c,f),ce(M.mask,c,f,!1)]),h||r(10,h=20*(c.width/f.width)),ye({once:!0}),setTimeout(()=>{Se=u,Me=g,Ee=m},10),await pe(),me()},ce=async(c,f,z,v=!0)=>{if(!D)return;await pe();const B=window.devicePixelRatio||1;c.width=f.width*(v?B:1),c.height=f.height*(v?B:1);const j=c.getContext("2d");v&&j.scale(B,B),c.style.width=`${z.width}px`,c.style.height=`${z.height}px`},De=c=>{const f=M.interface.getBoundingClientRect();let z=c.clientX,v=c.clientY;return c.changedTouches&&c.changedTouches.length>0&&(z=c.changedTouches[0].clientX,v=c.changedTouches[0].clientY),{x:(z-f.left)/f.width*g,y:(v-f.top)/f.height*u}};function Ve(){if(I=localStorage.getItem("colorPickerEnable")==="true",I&&a!=="mask")for(const c in M)r(0,M[c].style.cursor="crosshair",M);else for(const c in M)r(0,M[c].style.cursor="none",M)}let Re=(c,f)=>{if(I=localStorage.getItem("colorPickerEnable")==="true",Ve(),I&&a!=="mask")return;N.update({x:c,y:f});const z=!N.isEnabled();(O&&!w||z&&O)&&(w=!0,J.push(N.brush.toObject())),w&&(J.push(N.brush.toObject()),Ae({points:J,brush_color:i,brush_radius:h}),a==="mask"&&qe({points:J,brush_color:i,brush_radius:h})),oe=!0},Ae=({points:c,brush_color:f,brush_radius:z})=>{if(!c||c.length<2||(r(26,k.temp.lineJoin="round",k),r(26,k.temp.lineCap="round",k),r(26,k.temp.strokeStyle=f,k),r(26,k.temp.lineWidth=z,k),!c||c.length<2))return;let v=c[0],B=c[1];k.temp.moveTo(B.x,B.y),k.temp.beginPath();for(var j=1,Ne=c.length;j<Ne;j++){var Ce=ct(v,B);k.temp.quadraticCurveTo(v.x,v.y,Ce.x,Ce.y),v=c[j],B=c[j+1]}k.temp.lineTo(v.x,v.y),k.temp.stroke()},qe=({points:c,brush_color:f,brush_radius:z})=>{if(!c||c.length<2)return;r(26,k.temp_fake.lineJoin="round",k),r(26,k.temp_fake.lineCap="round",k),r(26,k.temp_fake.strokeStyle="#fff",k),r(26,k.temp_fake.lineWidth=z,k);let v=c[0],B=c[1];k.temp_fake.moveTo(B.x,B.y),k.temp_fake.beginPath();for(var j=1,Ne=c.length;j<Ne;j++){var Ce=ct(v,B);k.temp_fake.quadraticCurveTo(v.x,v.y,Ce.x,Ce.y),v=c[j],B=c[j+1]}k.temp_fake.lineTo(v.x,v.y),k.temp_fake.stroke()};function Je(c,f){const z=k.drawing.getImageData(c,f,1,1),[v,B,j,Ne]=z.data;return`rgb(${v}, ${B}, ${j})`}let je=()=>{J.length<1||(J.length=0,k.mask.drawImage(M.temp_fake,0,0,g,u),ue())},Le=()=>{J.length<1||(F.push({points:J.slice(),brush_color:i,brush_radius:h}),a!=="mask"&&(J.length=0),k.drawing.drawImage(M.temp,0,0,g,u),ue())},ue=()=>{const c=Ue();l("change",c)};function me(){return r(27,F=[]),Ie(),r(4,Z=0),!0}function Ie(){ae=!0,k.temp.clearRect(0,0,g,u),r(26,k.temp.fillStyle=a==="mask"?"transparent":"#FFFFFF",k),k.temp.fillRect(0,0,g,u),a==="mask"&&(k.temp_fake.clearRect(0,0,M.temp_fake.width,M.temp_fake.height),k.mask.clearRect(0,0,g,u),r(26,k.mask.fillStyle="#000",k),k.mask.fillRect(0,0,g,u))}let ye=({once:c=!1}={})=>{if(oe||ae){const f=N.getPointerCoordinates(),z=N.getBrushCoordinates();Qe(k.interface,f,z),oe=!1,ae=!1}c||window.requestAnimationFrame(()=>{ye()})},Qe=(c,f,z)=>{c.clearRect(0,0,g,u);let v=z.x,B=z.y;R&&R&&(v=R,B=q),c.beginPath(),c.fillStyle=i;const j=localStorage.getItem("brushOutline")==="true";j&&a==="mask"&&(c.strokeStyle="white",c.lineWidth=2),c.arc(v,B,h/2,0,Math.PI*2,!0),c.fill(),j&&a==="mask"&&c.stroke(),c.beginPath(),c.fillStyle=ur,c.arc(v,B,n,0,Math.PI*2,!0),c.fill()};function Ue(){return a==="mask"?M.mask.toDataURL("image/jpg"):M.drawing.toDataURL("image/jpg")}function Ge(c){ge.call(this,t,c)}function Ze(c,f){L[c?"unshift":"push"](()=>{M[f]=c,r(0,M)})}function Ke(c){L[c?"unshift":"push"](()=>{x=c,r(3,x)})}function $e(){se=this.offsetWidth,le=this.offsetHeight,r(1,se),r(2,le)}return t.$$set=c=>{"value"in c&&r(14,o=c.value),"value_img"in c&&r(15,s=c.value_img),"mode"in c&&r(16,a=c.mode),"brush_color"in c&&r(13,i=c.brush_color),"brush_radius"in c&&r(10,h=c.brush_radius),"source"in c&&r(17,_=c.source),"width"in c&&r(11,g=c.width),"height"in c&&r(12,u=c.height),"container_height"in c&&r(18,m=c.container_height),"shape"in c&&r(19,b=c.shape)},t.$$.update=()=>{t.$$.dirty[0]&530432&&b&&(g||u)&&(r(11,g=b[0]),r(12,u=b[1])),t.$$.dirty[0]&16793600&&D&&!o&&me(),t.$$.dirty[0]&251828225&&D&&s!==ie&&(r(25,ie=s),me(),setTimeout(()=>{_==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):he(),k.drawing.drawImage(M.temp,0,0,g,u),ke({lines:F.slice()}),ue()},50)),t.$$.dirty[0]&268436480&&N&&(ze(),N.setRadius(h*.05)),t.$$.dirty[0]&6144&&(g||u)&&Be(),t.$$.dirty[0]&1024&&(n=h*.075)},[M,se,le,x,Z,Te,be,Xe,ve,He,h,g,u,i,o,s,a,_,m,b,We,Ye,me,Ue,D,ie,k,F,N,Ge,Ze,Ke,$e]}class rt extends re{constructor(e){super(),ne(this,e,fr,ar,$,{value:14,value_img:15,mode:16,brush_color:13,brush_radius:10,source:17,width:11,height:12,container_height:18,shape:19,undo:20,redraw:21,clear:22,get_image_data:23},null,[-1,-1,-1])}get undo(){return this.$$.ctx[20]}get redraw(){return this.$$.ctx[21]}get clear(){return this.$$.ctx[22]}get get_image_data(){return this.$$.ctx[23]}}function _r(t){let e,r,n,l,o,s,a;return r=new we({props:{Icon:Ht,label:"Undo"}}),r.$on("click",t[1]),l=new we({props:{Icon:Qt,label:"Redraw"}}),l.$on("click",t[2]),s=new we({props:{Icon:Jt,label:"Clear"}}),s.$on("click",t[3]),{c(){e=P("div"),S(r.$$.fragment),n=U(),S(l.$$.fragment),o=U(),S(s.$$.fragment),d(e,"class","svelte-17iq5p5")},m(i,h){y(i,e,h),E(r,e,null),Y(e,n),E(l,e,null),Y(e,o),E(s,e,null),a=!0},p:X,i(i){a||(p(r.$$.fragment,i),p(l.$$.fragment,i),p(s.$$.fragment,i),a=!0)},o(i){A(r.$$.fragment,i),A(l.$$.fragment,i),A(s.$$.fragment,i),a=!1},d(i){i&&C(e),T(r),T(l),T(s)}}}function hr(t){const e=de();return[e,()=>e("undo"),()=>e("redraw"),o=>{e("clear"),o.stopPropagation()}]}class nt extends re{constructor(e){super(),ne(this,e,hr,_r,$,{})}}function mt(t){let e,r,n,l,o;return{c(){e=P("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",r=.5*(t[2]/t[6])),d(e,"max",n=75*(t[2]/t[6])),d(e,"class","svelte-p4aq0j")},m(s,a){y(s,e,a),Pe(e,t[0]),l||(o=[H(e,"change",t[11]),H(e,"input",t[11])],l=!0)},p(s,a){a&68&&r!==(r=.5*(s[2]/s[6]))&&d(e,"min",r),a&68&&n!==(n=75*(s[2]/s[6]))&&d(e,"max",n),a&1&&Pe(e,s[0])},d(s){s&&C(e),l=!1,et(o)}}}function cr(t){let e,r,n,l;r=new we({props:{Icon:rr,label:"Select brush color"}}),r.$on("click",t[12]);let o=t[5]&&gt(t);return{c(){e=P("span"),S(r.$$.fragment),n=U(),o&&o.c(),d(e,"class","col svelte-p4aq0j")},m(s,a){y(s,e,a),E(r,e,null),Y(e,n),o&&o.m(e,null),l=!0},p(s,a){s[5]?o?o.p(s,a):(o=gt(s),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(s){l||(p(r.$$.fragment,s),l=!0)},o(s){A(r.$$.fragment,s),l=!1},d(s){s&&C(e),T(r),o&&o.d()}}}function gt(t){let e,r,n;return{c(){e=P("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-p4aq0j")},m(l,o){y(l,e,o),Pe(e,t[1]),r||(n=[H(e,"change",t[13]),H(e,"input",t[14])],r=!0)},p(l,o){o&2&&Pe(e,l[1])},d(l){l&&C(e),r=!1,et(n)}}}function mr(t){let e,r,n,l,o,s;n=new we({props:{Icon:er,label:"Use brush"}}),n.$on("click",t[10]);let a=t[4]&&mt(t),i=cr(t);return{c(){e=P("div"),r=P("span"),S(n.$$.fragment),l=U(),a&&a.c(),o=U(),i&&i.c(),d(r,"class","brush svelte-p4aq0j"),d(e,"class","wrap svelte-p4aq0j")},m(h,_){y(h,e,_),Y(e,r),E(n,r,null),Y(r,l),a&&a.m(r,null),Y(e,o),i&&i.m(e,null),s=!0},p(h,[_]){h[4]?a?a.p(h,_):(a=mt(h),a.c(),a.m(r,null)):a&&(a.d(1),a=null),i.p(h,_)},i(h){s||(p(n.$$.fragment,h),p(i),s=!0)},o(h){A(n.$$.fragment,h),A(i),s=!1},d(h){h&&C(e),T(n),a&&a.d(),i&&i.d()}}}function gr(t,e,r){let n;const l=de();let o=!1,s=!1,{brush_radius:a=20}=e,{brush_color:i="#000"}=e,{container_height:h}=e,{img_width:_}=e,{img_height:g}=e,{mode:u="other"}=e;const m=()=>r(4,o=!o);function b(){a=Rt(this.value),r(0,a)}const I=()=>r(5,s=!s),R=()=>{u==="mask"&&l("redraw")};function q(){i=this.value,r(1,i)}return t.$$set=D=>{"brush_radius"in D&&r(0,a=D.brush_radius),"brush_color"in D&&r(1,i=D.brush_color),"container_height"in D&&r(8,h=D.container_height),"img_width"in D&&r(2,_=D.img_width),"img_height"in D&&r(9,g=D.img_height),"mode"in D&&r(3,u=D.mode)},t.$$.update=()=>{t.$$.dirty&772&&r(6,n=h*(_/g))},[a,i,_,u,o,s,n,l,h,g,m,b,I,R,q]}class st extends re{constructor(e){super(),ne(this,e,gr,mr,$,{brush_radius:0,brush_color:1,container_height:8,img_width:2,img_height:9,mode:3})}}function dr(t){let e,r;return{c(){e=P("img"),V(e.src,r=t[0].image||t[0])||d(e,"src",r),d(e,"alt",""),d(e,"class","svelte-rlgzoo"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(n,l){y(n,e,l)},p(n,l){l[0]&1&&!V(e.src,r=n[0].image||n[0])&&d(e,"src",r),l[0]&544&&W(e,"webcam",n[5]==="webcam"&&n[9])},i:X,o:X,d(n){n&&C(e)}}}function br(t){let e=t[22],r,n,l,o=dt(t),s=t[17]>0&&bt(t);return{c(){o.c(),r=U(),s&&s.c(),n=fe()},m(a,i){o.m(a,i),y(a,r,i),s&&s.m(a,i),y(a,n,i),l=!0},p(a,i){i[0]&4194304&&$(e,e=a[22])?(o.d(1),o=dt(a),o.c(),o.m(r.parentNode,r)):o.p(a,i),a[17]>0?s?(s.p(a,i),i[0]&131072&&p(s,1)):(s=bt(a),s.c(),p(s,1),s.m(n.parentNode,n)):s&&(ee(),A(s,1,1,()=>{s=null}),te())},i(a){l||(p(s),l=!0)},o(a){A(s),l=!1},d(a){o.d(a),a&&C(r),s&&s.d(a),a&&C(n)}}}function kr(t){let e,r,n,l,o;return e=new Oe({props:{editable:!0}}),e.$on("edit",t[53]),e.$on("clear",t[25]),{c(){S(e.$$.fragment),r=U(),n=P("img"),V(n.src,l=t[0])||d(n,"src",l),d(n,"alt",""),d(n,"class","svelte-rlgzoo"),W(n,"webcam",t[5]==="webcam"&&t[9])},m(s,a){E(e,s,a),y(s,r,a),y(s,n,a),o=!0},p(s,a){(!o||a[0]&1&&!V(n.src,l=s[0]))&&d(n,"src",l),a[0]&544&&W(n,"webcam",s[5]==="webcam"&&s[9])},i(s){o||(p(e.$$.fragment,s),o=!0)},o(s){A(e.$$.fragment,s),o=!1},d(s){T(e,s),s&&C(r),s&&C(n)}}}function pr(t){let e,r,n,l,o={image:t[0]};return e=new Mt({props:o}),t[51](e),e.$on("crop",t[26]),n=new Oe({}),n.$on("clear",t[52]),{c(){S(e.$$.fragment),r=U(),S(n.$$.fragment)},m(s,a){E(e,s,a),y(s,r,a),E(n,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(p(e.$$.fragment,s),p(n.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),A(n.$$.fragment,s),l=!1},d(s){t[51](null),T(e,s),s&&C(r),T(n,s)}}}function wr(t){let e,r,n=t[5]==="webcam"&&!t[22]&&pt(t);return{c(){n&&n.c(),e=fe()},m(l,o){n&&n.m(l,o),y(l,e,o),r=!0},p(l,o){l[5]==="webcam"&&!l[22]?n?(n.p(l,o),o[0]&4194336&&p(n,1)):(n=pt(l),n.c(),p(n,1),n.m(e.parentNode,e)):n&&(ee(),A(n,1,1,()=>{n=null}),te())},i(l){r||(p(n),r=!0)},o(l){A(n),r=!1},d(l){n&&n.d(l),l&&C(e)}}}function Ar(t){let e,r,n,l,o,s,a;e=new nt({}),e.$on("undo",t[42]),e.$on("redraw",t[43]),e.$on("clear",t[28]);let i=t[1]==="color-sketch"&&wt(t);function h(u){t[46](u)}function _(u){t[47](u)}let g={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],shape:t[6]};return t[2]!==void 0&&(g.brush_radius=t[2]),t[23]!==void 0&&(g.brush_color=t[23]),l=new rt({props:g}),L.push(()=>G(l,"brush_radius",h)),L.push(()=>G(l,"brush_color",_)),t[48](l),l.$on("change",t[26]),l.$on("clear",t[28]),{c(){S(e.$$.fragment),r=U(),i&&i.c(),n=U(),S(l.$$.fragment)},m(u,m){E(e,u,m),y(u,r,m),i&&i.m(u,m),y(u,n,m),E(l,u,m),a=!0},p(u,m){u[1]==="color-sketch"?i?(i.p(u,m),m[0]&2&&p(i,1)):(i=wt(u),i.c(),p(i,1),i.m(n.parentNode,n)):i&&(ee(),A(i,1,1,()=>{i=null}),te());const b={};m[0]&1&&(b.value=u[0]),m[0]&4096&&(b.mode=u[12]),m[0]&2228224&&(b.width=u[17]||u[21]),m[0]&1114112&&(b.height=u[16]||u[20]),m[0]&1310720&&(b.container_height=u[18]||u[20]),m[0]&64&&(b.shape=u[6]),!o&&m[0]&4&&(o=!0,b.brush_radius=u[2],Q(()=>o=!1)),!s&&m[0]&8388608&&(s=!0,b.brush_color=u[23],Q(()=>s=!1)),l.$set(b)},i(u){a||(p(e.$$.fragment,u),p(i),p(l.$$.fragment,u),a=!0)},o(u){A(e.$$.fragment,u),A(i),A(l.$$.fragment,u),a=!1},d(u){T(e,u),u&&C(r),i&&i.d(u),u&&C(n),t[48](null),T(l,u)}}}function Ir(t){let e,r,n;function l(s){t[41](s)}let o={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[Sr]},$$scope:{ctx:t}};return t[11]!==void 0&&(o.dragging=t[11]),e=new Gt({props:o}),L.push(()=>G(e,"dragging",l)),e.$on("load",t[24]),{c(){S(e.$$.fragment)},m(s,a){E(e,s,a),n=!0},p(s,a){const i={};a[0]&1&&(i.disable_click=!!s[0]),a[0]&16774887|a[2]&2&&(i.$$scope={dirty:a,ctx:s}),!r&&a[0]&2048&&(r=!0,i.dragging=s[11],Q(()=>r=!1)),e.$set(i)},i(s){n||(p(e.$$.fragment,s),n=!0)},o(s){A(e.$$.fragment,s),n=!1},d(s){T(e,s)}}}function dt(t){let e,r,n,l;return{c(){e=P("img"),d(e,"class","absolute-img svelte-rlgzoo"),V(e.src,r=t[22]||t[0]?.image||t[0])||d(e,"src",r),d(e,"alt","load-1"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){y(o,e,s),t[54](e),n||(l=H(e,"load",t[27]),n=!0)},p(o,s){s[0]&4194305&&!V(e.src,r=o[22]||o[0]?.image||o[0])&&d(e,"src",r),s[0]&544&&W(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&C(e),t[54](null),n=!1,l()}}}function bt(t){let e,r,n,l,o,s,a,i;function h(m){t[56](m)}function _(m){t[57](m)}let g={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5]};t[2]!==void 0&&(g.brush_radius=t[2]),t[23]!==void 0&&(g.brush_color=t[23]),e=new rt({props:g}),t[55](e),L.push(()=>G(e,"brush_radius",h)),L.push(()=>G(e,"brush_color",_)),e.$on("change",t[26]),o=new nt({}),o.$on("undo",t[58]),o.$on("redraw",t[59]),o.$on("clear",t[28]);let u=(t[1]==="color-sketch"||t[1]==="sketch")&&kt(t);return{c(){S(e.$$.fragment),l=U(),S(o.$$.fragment),s=U(),u&&u.c(),a=fe()},m(m,b){E(e,m,b),y(m,l,b),E(o,m,b),y(m,s,b),u&&u.m(m,b),y(m,a,b),i=!0},p(m,b){const I={};b[0]&1&&(I.value=m[0]),b[0]&4096&&(I.mode=m[12]),b[0]&2228224&&(I.width=m[17]||m[21]),b[0]&1114112&&(I.height=m[16]||m[20]),b[0]&1310720&&(I.container_height=m[18]||m[20]),b[0]&524288&&(I.value_img=m[19]),b[0]&32&&(I.source=m[5]),!r&&b[0]&4&&(r=!0,I.brush_radius=m[2],Q(()=>r=!1)),!n&&b[0]&8388608&&(n=!0,I.brush_color=m[23],Q(()=>n=!1)),e.$set(I),m[1]==="color-sketch"||m[1]==="sketch"?u?(u.p(m,b),b[0]&2&&p(u,1)):(u=kt(m),u.c(),p(u,1),u.m(a.parentNode,a)):u&&(ee(),A(u,1,1,()=>{u=null}),te())},i(m){i||(p(e.$$.fragment,m),p(o.$$.fragment,m),p(u),i=!0)},o(m){A(e.$$.fragment,m),A(o.$$.fragment,m),A(u),i=!1},d(m){t[55](null),T(e,m),m&&C(l),T(o,m),m&&C(s),u&&u.d(m),m&&C(a)}}}function kt(t){let e,r,n,l;function o(i){t[60](i)}function s(i){t[61](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new st({props:a}),L.push(()=>G(e,"brush_radius",o)),L.push(()=>G(e,"brush_color",s)),{c(){S(e.$$.fragment)},m(i,h){E(e,i,h),l=!0},p(i,h){const _={};h[0]&1310720&&(_.container_height=i[18]||i[20]),h[0]&2228224&&(_.img_width=i[17]||i[21]),h[0]&1114112&&(_.img_height=i[16]||i[20]),h[0]&4096&&(_.mode=i[12]),!r&&h[0]&4&&(r=!0,_.brush_radius=i[2],Q(()=>r=!1)),!n&&h[0]&8388608&&(n=!0,_.brush_color=i[23],Q(()=>n=!1)),e.$set(_)},i(i){l||(p(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){T(e,i)}}}function pt(t){let e,r;return e=new Vt({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[49]),e.$on("stream",t[26]),e.$on("error",t[50]),{c(){S(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,l){const o={};l[0]&128&&(o.streaming=n[7]),l[0]&256&&(o.pending=n[8]),l[0]&512&&(o.mirror_webcam=n[9]),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){A(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function wt(t){let e,r,n,l;function o(i){t[44](i)}function s(i){t[45](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new st({props:a}),L.push(()=>G(e,"brush_radius",o)),L.push(()=>G(e,"brush_color",s)),e.$on("redraw",function(){tt(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){S(e.$$.fragment)},m(i,h){E(e,i,h),l=!0},p(i,h){t=i;const _={};h[0]&1310720&&(_.container_height=t[18]||t[20]),h[0]&2228224&&(_.img_width=t[17]||t[21]),h[0]&1114112&&(_.img_height=t[16]||t[20]),!r&&h[0]&4&&(r=!0,_.brush_radius=t[2],Q(()=>r=!1)),!n&&h[0]&8388608&&(n=!0,_.brush_color=t[23],Q(()=>n=!1)),e.$set(_)},i(i){l||(p(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){T(e,i)}}}function yr(t){let e,r;return{c(){e=P("img"),V(e.src,r=t[0].image||t[0])||d(e,"src",r),d(e,"alt","hello"),d(e,"class","svelte-rlgzoo"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(n,l){y(n,e,l)},p(n,l){l[0]&1&&!V(e.src,r=n[0].image||n[0])&&d(e,"src",r),l[0]&544&&W(e,"webcam",n[5]==="webcam"&&n[9])},i:X,o:X,d(n){n&&C(e)}}}function Cr(t){let e=t[22],r,n,l,o=At(t),s=t[17]>0&&It(t);return{c(){o.c(),r=U(),s&&s.c(),n=fe()},m(a,i){o.m(a,i),y(a,r,i),s&&s.m(a,i),y(a,n,i),l=!0},p(a,i){i[0]&4194304&&$(e,e=a[22])?(o.d(1),o=At(a),o.c(),o.m(r.parentNode,r)):o.p(a,i),a[17]>0?s?(s.p(a,i),i[0]&131072&&p(s,1)):(s=It(a),s.c(),p(s,1),s.m(n.parentNode,n)):s&&(ee(),A(s,1,1,()=>{s=null}),te())},i(a){l||(p(s),l=!0)},o(a){A(s),l=!1},d(a){o.d(a),a&&C(r),s&&s.d(a),a&&C(n)}}}function zr(t){let e,r,n,l,o;return e=new Oe({props:{editable:!0}}),e.$on("edit",t[32]),e.$on("clear",t[25]),{c(){S(e.$$.fragment),r=U(),n=P("img"),V(n.src,l=t[0])||d(n,"src",l),d(n,"alt",""),d(n,"class","svelte-rlgzoo"),W(n,"scale-x-[-1]",t[5]==="webcam"&&t[9])},m(s,a){E(e,s,a),y(s,r,a),y(s,n,a),o=!0},p(s,a){(!o||a[0]&1&&!V(n.src,l=s[0]))&&d(n,"src",l),a[0]&544&&W(n,"scale-x-[-1]",s[5]==="webcam"&&s[9])},i(s){o||(p(e.$$.fragment,s),o=!0)},o(s){A(e.$$.fragment,s),o=!1},d(s){T(e,s),s&&C(r),s&&C(n)}}}function vr(t){let e,r,n,l,o={image:t[0]};return e=new Mt({props:o}),t[30](e),e.$on("crop",t[26]),n=new Oe({}),n.$on("clear",t[31]),{c(){S(e.$$.fragment),r=U(),S(n.$$.fragment)},m(s,a){E(e,s,a),y(s,r,a),E(n,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(p(e.$$.fragment,s),p(n.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),A(n.$$.fragment,s),l=!1},d(s){t[30](null),T(e,s),s&&C(r),T(n,s)}}}function Mr(t){let e;const r=t[29].default,n=qt(r,t,t[63],null);return{c(){n&&n.c()},m(l,o){n&&n.m(l,o),e=!0},p(l,o){n&&n.p&&(!e||o[2]&2)&&jt(n,r,l,l[63],e?Ut(r,l[63],o,null):Lt(l[63]),null)},i(l){e||(p(n,l),e=!0)},o(l){A(n,l),e=!1},d(l){n&&n.d(l)}}}function At(t){let e,r,n,l;return{c(){e=P("img"),d(e,"class","absolute-img svelte-rlgzoo"),V(e.src,r=t[22]||t[0].image||t[0])||d(e,"src",r),d(e,"data-source",t[14]),d(e,"data-isupload",t[15]),d(e,"alt","load-2"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){y(o,e,s),t[33](e),n||(l=H(e,"load",t[27]),n=!0)},p(o,s){s[0]&4194305&&!V(e.src,r=o[22]||o[0].image||o[0])&&d(e,"src",r),s[0]&16384&&d(e,"data-source",o[14]),s[0]&32768&&d(e,"data-isupload",o[15]),s[0]&544&&W(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&C(e),t[33](null),n=!1,l()}}}function It(t){let e,r,n,l,o,s,a,i;function h(m){t[35](m)}function _(m){t[36](m)}let g={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5],shape:t[6]};t[2]!==void 0&&(g.brush_radius=t[2]),t[23]!==void 0&&(g.brush_color=t[23]),e=new rt({props:g}),t[34](e),L.push(()=>G(e,"brush_radius",h)),L.push(()=>G(e,"brush_color",_)),e.$on("change",t[26]),e.$on("redraw",function(){tt(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),o=new nt({}),o.$on("undo",t[37]),o.$on("redraw",t[38]),o.$on("clear",t[28]);let u=(t[1]==="color-sketch"||t[1]==="sketch")&&yt(t);return{c(){S(e.$$.fragment),l=U(),S(o.$$.fragment),s=U(),u&&u.c(),a=fe()},m(m,b){E(e,m,b),y(m,l,b),E(o,m,b),y(m,s,b),u&&u.m(m,b),y(m,a,b),i=!0},p(m,b){t=m;const I={};b[0]&1&&(I.value=t[0]),b[0]&4096&&(I.mode=t[12]),b[0]&2228224&&(I.width=t[17]||t[21]),b[0]&1114112&&(I.height=t[16]||t[20]),b[0]&1310720&&(I.container_height=t[18]||t[20]),b[0]&524288&&(I.value_img=t[19]),b[0]&32&&(I.source=t[5]),b[0]&64&&(I.shape=t[6]),!r&&b[0]&4&&(r=!0,I.brush_radius=t[2],Q(()=>r=!1)),!n&&b[0]&8388608&&(n=!0,I.brush_color=t[23],Q(()=>n=!1)),e.$set(I),t[1]==="color-sketch"||t[1]==="sketch"?u?(u.p(t,b),b[0]&2&&p(u,1)):(u=yt(t),u.c(),p(u,1),u.m(a.parentNode,a)):u&&(ee(),A(u,1,1,()=>{u=null}),te())},i(m){i||(p(e.$$.fragment,m),p(o.$$.fragment,m),p(u),i=!0)},o(m){A(e.$$.fragment,m),A(o.$$.fragment,m),A(u),i=!1},d(m){t[34](null),T(e,m),m&&C(l),T(o,m),m&&C(s),u&&u.d(m),m&&C(a)}}}function yt(t){let e,r,n,l;function o(i){t[39](i)}function s(i){t[40](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new st({props:a}),L.push(()=>G(e,"brush_radius",o)),L.push(()=>G(e,"brush_color",s)),e.$on("redraw",function(){tt(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){S(e.$$.fragment)},m(i,h){E(e,i,h),l=!0},p(i,h){t=i;const _={};h[0]&1310720&&(_.container_height=t[18]||t[20]),h[0]&2228224&&(_.img_width=t[17]||t[21]),h[0]&1114112&&(_.img_height=t[16]||t[20]),h[0]&4096&&(_.mode=t[12]),!r&&h[0]&4&&(r=!0,_.brush_radius=t[2],Q(()=>r=!1)),!n&&h[0]&8388608&&(n=!0,_.brush_color=t[23],Q(()=>n=!1)),e.$set(_)},i(i){l||(p(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){T(e,i)}}}function Sr(t){let e,r,n,l;const o=[Mr,vr,zr,Cr,yr],s=[];function a(i,h){return i[0]===null&&!i[22]||i[7]?0:i[1]==="select"?1:i[1]==="editor"?2:(i[1]==="sketch"||i[1]==="color-sketch")&&(i[0]!==null||i[22])?3:4}return e=a(t),r=s[e]=o[e](t),{c(){r.c(),n=fe()},m(i,h){s[e].m(i,h),y(i,n,h),l=!0},p(i,h){let _=e;e=a(i),e===_?s[e].p(i,h):(ee(),A(s[_],1,1,()=>{s[_]=null}),te(),r=s[e],r?r.p(i,h):(r=s[e]=o[e](i),r.c()),p(r,1),r.m(n.parentNode,n))},i(i){l||(p(r),l=!0)},o(i){A(r),l=!1},d(i){s[e].d(i),i&&C(n)}}}function Er(t){let e,r,n,l,o,s,a;e=new vt({props:{show_label:t[4],Icon:t[5]==="canvas"?ot:Fe,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const i=[Ir,Ar,wr,pr,kr,br,dr],h=[];function _(g,u){return g[5]==="upload"?0:g[5]==="canvas"?1:g[0]===null&&!g[22]||g[7]?2:g[1]==="select"?3:g[1]==="editor"?4:(g[1]==="sketch"||g[1]==="color-sketch")&&(g[0]!==null||g[22])?5:6}return l=_(t),o=h[l]=i[l](t),{c(){S(e.$$.fragment),r=U(),n=P("div"),o.c(),d(n,"data-testid","image"),d(n,"class","svelte-rlgzoo"),xe(()=>t[62].call(n)),W(n,"fixed-height",t[5]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(g,u){E(e,g,u),y(g,r,u),y(g,n,u),h[l].m(n,null),s=Ct(n,t[62].bind(n)),a=!0},p(g,u){const m={};u[0]&16&&(m.show_label=g[4]),u[0]&32&&(m.Icon=g[5]==="canvas"?ot:Fe),u[0]&40&&(m.label=g[3]||(g[5]==="canvas"?"Sketch":"Image")),e.$set(m);let b=l;l=_(g),l===b?h[l].p(g,u):(ee(),A(h[b],1,1,()=>{h[b]=null}),te(),o=h[l],o?o.p(g,u):(o=h[l]=i[l](g),o.c()),p(o,1),o.m(n,null)),u[0]&34&&W(n,"fixed-height",g[5]!=="webcam"||g[1]==="sketch"||g[1]==="color-sketch")},i(g){a||(p(e.$$.fragment,g),p(o),a=!0)},o(g){A(e.$$.fragment,g),A(o),a=!1},d(g){T(e,g),g&&C(r),g&&C(n),h[l].d(),s()}}}function Tr(t,e,r){let n,{$$slots:l={},$$scope:o}=e,{value:s}=e,{label:a=void 0}=e,{show_label:i}=e,{source:h="upload"}=e,{tool:_="editor"}=e,{shape:g}=e,{streaming:u=!1}=e,{pending:m=!1}=e,{mirror_webcam:b}=e,{brush_radius:I}=e,R,q,D="",se=!1;s&&(h==="upload"||h==="webcam")&&_==="sketch"&&(s={image:s,mask:null});function le({detail:f}){_==="color-sketch"?r(22,Z=f):r(0,s=(h==="upload"||h==="webcam")&&_==="sketch"?{image:f,mask:null}:f),r(15,se=!0),console.log(1),M("upload",f)}function ie({detail:f}){r(0,s=null),r(22,Z=void 0),M("clear")}async function be({detail:f},z,v=!1){O==="mask"?h==="webcam"&&z?r(0,s={image:f,mask:null}):r(0,s={image:typeof s=="string"?s:s?.image||null,mask:f}):(h==="upload"||h==="webcam")&&_==="sketch"?r(0,s={image:f,mask:null}):(D===""&&r(14,D=f),r(0,s=f)),await pe(),M(u?"stream":"edit")}const M=de();let k=!1;function J(f){const z=f.currentTarget;r(17,ae=z.naturalWidth),r(16,oe=z.naturalHeight),r(18,w=z.getBoundingClientRect().height)}async function F(){R.clear(),await pe(),r(0,s=null),r(22,Z=void 0),r(14,D=""),r(15,se=!1)}let oe=0,ae=0,w=0,O,N,x,_e,Z;zt(async()=>{_==="color-sketch"&&s&&typeof s=="string"&&(r(22,Z=s),await pe(),J({currentTarget:N}))});function he(f){L[f?"unshift":"push"](()=>{q=f,r(10,q),r(0,s)})}const ze=f=>(ie(f),r(1,_="editor")),We=()=>r(1,_="select");function Ye(f){L[f?"unshift":"push"](()=>{N=f,r(19,N)})}function ke(f){L[f?"unshift":"push"](()=>{R=f,r(13,R)})}function Xe(f){I=f,r(2,I)}function ve(f){n=f,r(23,n),r(12,O),r(5,h),r(1,_)}const He=()=>R.undo(),Me=()=>R.redraw();function Se(f){I=f,r(2,I)}function Ee(f){n=f,r(23,n),r(12,O),r(5,h),r(1,_)}function Te(f){k=f,r(11,k)}const Be=()=>R.undo(),ce=()=>R.redraw();function De(f){I=f,r(2,I)}function Ve(f){n=f,r(23,n),r(12,O),r(5,h),r(1,_)}function Re(f){I=f,r(2,I)}function Ae(f){n=f,r(23,n),r(12,O),r(5,h),r(1,_)}function qe(f){L[f?"unshift":"push"](()=>{R=f,r(13,R)})}const Je=f=>_==="color-sketch"?le(f):be(f,!0,"pizda");function je(f){ge.call(this,t,f)}function Le(f){L[f?"unshift":"push"](()=>{q=f,r(10,q),r(0,s)})}const ue=f=>(ie(f),r(1,_="editor")),me=()=>r(1,_="select");function Ie(f){L[f?"unshift":"push"](()=>{N=f,r(19,N)})}function ye(f){L[f?"unshift":"push"](()=>{R=f,r(13,R)})}function Qe(f){I=f,r(2,I)}function Ue(f){n=f,r(23,n),r(12,O),r(5,h),r(1,_)}const Ge=()=>R.undo(),Ze=()=>R.redraw();function Ke(f){I=f,r(2,I)}function $e(f){n=f,r(23,n),r(12,O),r(5,h),r(1,_)}function c(){x=this.offsetHeight,_e=this.offsetWidth,r(20,x),r(21,_e)}return t.$$set=f=>{"value"in f&&r(0,s=f.value),"label"in f&&r(3,a=f.label),"show_label"in f&&r(4,i=f.show_label),"source"in f&&r(5,h=f.source),"tool"in f&&r(1,_=f.tool),"shape"in f&&r(6,g=f.shape),"streaming"in f&&r(7,u=f.streaming),"pending"in f&&r(8,m=f.pending),"mirror_webcam"in f&&r(9,b=f.mirror_webcam),"brush_radius"in f&&r(2,I=f.brush_radius),"$$scope"in f&&r(63,o=f.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&M("change",s),t.$$.dirty[0]&2048&&M("drag",k),t.$$.dirty[0]&34&&(h==="canvas"&&_==="sketch"?r(12,O="bw-sketch"):_==="color-sketch"?r(12,O="color-sketch"):(h==="upload"||h==="webcam")&&_==="sketch"?r(12,O="mask"):r(12,O="editor")),t.$$.dirty[0]&4096&&r(23,n=O=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&r(22,Z=void 0),t.$$.dirty[0]&1025&&q&&(s?(r(10,q.image=s,q),q.create()):q.destroy())},[s,_,I,a,i,h,g,u,m,b,q,k,O,R,D,se,oe,ae,w,N,x,_e,Z,n,le,ie,be,J,F,l,he,ze,We,Ye,ke,Xe,ve,He,Me,Se,Ee,Te,Be,ce,De,Ve,Re,Ae,qe,Je,je,Le,ue,me,Ie,ye,Qe,Ue,Ge,Ze,Ke,$e,c,o]}class Br extends re{constructor(e){super(),ne(this,e,Tr,Er,$,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2},null,[-1,-1,-1])}}function Dr(t){let e,r,n,l,o,s,a;return n=new we({props:{Icon:Kt,label:"Download"}}),{c(){e=P("div"),r=P("a"),S(n.$$.fragment),l=U(),o=P("img"),d(r,"href",t[0]),d(r,"target",window.__is_colab__?"_blank":null),d(r,"download","image"),d(e,"class","download svelte-kt1jzh"),V(o.src,s=t[0])||d(o,"src",s),d(o,"alt",""),d(o,"class","svelte-kt1jzh")},m(i,h){y(i,e,h),Y(e,r),E(n,r,null),y(i,l,h),y(i,o,h),a=!0},p(i,h){(!a||h&1)&&d(r,"href",i[0]),(!a||h&1&&!V(o.src,s=i[0]))&&d(o,"src",s)},i(i){a||(p(n.$$.fragment,i),a=!0)},o(i){A(n.$$.fragment,i),a=!1},d(i){i&&C(e),T(n),i&&C(l),i&&C(o)}}}function Rr(t){let e,r;return e=new Zt({props:{size:"large",unpadded_box:!0,$$slots:{default:[qr]},$$scope:{ctx:t}}}),{c(){S(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,l){const o={};l&16&&(o.$$scope={dirty:l,ctx:n}),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){A(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function qr(t){let e,r;return e=new Fe({}),{c(){S(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){A(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function jr(t){let e,r,n,l,o,s;e=new vt({props:{show_label:t[2],Icon:Fe,label:t[1]||"Image"}});const a=[Rr,Dr],i=[];function h(_,g){return _[0]===null?0:1}return n=h(t),l=i[n]=a[n](t),{c(){S(e.$$.fragment),r=U(),l.c(),o=fe()},m(_,g){E(e,_,g),y(_,r,g),i[n].m(_,g),y(_,o,g),s=!0},p(_,[g]){const u={};g&4&&(u.show_label=_[2]),g&2&&(u.label=_[1]||"Image"),e.$set(u);let m=n;n=h(_),n===m?i[n].p(_,g):(ee(),A(i[m],1,1,()=>{i[m]=null}),te(),l=i[n],l?l.p(_,g):(l=i[n]=a[n](_),l.c()),p(l,1),l.m(o.parentNode,o))},i(_){s||(p(e.$$.fragment,_),p(l),s=!0)},o(_){A(e.$$.fragment,_),A(l),s=!1},d(_){T(e,_),_&&C(r),i[n].d(_),_&&C(o)}}}function Lr(t,e,r){let{value:n}=e,{label:l=void 0}=e,{show_label:o}=e;const s=de();return t.$$set=a=>{"value"in a&&r(0,n=a.value),"label"in a&&r(1,l=a.label),"show_label"in a&&r(2,o=a.show_label)},t.$$.update=()=>{t.$$.dirty&1&&n&&s("change",n)},[n,l,o]}class Ur extends re{constructor(e){super(),ne(this,e,Lr,jr,$,{value:0,label:1,show_label:2})}}function Nr(t){let e,r,n;function l(s){t[17](s)}let o={brush_radius:t[14],shape:t[13],source:t[5],tool:t[6],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[12],$$slots:{default:[Fr]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.value=t[0]),e=new Br({props:o}),L.push(()=>G(e,"value",l)),e.$on("edit",t[18]),e.$on("clear",t[19]),e.$on("change",t[20]),e.$on("stream",t[21]),e.$on("drag",t[22]),e.$on("upload",t[23]),e.$on("error",t[24]),{c(){S(e.$$.fragment)},m(s,a){E(e,s,a),n=!0},p(s,a){const i={};a&16384&&(i.brush_radius=s[14]),a&8192&&(i.shape=s[13]),a&32&&(i.source=s[5]),a&64&&(i.tool=s[6]),a&128&&(i.label=s[7]),a&256&&(i.show_label=s[8]),a&1024&&(i.pending=s[10]),a&512&&(i.streaming=s[9]),a&4096&&(i.mirror_webcam=s[12]),a&67108864&&(i.$$scope={dirty:a,ctx:s}),!r&&a&1&&(r=!0,i.value=s[0],Q(()=>r=!1)),e.$set(i)},i(s){n||(p(e.$$.fragment,s),n=!0)},o(s){A(e.$$.fragment,s),n=!1},d(s){T(e,s)}}}function Pr(t){let e,r;return e=new Ur({props:{value:t[0],label:t[7],show_label:t[8]}}),{c(){S(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,l){const o={};l&1&&(o.value=n[0]),l&128&&(o.label=n[7]),l&256&&(o.show_label=n[8]),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){A(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function Fr(t){let e,r;return e=new $t({props:{type:"image"}}),{c(){S(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p:X,i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){A(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function Or(t){let e,r,n,l,o,s;const a=[t[1]];let i={};for(let u=0;u<a.length;u+=1)i=Nt(i,a[u]);e=new Pt({props:i});const h=[Pr,Nr],_=[];function g(u,m){return u[15]==="static"?0:1}return n=g(t),l=_[n]=h[n](t),{c(){S(e.$$.fragment),r=U(),l.c(),o=fe()},m(u,m){E(e,u,m),y(u,r,m),_[n].m(u,m),y(u,o,m),s=!0},p(u,m){const b=m&2?Ft(a,[Ot(u[1])]):{};e.$set(b);let I=n;n=g(u),n===I?_[n].p(u,m):(ee(),A(_[I],1,1,()=>{_[I]=null}),te(),l=_[n],l?l.p(u,m):(l=_[n]=h[n](u),l.c()),p(l,1),l.m(o.parentNode,o))},i(u){s||(p(e.$$.fragment,u),p(l),s=!0)},o(u){A(e.$$.fragment,u),A(l),s=!1},d(u){T(e,u),u&&C(r),_[n].d(u),u&&C(o)}}}function Wr(t){let e,r;return e=new Wt({props:{visible:t[4],variant:t[15]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[16]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],style:{height:t[11].height,width:t[11].width},allow_overflow:!1,$$slots:{default:[Or]},$$scope:{ctx:t}}}),{c(){S(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,[l]){const o={};l&16&&(o.visible=n[4]),l&32801&&(o.variant=n[15]==="dynamic"&&n[0]===null&&n[5]==="upload"?"dashed":"solid"),l&65536&&(o.border_mode=n[16]?"focus":"base"),l&4&&(o.elem_id=n[2]),l&8&&(o.elem_classes=n[3]),l&2048&&(o.style={height:n[11].height,width:n[11].width}),l&67237859&&(o.$$scope={dirty:l,ctx:n}),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){A(e.$$.fragment,n),r=!1},d(n){T(e,n)}}}function Yr(t,e,r){let{elem_id:n=""}=e,{elem_classes:l=[]}=e,{visible:o=!0}=e,{value:s=null}=e,{source:a="upload"}=e,{tool:i="editor"}=e,{label:h}=e,{show_label:_}=e,{streaming:g}=e,{pending:u}=e,{style:m={}}=e,{mirror_webcam:b}=e,{shape:I}=e,{brush_radius:R}=e,{loading_status:q}=e,{mode:D}=e;const se=de();let le;function ie(w){s=w,r(0,s)}function be(w){ge.call(this,t,w)}function M(w){ge.call(this,t,w)}function k(w){ge.call(this,t,w)}function J(w){ge.call(this,t,w)}const F=({detail:w})=>r(16,le=w);function oe(w){ge.call(this,t,w)}const ae=({detail:w})=>{r(1,q=q||{}),r(1,q.status="error",q),r(1,q.message=w,q)};return t.$$set=w=>{"elem_id"in w&&r(2,n=w.elem_id),"elem_classes"in w&&r(3,l=w.elem_classes),"visible"in w&&r(4,o=w.visible),"value"in w&&r(0,s=w.value),"source"in w&&r(5,a=w.source),"tool"in w&&r(6,i=w.tool),"label"in w&&r(7,h=w.label),"show_label"in w&&r(8,_=w.show_label),"streaming"in w&&r(9,g=w.streaming),"pending"in w&&r(10,u=w.pending),"style"in w&&r(11,m=w.style),"mirror_webcam"in w&&r(12,b=w.mirror_webcam),"shape"in w&&r(13,I=w.shape),"brush_radius"in w&&r(14,R=w.brush_radius),"loading_status"in w&&r(1,q=w.loading_status),"mode"in w&&r(15,D=w.mode)},t.$$.update=()=>{t.$$.dirty&1&&r(0,s=s||null),t.$$.dirty&1&&se("change")},[s,q,n,l,o,a,i,h,_,g,u,m,b,I,R,D,le,ie,be,M,k,J,F,oe,ae]}class Xr extends re{constructor(e){super(),ne(this,e,Yr,Wr,$,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,style:11,mirror_webcam:12,shape:13,brush_radius:14,loading_status:1,mode:15})}}var ln=Xr;const on=["static","dynamic"],an=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{ln as Component,_n as ExampleComponent,an as document,on as modes};
//# sourceMappingURL=index.fc7fdf26.js.map
