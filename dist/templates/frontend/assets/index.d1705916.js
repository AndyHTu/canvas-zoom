import{S as x,i as ee,s as Z,A as G,B as d,f as C,D as H,E as Y,p as z,a6 as yt,F,K as J,q as me,b as j,a3 as Qe,ah as $e,a5 as xe,C as Ct,O as W,I as P,ad as zt,a2 as pt,G as q,ak as kt,o as k,k as K,t as A,n as $,N as vt,r as wt,V as de,ac as Mt,x as ce,c as B,m as R,l as S,M as Le,an as Tt,e as ae,j as V,a as X,W as Bt,X as Rt,Y as St,Z as Dt,v as Et,a7 as jt,g as Lt,h as Ut}from"./index.ec637aae.js";import{a as qt}from"./Empty.svelte_svelte_type_style_lang.e5cb3f6c.js";import{B as At}from"./BlockLabel.adb3a7a8.js";/* empty css                                                    */import{I as Ue}from"./Image.1fcd7fcd.js";import{C as Nt,i as Ft,U as Wt,W as Ot}from"./StaticImage.svelte_svelte_type_style_lang.1c433fa6.js";import{I as be,C as Ht,M as qe}from"./ModifyUpload.cdb0f976.js";import{C as Yt}from"./Copy.750a8f29.js";import{U as Jt}from"./Upload.3e4319bc.js";import{E as Pt}from"./Empty.59d70f34.js";import{D as Vt}from"./Download.c9672155.js";import"./Blocks.1e69eb7e.js";import{U as Xt}from"./UploadText.f428bc14.js";import{E as ir}from"./Image.af2d9723.js";import"./ModifyUpload.svelte_svelte_type_style_lang.e946db2d.js";function Qt(t){let e,n,r;return{c(){e=G("svg"),n=G("path"),r=G("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(r,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(r,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(l,u){C(l,e,u),H(e,n),H(e,r)},p:Y,i:Y,o:Y,d(l){l&&z(e)}}}class Gt extends x{constructor(e){super(),ee(this,e,null,Qt,Z,{})}}function Zt(t){let e,n,r,l,u,s,a;return{c(){e=G("svg"),n=G("circle"),r=G("circle"),l=G("circle"),u=G("circle"),s=G("circle"),a=G("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(r,"cx","16"),d(r,"cy","9"),d(r,"r","2"),d(r,"fill","currentColor"),d(l,"cx","22"),d(l,"cy","12"),d(l,"r","2"),d(l,"fill","currentColor"),d(u,"cx","23"),d(u,"cy","18"),d(u,"r","2"),d(u,"fill","currentColor"),d(s,"cx","19"),d(s,"cy","23"),d(s,"r","2"),d(s,"fill","currentColor"),d(a,"fill","currentColor"),d(a,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(i,h){C(i,e,h),H(e,n),H(e,r),H(e,l),H(e,u),H(e,s),H(e,a)},p:Y,i:Y,o:Y,d(i){i&&z(e)}}}class Kt extends x{constructor(e){super(),ee(this,e,null,Zt,Z,{})}}function $t(t){let e,n;return{c(){e=G("svg"),n=G("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(r,l){C(r,e,l),H(e,n)},p:Y,i:Y,o:Y,d(r){r&&z(e)}}}class et extends x{constructor(e){super(),ee(this,e,null,$t,Z,{})}}function xt(t){let e,n;return{c(){e=F("img"),J(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(r,l){C(r,e,l),t[4](e)},p(r,[l]){l&1&&!J(e.src,n=r[0])&&d(e,"src",n)},i:Y,o:Y,d(r){r&&z(e),t[4](null)}}}function en(t,e,n){let{image:r}=e,l;const u=me();let s;function a(){s.destroy()}function i(){s&&a(),s=new Nt(l,{autoCropArea:1,cropend(){const f=s.getCroppedCanvas().toDataURL();u("crop",f)}}),u("crop",r)}function h(f){j[f?"unshift":"push"](()=>{l=f,n(1,l)})}return t.$$set=f=>{"image"in f&&n(0,r=f.image)},[r,l,a,i,h]}class It extends x{constructor(e){super(),ee(this,e,en,xt,Z,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),yt()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class tt{constructor(e,n){this.x=e,this.y=n}}class nt extends tt{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const r=e+Math.PI/2;this.x=this.x+Math.sin(r)*n,this.y=this.y-Math.cos(r)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new tt(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const tn=30;class nn{constructor({radius:e=tn,enabled:n=!0,initialPoint:r={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new nt(r.x,r.y),this.brush=new nt(r.x,r.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function rt(t,e,n){const r=t.slice();return r[61]=e[n].name,r[62]=e[n].zIndex,r[63]=e,r[64]=n,r}function st(t){let e,n,r;return{c(){e=F("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-1nz44y8")},m(l,u){C(l,e,u),r=!0},i(l){r||(Qe(()=>{n||(n=$e(e,xe,{duration:50},!0)),n.run(1)}),r=!0)},o(l){n||(n=$e(e,xe,{duration:50},!1)),n.run(0),r=!1},d(l){l&&z(e),l&&n&&n.end()}}}function it(t){let e,n,r=t[61],l,u;const s=()=>t[30](e,r),a=()=>t[30](null,r);return{c(){e=F("canvas"),d(e,"key",n=t[61]),Ct(e,"z-index",t[62]),d(e,"class","svelte-1nz44y8"),W(e,"lr",t[5]),W(e,"tb",!t[5])},m(i,h){C(i,e,h),s(),l||(u=[P(e,"mousedown",t[61]==="interface"?t[7]:void 0),P(e,"mousemove",t[61]==="interface"?t[8]:void 0),P(e,"mouseup",t[61]==="interface"?t[9]:void 0),P(e,"mouseout",t[61]==="interface"?t[9]:void 0),P(e,"blur",t[61]==="interface"?t[9]:void 0),P(e,"touchstart",t[61]==="interface"?t[7]:void 0),P(e,"touchmove",t[61]==="interface"?t[8]:void 0),P(e,"touchend",t[61]==="interface"?t[9]:void 0),P(e,"touchcancel",t[61]==="interface"?t[9]:void 0),P(e,"click",zt(t[29]))],l=!0)},p(i,h){t=i,r!==t[61]&&(a(),r=t[61],s()),h[0]&32&&W(e,"lr",t[5]),h[0]&32&&W(e,"tb",!t[5])},d(i){i&&z(e),a(),l=!1,pt(u)}}}function rn(t){let e,n,r,l,u=t[4]===0&&st(),s=t[6],a=[];for(let i=0;i<s.length;i+=1)a[i]=it(rt(t,s,i));return{c(){e=F("div"),u&&u.c(),n=q();for(let i=0;i<a.length;i+=1)a[i].c();d(e,"class","wrap svelte-1nz44y8"),Qe(()=>t[32].call(e))},m(i,h){C(i,e,h),u&&u.m(e,null),H(e,n);for(let f=0;f<a.length;f+=1)a[f].m(e,null);t[31](e),r=kt(e,t[32].bind(e)),l=!0},p(i,h){if(i[4]===0?u?h[0]&16&&k(u,1):(u=st(),u.c(),k(u,1),u.m(e,n)):u&&(K(),A(u,1,1,()=>{u=null}),$()),h[0]&993){s=i[6];let f;for(f=0;f<s.length;f+=1){const g=rt(i,s,f);a[f]?a[f].p(g,h):(a[f]=it(g),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=s.length}},i(i){l||(k(u),l=!0)},o(i){A(u),l=!1},d(i){i&&z(e),u&&u.d(),vt(a,i),t[31](null),r()}}}let sn="#aaa";function lt(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function ln(t,e,n){let r;const l=me();let{value:u}=e,{value_img:s}=e,{mode:a="sketch"}=e,{brush_color:i="#0b0f19"}=e,{brush_radius:h}=e,{source:f}=e,{width:g=400}=e,{height:o=200}=e,{container_height:_=200}=e,{shape:b}=e,I,M=g,L=o,te;const oe=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let E={},p={},O=[],U=[],ue=!0,ne=!0,re=!1,se=!1,D=null,w=null,fe=null,ie=0;function Q(){if(!b){p.temp.drawImage(s,0,0,g,o);return}let c=s.naturalWidth,y=s.naturalHeight;const v=b[0]/b[1],T=c/y;let m=0,N=0;v<T?(c=b[1]*T,y=b[1],m=(b[0]-c)/2):v>T?(c=b[0],y=b[0]/T,N=(b[1]-y)/2):(m=0,N=0,c=b[0],y=b[1]),p.temp.drawImage(s,m,N,c,y)}wt(async()=>{Object.keys(E).forEach(c=>{n(26,p[c]=E[c].getContext("2d"),p)}),await de(),s&&(s.addEventListener("load",c=>{f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):Q(),p.drawing.drawImage(E.temp,0,0,g,o),le()}),setTimeout(()=>{f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):Q(),p.drawing.drawImage(E.temp,0,0,g,o),ge({lines:U.slice()}),le()},100)),n(28,D=new nn({radius:h*.05,enabled:!0,initialPoint:{x:g/2,y:o/2}})),fe=new Ft((c,y,...v)=>{Me(c,y)}),fe.observe(w),ke(),n(24,I=!0),requestAnimationFrame(()=>{Ae(),requestAnimationFrame(()=>{he()})})});function Ae(){const c=g/2,y=o/2;D.update({x:c,y},{both:!0}),D.update({x:c,y},{both:!1}),ue=!0,ne=!0}Mt(()=>{n(24,I=!1),fe.unobserve(w)});function Ne(){const c=U.slice(0,-1);pe(),s&&(f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):Q(),(!U||!U.length)&&p.drawing.drawImage(E.temp,0,0,g,o)),ge({lines:c}),n(4,ie=c.length),U.length&&n(27,U=c),U.length==0&&l("clear"),le()}function Fe(){console.log("first init",U,s),pe(),s&&(f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):Q(),(!U||!U.length)&&p.drawing.drawImage(E.temp,0,0,g,o)),ge({lines:U}),n(4,ie=U.length),U.length==0&&l("clear"),le()}let ge=({lines:c})=>{c.forEach(y=>{let{points:v,brush_color:T,brush_radius:m}=y;Re({points:v,brush_color:T,brush_radius:m}),a==="mask"&&Se({points:v,brush_color:T,brush_radius:m}),O=v}),Ee({brush_color:i,brush_radius:h}),a==="mask"&&De()},We=c=>{c.preventDefault(),se=!0;const{x:y,y:v}=Te(c);c.touches&&c.touches.length>0&&D.update({x:y,y:v},{both:!0}),Be(y,v),n(4,ie+=1)},Ie=c=>{c.preventDefault();const{x:y,y:v}=Te(c);Be(y,v)},Oe=c=>{c.preventDefault(),Ie(c),re=!1,se=!1,Ee(),a==="mask"&&De()},ye=0,Ce=0,ze=0,ve=!1,Me=async()=>{if(b&&w){const v=w?.getBoundingClientRect(),T=b[0]/b[1],m=v.width/v.height;n(5,ve=T<m)}if(g===ye&&o===Ce&&ze===_)return;const c={width:g,height:o},y={height:_,width:_*(c.width/c.height)};await Promise.all([_e(E.interface,c,y),_e(E.drawing,c,y),_e(E.temp,c,y),_e(E.temp_fake,c,y),_e(E.mask,c,y,!1)]),h||n(10,h=20*(c.width/y.width)),ke({once:!0}),setTimeout(()=>{Ce=o,ye=g,ze=_},10),await de(),he()},_e=async(c,y,v,T=!0)=>{if(!I)return;await de();const m=window.devicePixelRatio||1;c.width=y.width*(T?m:1),c.height=y.height*(T?m:1);const N=c.getContext("2d");T&&N.scale(m,m),c.style.width=`${v.width}px`,c.style.height=`${v.height}px`},Te=c=>{const y=E.interface.getBoundingClientRect();let v=c.clientX,T=c.clientY;return c.changedTouches&&c.changedTouches.length>0&&(v=c.changedTouches[0].clientX,T=c.changedTouches[0].clientY),{x:(v-y.left)/y.width*g,y:(T-y.top)/y.height*o}},Be=(c,y)=>{D.update({x:c,y});const v=!D.isEnabled();(se&&!re||v&&se)&&(re=!0,O.push(D.brush.toObject())),re&&(O.push(D.brush.toObject()),Re({points:O,brush_color:i,brush_radius:h}),a==="mask"&&Se({points:O,brush_color:i,brush_radius:h})),ue=!0},Re=({points:c,brush_color:y,brush_radius:v})=>{if(!c||c.length<2||(n(26,p.temp.lineJoin="round",p),n(26,p.temp.lineCap="round",p),n(26,p.temp.strokeStyle=y,p),n(26,p.temp.lineWidth=v,p),!c||c.length<2))return;let T=c[0],m=c[1];p.temp.moveTo(m.x,m.y),p.temp.beginPath();for(var N=1,Xe=c.length;N<Xe;N++){var we=lt(T,m);p.temp.quadraticCurveTo(T.x,T.y,we.x,we.y),T=c[N],m=c[N+1]}p.temp.lineTo(T.x,T.y),p.temp.stroke()},Se=({points:c,brush_color:y,brush_radius:v})=>{if(!c||c.length<2)return;n(26,p.temp_fake.lineJoin="round",p),n(26,p.temp_fake.lineCap="round",p),n(26,p.temp_fake.strokeStyle="#fff",p),n(26,p.temp_fake.lineWidth=v,p);let T=c[0],m=c[1];p.temp_fake.moveTo(m.x,m.y),p.temp_fake.beginPath();for(var N=1,Xe=c.length;N<Xe;N++){var we=lt(T,m);p.temp_fake.quadraticCurveTo(T.x,T.y,we.x,we.y),T=c[N],m=c[N+1]}p.temp_fake.lineTo(T.x,T.y),p.temp_fake.stroke()},De=()=>{O.length<1||(O.length=0,p.mask.drawImage(E.temp_fake,0,0,g,o),le())},Ee=()=>{O.length<1||(U.push({points:O.slice(),brush_color:i,brush_radius:h}),a!=="mask"&&(O.length=0),p.drawing.drawImage(E.temp,0,0,g,o),le())},le=()=>{const c=je();l("change",c)};function he(){return n(27,U=[]),pe(),n(4,ie=0),!0}function pe(){ne=!0,p.temp.clearRect(0,0,g,o),n(26,p.temp.fillStyle=a==="mask"?"transparent":"#FFFFFF",p),p.temp.fillRect(0,0,g,o),a==="mask"&&(p.temp_fake.clearRect(0,0,E.temp_fake.width,E.temp_fake.height),p.mask.clearRect(0,0,g,o),n(26,p.mask.fillStyle="#000",p),p.mask.fillRect(0,0,g,o))}let ke=({once:c=!1}={})=>{if(ue||ne){const y=D.getPointerCoordinates(),v=D.getBrushCoordinates();He(p.interface,y,v),ue=!1,ne=!1}c||window.requestAnimationFrame(()=>{ke()})},He=(c,y,v)=>{c.clearRect(0,0,g,o),c.beginPath(),c.fillStyle=i,c.arc(v.x,v.y,h/2,0,Math.PI*2,!0),c.fill(),c.beginPath(),c.fillStyle=sn,c.arc(v.x,v.y,r,0,Math.PI*2,!0),c.fill()};function je(){return a==="mask"?E.mask.toDataURL("image/jpg"):E.drawing.toDataURL("image/jpg")}function Ye(c){ce.call(this,t,c)}function Je(c,y){j[c?"unshift":"push"](()=>{E[y]=c,n(0,E)})}function Pe(c){j[c?"unshift":"push"](()=>{w=c,n(3,w)})}function Ve(){M=this.offsetWidth,L=this.offsetHeight,n(1,M),n(2,L)}return t.$$set=c=>{"value"in c&&n(13,u=c.value),"value_img"in c&&n(14,s=c.value_img),"mode"in c&&n(15,a=c.mode),"brush_color"in c&&n(16,i=c.brush_color),"brush_radius"in c&&n(10,h=c.brush_radius),"source"in c&&n(17,f=c.source),"width"in c&&n(11,g=c.width),"height"in c&&n(12,o=c.height),"container_height"in c&&n(18,_=c.container_height),"shape"in c&&n(19,b=c.shape)},t.$$.update=()=>{t.$$.dirty[0]&530432&&b&&(g||o)&&(n(11,g=b[0]),n(12,o=b[1])),t.$$.dirty[0]&16785408&&I&&!u&&he(),t.$$.dirty[0]&251811841&&I&&s!==te&&(n(25,te=s),he(),setTimeout(()=>{f==="webcam"?(p.temp.save(),p.temp.translate(g,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):Q(),p.drawing.drawImage(E.temp,0,0,g,o),ge({lines:U.slice()}),le()},50)),t.$$.dirty[0]&268436480&&D&&(Ae(),D.setRadius(h*.05)),t.$$.dirty[0]&6144&&(g||o)&&Me(),t.$$.dirty[0]&1024&&(r=h*.075)},[E,M,L,w,ie,ve,oe,We,Ie,Oe,h,g,o,u,s,a,i,f,_,b,Ne,Fe,he,je,I,te,p,U,D,Ye,Je,Pe,Ve]}class Ge extends x{constructor(e){super(),ee(this,e,ln,rn,Z,{value:13,value_img:14,mode:15,brush_color:16,brush_radius:10,source:17,width:11,height:12,container_height:18,shape:19,undo:20,redraw:21,clear:22,get_image_data:23},null,[-1,-1,-1])}get undo(){return this.$$.ctx[20]}get redraw(){return this.$$.ctx[21]}get clear(){return this.$$.ctx[22]}get get_image_data(){return this.$$.ctx[23]}}function un(t){let e,n,r,l,u,s,a;return n=new be({props:{Icon:Wt,label:"Undo"}}),n.$on("click",t[1]),l=new be({props:{Icon:Yt,label:"Redraw"}}),l.$on("click",t[2]),s=new be({props:{Icon:Ht,label:"Clear"}}),s.$on("click",t[3]),{c(){e=F("div"),B(n.$$.fragment),r=q(),B(l.$$.fragment),u=q(),B(s.$$.fragment),d(e,"class","svelte-s6ybro")},m(i,h){C(i,e,h),R(n,e,null),H(e,r),R(l,e,null),H(e,u),R(s,e,null),a=!0},p:Y,i(i){a||(k(n.$$.fragment,i),k(l.$$.fragment,i),k(s.$$.fragment,i),a=!0)},o(i){A(n.$$.fragment,i),A(l.$$.fragment,i),A(s.$$.fragment,i),a=!1},d(i){i&&z(e),S(n),S(l),S(s)}}}function an(t){const e=me();return[e,()=>e("undo"),()=>e("redraw"),u=>{e("clear"),u.stopPropagation()}]}class Ze extends x{constructor(e){super(),ee(this,e,an,un,Z,{})}}function ut(t){let e,n,r,l,u;return{c(){e=F("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[6])),d(e,"max",r=75*(t[2]/t[6])),d(e,"class","svelte-p4aq0j")},m(s,a){C(s,e,a),Le(e,t[0]),l||(u=[P(e,"change",t[10]),P(e,"input",t[10])],l=!0)},p(s,a){a&68&&n!==(n=.5*(s[2]/s[6]))&&d(e,"min",n),a&68&&r!==(r=75*(s[2]/s[6]))&&d(e,"max",r),a&1&&Le(e,s[0])},d(s){s&&z(e),l=!1,pt(u)}}}function at(t){let e,n,r,l;n=new be({props:{Icon:Kt,label:"Select brush color"}}),n.$on("click",t[11]);let u=t[5]&&ot(t);return{c(){e=F("span"),B(n.$$.fragment),r=q(),u&&u.c(),d(e,"class","col svelte-p4aq0j")},m(s,a){C(s,e,a),R(n,e,null),H(e,r),u&&u.m(e,null),l=!0},p(s,a){s[5]?u?u.p(s,a):(u=ot(s),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(s){l||(k(n.$$.fragment,s),l=!0)},o(s){A(n.$$.fragment,s),l=!1},d(s){s&&z(e),S(n),u&&u.d()}}}function ot(t){let e,n,r;return{c(){e=F("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-p4aq0j")},m(l,u){C(l,e,u),Le(e,t[1]),n||(r=P(e,"input",t[12]),n=!0)},p(l,u){u&2&&Le(e,l[1])},d(l){l&&z(e),n=!1,r()}}}function on(t){let e,n,r,l,u,s;r=new be({props:{Icon:Gt,label:"Use brush"}}),r.$on("click",t[9]);let a=t[4]&&ut(t),i=t[3]!=="mask"&&at(t);return{c(){e=F("div"),n=F("span"),B(r.$$.fragment),l=q(),a&&a.c(),u=q(),i&&i.c(),d(n,"class","brush svelte-p4aq0j"),d(e,"class","wrap svelte-p4aq0j")},m(h,f){C(h,e,f),H(e,n),R(r,n,null),H(n,l),a&&a.m(n,null),H(e,u),i&&i.m(e,null),s=!0},p(h,[f]){h[4]?a?a.p(h,f):(a=ut(h),a.c(),a.m(n,null)):a&&(a.d(1),a=null),h[3]!=="mask"?i?(i.p(h,f),f&8&&k(i,1)):(i=at(h),i.c(),k(i,1),i.m(e,null)):i&&(K(),A(i,1,1,()=>{i=null}),$())},i(h){s||(k(r.$$.fragment,h),k(i),s=!0)},o(h){A(r.$$.fragment,h),A(i),s=!1},d(h){h&&z(e),S(r),a&&a.d(),i&&i.d()}}}function fn(t,e,n){let r;me();let l=!1,u=!1,{brush_radius:s=20}=e,{brush_color:a="#000"}=e,{container_height:i}=e,{img_width:h}=e,{img_height:f}=e,{mode:g="other"}=e;const o=()=>n(4,l=!l);function _(){s=Tt(this.value),n(0,s)}const b=()=>n(5,u=!u);function I(){a=this.value,n(1,a)}return t.$$set=M=>{"brush_radius"in M&&n(0,s=M.brush_radius),"brush_color"in M&&n(1,a=M.brush_color),"container_height"in M&&n(7,i=M.container_height),"img_width"in M&&n(2,h=M.img_width),"img_height"in M&&n(8,f=M.img_height),"mode"in M&&n(3,g=M.mode)},t.$$.update=()=>{t.$$.dirty&388&&n(6,r=i*(h/f))},[s,a,h,g,l,u,r,i,f,o,_,b,I]}class Ke extends x{constructor(e){super(),ee(this,e,fn,on,Z,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function _n(t){let e,n;return{c(){e=F("img"),J(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-rlgzoo"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(r,l){C(r,e,l)},p(r,l){l[0]&1&&!J(e.src,n=r[0].image||r[0])&&d(e,"src",n),l[0]&544&&W(e,"webcam",r[5]==="webcam"&&r[9])},i:Y,o:Y,d(r){r&&z(e)}}}function hn(t){let e=t[20],n,r,l,u=ft(t),s=t[15]>0&&_t(t);return{c(){u.c(),n=q(),s&&s.c(),r=ae()},m(a,i){u.m(a,i),C(a,n,i),s&&s.m(a,i),C(a,r,i),l=!0},p(a,i){i[0]&1048576&&Z(e,e=a[20])?(u.d(1),u=ft(a),u.c(),u.m(n.parentNode,n)):u.p(a,i),a[15]>0?s?(s.p(a,i),i[0]&32768&&k(s,1)):(s=_t(a),s.c(),k(s,1),s.m(r.parentNode,r)):s&&(K(),A(s,1,1,()=>{s=null}),$())},i(a){l||(k(s),l=!0)},o(a){A(s),l=!1},d(a){u.d(a),a&&z(n),s&&s.d(a),a&&z(r)}}}function cn(t){let e,n,r,l,u;return e=new qe({props:{editable:!0}}),e.$on("edit",t[51]),e.$on("clear",t[23]),{c(){B(e.$$.fragment),n=q(),r=F("img"),J(r.src,l=t[0])||d(r,"src",l),d(r,"alt",""),d(r,"class","svelte-rlgzoo"),W(r,"webcam",t[5]==="webcam"&&t[9])},m(s,a){R(e,s,a),C(s,n,a),C(s,r,a),u=!0},p(s,a){(!u||a[0]&1&&!J(r.src,l=s[0]))&&d(r,"src",l),a[0]&544&&W(r,"webcam",s[5]==="webcam"&&s[9])},i(s){u||(k(e.$$.fragment,s),u=!0)},o(s){A(e.$$.fragment,s),u=!1},d(s){S(e,s),s&&z(n),s&&z(r)}}}function mn(t){let e,n,r,l,u={image:t[0]};return e=new It({props:u}),t[49](e),e.$on("crop",t[24]),r=new qe({}),r.$on("clear",t[50]),{c(){B(e.$$.fragment),n=q(),B(r.$$.fragment)},m(s,a){R(e,s,a),C(s,n,a),R(r,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(k(e.$$.fragment,s),k(r.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),A(r.$$.fragment,s),l=!1},d(s){t[49](null),S(e,s),s&&z(n),S(r,s)}}}function gn(t){let e,n,r=t[5]==="webcam"&&!t[20]&&ct(t);return{c(){r&&r.c(),e=ae()},m(l,u){r&&r.m(l,u),C(l,e,u),n=!0},p(l,u){l[5]==="webcam"&&!l[20]?r?(r.p(l,u),u[0]&1048608&&k(r,1)):(r=ct(l),r.c(),k(r,1),r.m(e.parentNode,e)):r&&(K(),A(r,1,1,()=>{r=null}),$())},i(l){n||(k(r),n=!0)},o(l){A(r),n=!1},d(l){r&&r.d(l),l&&z(e)}}}function dn(t){let e,n,r,l,u,s,a;e=new Ze({}),e.$on("undo",t[40]),e.$on("redraw",t[41]),e.$on("clear",t[26]);let i=t[1]==="color-sketch"&&mt(t);function h(o){t[44](o)}function f(o){t[45](o)}let g={value:t[0],mode:t[12],width:t[15]||t[19],height:t[14]||t[18],container_height:t[16]||t[18],shape:t[6]};return t[2]!==void 0&&(g.brush_radius=t[2]),t[21]!==void 0&&(g.brush_color=t[21]),l=new Ge({props:g}),j.push(()=>X(l,"brush_radius",h)),j.push(()=>X(l,"brush_color",f)),t[46](l),l.$on("change",t[24]),l.$on("clear",t[26]),{c(){B(e.$$.fragment),n=q(),i&&i.c(),r=q(),B(l.$$.fragment)},m(o,_){R(e,o,_),C(o,n,_),i&&i.m(o,_),C(o,r,_),R(l,o,_),a=!0},p(o,_){o[1]==="color-sketch"?i?(i.p(o,_),_[0]&2&&k(i,1)):(i=mt(o),i.c(),k(i,1),i.m(r.parentNode,r)):i&&(K(),A(i,1,1,()=>{i=null}),$());const b={};_[0]&1&&(b.value=o[0]),_[0]&4096&&(b.mode=o[12]),_[0]&557056&&(b.width=o[15]||o[19]),_[0]&278528&&(b.height=o[14]||o[18]),_[0]&327680&&(b.container_height=o[16]||o[18]),_[0]&64&&(b.shape=o[6]),!u&&_[0]&4&&(u=!0,b.brush_radius=o[2],V(()=>u=!1)),!s&&_[0]&2097152&&(s=!0,b.brush_color=o[21],V(()=>s=!1)),l.$set(b)},i(o){a||(k(e.$$.fragment,o),k(i),k(l.$$.fragment,o),a=!0)},o(o){A(e.$$.fragment,o),A(i),A(l.$$.fragment,o),a=!1},d(o){S(e,o),o&&z(n),i&&i.d(o),o&&z(r),t[46](null),S(l,o)}}}function bn(t){let e,n,r;function l(s){t[39](s)}let u={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[yn]},$$scope:{ctx:t}};return t[11]!==void 0&&(u.dragging=t[11]),e=new Jt({props:u}),j.push(()=>X(e,"dragging",l)),e.$on("load",t[22]),{c(){B(e.$$.fragment)},m(s,a){R(e,s,a),r=!0},p(s,a){const i={};a[0]&1&&(i.disable_click=!!s[0]),a[0]&4191975|a[1]&1073741824&&(i.$$scope={dirty:a,ctx:s}),!n&&a[0]&2048&&(n=!0,i.dragging=s[11],V(()=>n=!1)),e.$set(i)},i(s){r||(k(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){S(e,s)}}}function ft(t){let e,n,r,l;return{c(){e=F("img"),d(e,"class","absolute-img svelte-rlgzoo"),J(e.src,n=t[20]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),W(e,"webcam",t[5]==="webcam"&&t[9])},m(u,s){C(u,e,s),t[52](e),r||(l=P(e,"load",t[25]),r=!0)},p(u,s){s[0]&1048577&&!J(e.src,n=u[20]||u[0]?.image||u[0])&&d(e,"src",n),s[0]&544&&W(e,"webcam",u[5]==="webcam"&&u[9])},d(u){u&&z(e),t[52](null),r=!1,l()}}}function _t(t){let e,n,r,l,u,s,a,i;function h(_){t[54](_)}function f(_){t[55](_)}let g={value:t[0],mode:t[12],width:t[15]||t[19],height:t[14]||t[18],container_height:t[16]||t[18],value_img:t[17],source:t[5]};t[2]!==void 0&&(g.brush_radius=t[2]),t[21]!==void 0&&(g.brush_color=t[21]),e=new Ge({props:g}),t[53](e),j.push(()=>X(e,"brush_radius",h)),j.push(()=>X(e,"brush_color",f)),e.$on("change",t[24]),u=new Ze({}),u.$on("undo",t[56]),u.$on("redraw",t[57]),u.$on("clear",t[26]);let o=(t[1]==="color-sketch"||t[1]==="sketch")&&ht(t);return{c(){B(e.$$.fragment),l=q(),B(u.$$.fragment),s=q(),o&&o.c(),a=ae()},m(_,b){R(e,_,b),C(_,l,b),R(u,_,b),C(_,s,b),o&&o.m(_,b),C(_,a,b),i=!0},p(_,b){const I={};b[0]&1&&(I.value=_[0]),b[0]&4096&&(I.mode=_[12]),b[0]&557056&&(I.width=_[15]||_[19]),b[0]&278528&&(I.height=_[14]||_[18]),b[0]&327680&&(I.container_height=_[16]||_[18]),b[0]&131072&&(I.value_img=_[17]),b[0]&32&&(I.source=_[5]),!n&&b[0]&4&&(n=!0,I.brush_radius=_[2],V(()=>n=!1)),!r&&b[0]&2097152&&(r=!0,I.brush_color=_[21],V(()=>r=!1)),e.$set(I),_[1]==="color-sketch"||_[1]==="sketch"?o?(o.p(_,b),b[0]&2&&k(o,1)):(o=ht(_),o.c(),k(o,1),o.m(a.parentNode,a)):o&&(K(),A(o,1,1,()=>{o=null}),$())},i(_){i||(k(e.$$.fragment,_),k(u.$$.fragment,_),k(o),i=!0)},o(_){A(e.$$.fragment,_),A(u.$$.fragment,_),A(o),i=!1},d(_){t[53](null),S(e,_),_&&z(l),S(u,_),_&&z(s),o&&o.d(_),_&&z(a)}}}function ht(t){let e,n,r,l;function u(i){t[58](i)}function s(i){t[59](i)}let a={container_height:t[16]||t[18],img_width:t[15]||t[19],img_height:t[14]||t[18],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[21]!==void 0&&(a.brush_color=t[21]),e=new Ke({props:a}),j.push(()=>X(e,"brush_radius",u)),j.push(()=>X(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(i,h){R(e,i,h),l=!0},p(i,h){const f={};h[0]&327680&&(f.container_height=i[16]||i[18]),h[0]&557056&&(f.img_width=i[15]||i[19]),h[0]&278528&&(f.img_height=i[14]||i[18]),h[0]&4096&&(f.mode=i[12]),!n&&h[0]&4&&(n=!0,f.brush_radius=i[2],V(()=>n=!1)),!r&&h[0]&2097152&&(r=!0,f.brush_color=i[21],V(()=>r=!1)),e.$set(f)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){S(e,i)}}}function ct(t){let e,n;return e=new Ot({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[47]),e.$on("stream",t[24]),e.$on("error",t[48]),{c(){B(e.$$.fragment)},m(r,l){R(e,r,l),n=!0},p(r,l){const u={};l[0]&128&&(u.streaming=r[7]),l[0]&256&&(u.pending=r[8]),l[0]&512&&(u.mirror_webcam=r[9]),e.$set(u)},i(r){n||(k(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){S(e,r)}}}function mt(t){let e,n,r,l;function u(i){t[42](i)}function s(i){t[43](i)}let a={container_height:t[16]||t[18],img_width:t[15]||t[19],img_height:t[14]||t[18]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[21]!==void 0&&(a.brush_color=t[21]),e=new Ke({props:a}),j.push(()=>X(e,"brush_radius",u)),j.push(()=>X(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(i,h){R(e,i,h),l=!0},p(i,h){const f={};h[0]&327680&&(f.container_height=i[16]||i[18]),h[0]&557056&&(f.img_width=i[15]||i[19]),h[0]&278528&&(f.img_height=i[14]||i[18]),!n&&h[0]&4&&(n=!0,f.brush_radius=i[2],V(()=>n=!1)),!r&&h[0]&2097152&&(r=!0,f.brush_color=i[21],V(()=>r=!1)),e.$set(f)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){S(e,i)}}}function pn(t){let e,n;return{c(){e=F("img"),J(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt","hello"),d(e,"class","svelte-rlgzoo"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(r,l){C(r,e,l)},p(r,l){l[0]&1&&!J(e.src,n=r[0].image||r[0])&&d(e,"src",n),l[0]&544&&W(e,"webcam",r[5]==="webcam"&&r[9])},i:Y,o:Y,d(r){r&&z(e)}}}function kn(t){let e=t[20],n,r,l,u=gt(t),s=t[15]>0&&dt(t);return{c(){u.c(),n=q(),s&&s.c(),r=ae()},m(a,i){u.m(a,i),C(a,n,i),s&&s.m(a,i),C(a,r,i),l=!0},p(a,i){i[0]&1048576&&Z(e,e=a[20])?(u.d(1),u=gt(a),u.c(),u.m(n.parentNode,n)):u.p(a,i),a[15]>0?s?(s.p(a,i),i[0]&32768&&k(s,1)):(s=dt(a),s.c(),k(s,1),s.m(r.parentNode,r)):s&&(K(),A(s,1,1,()=>{s=null}),$())},i(a){l||(k(s),l=!0)},o(a){A(s),l=!1},d(a){u.d(a),a&&z(n),s&&s.d(a),a&&z(r)}}}function wn(t){let e,n,r,l,u;return e=new qe({props:{editable:!0}}),e.$on("edit",t[30]),e.$on("clear",t[23]),{c(){B(e.$$.fragment),n=q(),r=F("img"),J(r.src,l=t[0])||d(r,"src",l),d(r,"alt",""),d(r,"class","svelte-rlgzoo"),W(r,"scale-x-[-1]",t[5]==="webcam"&&t[9])},m(s,a){R(e,s,a),C(s,n,a),C(s,r,a),u=!0},p(s,a){(!u||a[0]&1&&!J(r.src,l=s[0]))&&d(r,"src",l),a[0]&544&&W(r,"scale-x-[-1]",s[5]==="webcam"&&s[9])},i(s){u||(k(e.$$.fragment,s),u=!0)},o(s){A(e.$$.fragment,s),u=!1},d(s){S(e,s),s&&z(n),s&&z(r)}}}function An(t){let e,n,r,l,u={image:t[0]};return e=new It({props:u}),t[28](e),e.$on("crop",t[24]),r=new qe({}),r.$on("clear",t[29]),{c(){B(e.$$.fragment),n=q(),B(r.$$.fragment)},m(s,a){R(e,s,a),C(s,n,a),R(r,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(k(e.$$.fragment,s),k(r.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),A(r.$$.fragment,s),l=!1},d(s){t[28](null),S(e,s),s&&z(n),S(r,s)}}}function In(t){let e;const n=t[27].default,r=Bt(n,t,t[61],null);return{c(){r&&r.c()},m(l,u){r&&r.m(l,u),e=!0},p(l,u){r&&r.p&&(!e||u[1]&1073741824)&&Rt(r,n,l,l[61],e?Dt(n,l[61],u,null):St(l[61]),null)},i(l){e||(k(r,l),e=!0)},o(l){A(r,l),e=!1},d(l){r&&r.d(l)}}}function gt(t){let e,n,r,l;return{c(){e=F("img"),d(e,"class","absolute-img svelte-rlgzoo"),J(e.src,n=t[20]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),W(e,"webcam",t[5]==="webcam"&&t[9])},m(u,s){C(u,e,s),t[31](e),r||(l=P(e,"load",t[25]),r=!0)},p(u,s){s[0]&1048577&&!J(e.src,n=u[20]||u[0]?.image||u[0])&&d(e,"src",n),s[0]&544&&W(e,"webcam",u[5]==="webcam"&&u[9])},d(u){u&&z(e),t[31](null),r=!1,l()}}}function dt(t){let e,n,r,l,u,s,a,i;function h(_){t[33](_)}function f(_){t[34](_)}let g={value:t[0],mode:t[12],width:t[15]||t[19],height:t[14]||t[18],container_height:t[16]||t[18],value_img:t[17],source:t[5],shape:t[6]};t[2]!==void 0&&(g.brush_radius=t[2]),t[21]!==void 0&&(g.brush_color=t[21]),e=new Ge({props:g}),t[32](e),j.push(()=>X(e,"brush_radius",h)),j.push(()=>X(e,"brush_color",f)),e.$on("change",t[24]),u=new Ze({}),u.$on("undo",t[35]),u.$on("redraw",t[36]),u.$on("clear",t[26]);let o=(t[1]==="color-sketch"||t[1]==="sketch")&&bt(t);return{c(){B(e.$$.fragment),l=q(),B(u.$$.fragment),s=q(),o&&o.c(),a=ae()},m(_,b){R(e,_,b),C(_,l,b),R(u,_,b),C(_,s,b),o&&o.m(_,b),C(_,a,b),i=!0},p(_,b){const I={};b[0]&1&&(I.value=_[0]),b[0]&4096&&(I.mode=_[12]),b[0]&557056&&(I.width=_[15]||_[19]),b[0]&278528&&(I.height=_[14]||_[18]),b[0]&327680&&(I.container_height=_[16]||_[18]),b[0]&131072&&(I.value_img=_[17]),b[0]&32&&(I.source=_[5]),b[0]&64&&(I.shape=_[6]),!n&&b[0]&4&&(n=!0,I.brush_radius=_[2],V(()=>n=!1)),!r&&b[0]&2097152&&(r=!0,I.brush_color=_[21],V(()=>r=!1)),e.$set(I),_[1]==="color-sketch"||_[1]==="sketch"?o?(o.p(_,b),b[0]&2&&k(o,1)):(o=bt(_),o.c(),k(o,1),o.m(a.parentNode,a)):o&&(K(),A(o,1,1,()=>{o=null}),$())},i(_){i||(k(e.$$.fragment,_),k(u.$$.fragment,_),k(o),i=!0)},o(_){A(e.$$.fragment,_),A(u.$$.fragment,_),A(o),i=!1},d(_){t[32](null),S(e,_),_&&z(l),S(u,_),_&&z(s),o&&o.d(_),_&&z(a)}}}function bt(t){let e,n,r,l;function u(i){t[37](i)}function s(i){t[38](i)}let a={container_height:t[16]||t[18],img_width:t[15]||t[19],img_height:t[14]||t[18],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[21]!==void 0&&(a.brush_color=t[21]),e=new Ke({props:a}),j.push(()=>X(e,"brush_radius",u)),j.push(()=>X(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(i,h){R(e,i,h),l=!0},p(i,h){const f={};h[0]&327680&&(f.container_height=i[16]||i[18]),h[0]&557056&&(f.img_width=i[15]||i[19]),h[0]&278528&&(f.img_height=i[14]||i[18]),h[0]&4096&&(f.mode=i[12]),!n&&h[0]&4&&(n=!0,f.brush_radius=i[2],V(()=>n=!1)),!r&&h[0]&2097152&&(r=!0,f.brush_color=i[21],V(()=>r=!1)),e.$set(f)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){S(e,i)}}}function yn(t){let e,n,r,l;const u=[In,An,wn,kn,pn],s=[];function a(i,h){return i[0]===null&&!i[20]||i[7]?0:i[1]==="select"?1:i[1]==="editor"?2:(i[1]==="sketch"||i[1]==="color-sketch")&&(i[0]!==null||i[20])?3:4}return e=a(t),n=s[e]=u[e](t),{c(){n.c(),r=ae()},m(i,h){s[e].m(i,h),C(i,r,h),l=!0},p(i,h){let f=e;e=a(i),e===f?s[e].p(i,h):(K(),A(s[f],1,1,()=>{s[f]=null}),$(),n=s[e],n?n.p(i,h):(n=s[e]=u[e](i),n.c()),k(n,1),n.m(r.parentNode,r))},i(i){l||(k(n),l=!0)},o(i){A(n),l=!1},d(i){s[e].d(i),i&&z(r)}}}function Cn(t){let e,n,r,l,u,s,a;e=new At({props:{show_label:t[4],Icon:t[5]==="canvas"?et:Ue,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const i=[bn,dn,gn,mn,cn,hn,_n],h=[];function f(g,o){return g[5]==="upload"?0:g[5]==="canvas"?1:g[0]===null&&!g[20]||g[7]?2:g[1]==="select"?3:g[1]==="editor"?4:(g[1]==="sketch"||g[1]==="color-sketch")&&(g[0]!==null||g[20])?5:6}return l=f(t),u=h[l]=i[l](t),{c(){B(e.$$.fragment),n=q(),r=F("div"),u.c(),d(r,"data-testid","image"),d(r,"class","svelte-rlgzoo"),Qe(()=>t[60].call(r)),W(r,"fixed-height",t[5]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(g,o){R(e,g,o),C(g,n,o),C(g,r,o),h[l].m(r,null),s=kt(r,t[60].bind(r)),a=!0},p(g,o){const _={};o[0]&16&&(_.show_label=g[4]),o[0]&32&&(_.Icon=g[5]==="canvas"?et:Ue),o[0]&40&&(_.label=g[3]||(g[5]==="canvas"?"Sketch":"Image")),e.$set(_);let b=l;l=f(g),l===b?h[l].p(g,o):(K(),A(h[b],1,1,()=>{h[b]=null}),$(),u=h[l],u?u.p(g,o):(u=h[l]=i[l](g),u.c()),k(u,1),u.m(r,null)),o[0]&34&&W(r,"fixed-height",g[5]!=="webcam"||g[1]==="sketch"||g[1]==="color-sketch")},i(g){a||(k(e.$$.fragment,g),k(u),a=!0)},o(g){A(e.$$.fragment,g),A(u),a=!1},d(g){S(e,g),g&&z(n),g&&z(r),h[l].d(),s()}}}function zn(t,e,n){let r,{$$slots:l={},$$scope:u}=e,{value:s}=e,{label:a=void 0}=e,{show_label:i}=e,{source:h="upload"}=e,{tool:f="editor"}=e,{shape:g}=e,{streaming:o=!1}=e,{pending:_=!1}=e,{mirror_webcam:b}=e,{brush_radius:I}=e,M,L;s&&(h==="upload"||h==="webcam")&&f==="sketch"&&(s={image:s,mask:null});function te({detail:m}){f==="color-sketch"?n(20,Q=m):n(0,s=(h==="upload"||h==="webcam")&&f==="sketch"?{image:m,mask:null}:m),p("upload",m)}function oe({detail:m}){n(0,s=null),n(20,Q=void 0),p("clear")}async function E({detail:m},N){D==="mask"?h==="webcam"&&N?n(0,s={image:m,mask:null}):n(0,s={image:typeof s=="string"?s:s?.image||null,mask:m}):(h==="upload"||h==="webcam")&&f==="sketch"?n(0,s={image:m,mask:null}):n(0,s=m),await de(),p(o?"stream":"edit")}const p=me();let O=!1;function U(m){const N=m.currentTarget;n(15,re=N.naturalWidth),n(14,ne=N.naturalHeight),n(16,se=N.getBoundingClientRect().height)}async function ue(){M.clear(),await de(),n(0,s=null),n(20,Q=void 0)}let ne=0,re=0,se=0,D,w,fe,ie,Q;wt(async()=>{f==="color-sketch"&&s&&typeof s=="string"&&(n(20,Q=s),await de(),U({currentTarget:w}))});function Ae(m){j[m?"unshift":"push"](()=>{L=m,n(10,L),n(0,s)})}const Ne=m=>(oe(m),n(1,f="editor")),Fe=()=>n(1,f="select");function ge(m){j[m?"unshift":"push"](()=>{w=m,n(17,w)})}function We(m){j[m?"unshift":"push"](()=>{M=m,n(13,M)})}function Ie(m){I=m,n(2,I)}function Oe(m){r=m,n(21,r),n(12,D),n(5,h),n(1,f)}const ye=()=>M.undo(),Ce=()=>M.redraw();function ze(m){I=m,n(2,I)}function ve(m){r=m,n(21,r),n(12,D),n(5,h),n(1,f)}function Me(m){O=m,n(11,O)}const _e=()=>M.undo(),Te=()=>M.redraw();function Be(m){I=m,n(2,I)}function Re(m){r=m,n(21,r),n(12,D),n(5,h),n(1,f)}function Se(m){I=m,n(2,I)}function De(m){r=m,n(21,r),n(12,D),n(5,h),n(1,f)}function Ee(m){j[m?"unshift":"push"](()=>{M=m,n(13,M)})}const le=m=>f==="color-sketch"?te(m):E(m,!0);function he(m){ce.call(this,t,m)}function pe(m){j[m?"unshift":"push"](()=>{L=m,n(10,L),n(0,s)})}const ke=m=>(oe(m),n(1,f="editor")),He=()=>n(1,f="select");function je(m){j[m?"unshift":"push"](()=>{w=m,n(17,w)})}function Ye(m){j[m?"unshift":"push"](()=>{M=m,n(13,M)})}function Je(m){I=m,n(2,I)}function Pe(m){r=m,n(21,r),n(12,D),n(5,h),n(1,f)}const Ve=()=>M.undo(),c=()=>M.redraw();function y(m){I=m,n(2,I)}function v(m){r=m,n(21,r),n(12,D),n(5,h),n(1,f)}function T(){fe=this.offsetHeight,ie=this.offsetWidth,n(18,fe),n(19,ie)}return t.$$set=m=>{"value"in m&&n(0,s=m.value),"label"in m&&n(3,a=m.label),"show_label"in m&&n(4,i=m.show_label),"source"in m&&n(5,h=m.source),"tool"in m&&n(1,f=m.tool),"shape"in m&&n(6,g=m.shape),"streaming"in m&&n(7,o=m.streaming),"pending"in m&&n(8,_=m.pending),"mirror_webcam"in m&&n(9,b=m.mirror_webcam),"brush_radius"in m&&n(2,I=m.brush_radius),"$$scope"in m&&n(61,u=m.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&p("change",s),t.$$.dirty[0]&2048&&p("drag",O),t.$$.dirty[0]&34&&(h==="canvas"&&f==="sketch"?n(12,D="bw-sketch"):f==="color-sketch"?n(12,D="color-sketch"):(h==="upload"||h==="webcam")&&f==="sketch"?n(12,D="mask"):n(12,D="editor")),t.$$.dirty[0]&4096&&n(21,r=D=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&n(20,Q=void 0),t.$$.dirty[0]&1025&&L&&(s?(n(10,L.image=s,L),L.create()):L.destroy())},[s,f,I,a,i,h,g,o,_,b,L,O,D,M,ne,re,se,w,fe,ie,Q,r,te,oe,E,U,ue,l,Ae,Ne,Fe,ge,We,Ie,Oe,ye,Ce,ze,ve,Me,_e,Te,Be,Re,Se,De,Ee,le,he,pe,ke,He,je,Ye,Je,Pe,Ve,c,y,v,T,u]}class vn extends x{constructor(e){super(),ee(this,e,zn,Cn,Z,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2},null,[-1,-1,-1])}}function Mn(t){let e,n,r,l,u,s,a;return r=new be({props:{Icon:Vt,label:"Download"}}),{c(){e=F("div"),n=F("a"),B(r.$$.fragment),l=q(),u=F("img"),d(n,"href",t[0]),d(n,"target",window.__is_colab__?"_blank":null),d(n,"download","image"),d(e,"class","download svelte-kt1jzh"),J(u.src,s=t[0])||d(u,"src",s),d(u,"alt",""),d(u,"class","svelte-kt1jzh")},m(i,h){C(i,e,h),H(e,n),R(r,n,null),C(i,l,h),C(i,u,h),a=!0},p(i,h){(!a||h&1)&&d(n,"href",i[0]),(!a||h&1&&!J(u.src,s=i[0]))&&d(u,"src",s)},i(i){a||(k(r.$$.fragment,i),a=!0)},o(i){A(r.$$.fragment,i),a=!1},d(i){i&&z(e),S(r),i&&z(l),i&&z(u)}}}function Tn(t){let e,n;return e=new Pt({props:{size:"large",unpadded_box:!0,$$slots:{default:[Bn]},$$scope:{ctx:t}}}),{c(){B(e.$$.fragment)},m(r,l){R(e,r,l),n=!0},p(r,l){const u={};l&16&&(u.$$scope={dirty:l,ctx:r}),e.$set(u)},i(r){n||(k(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){S(e,r)}}}function Bn(t){let e,n;return e=new Ue({}),{c(){B(e.$$.fragment)},m(r,l){R(e,r,l),n=!0},i(r){n||(k(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){S(e,r)}}}function Rn(t){let e,n,r,l,u,s;e=new At({props:{show_label:t[2],Icon:Ue,label:t[1]||"Image"}});const a=[Tn,Mn],i=[];function h(f,g){return f[0]===null?0:1}return r=h(t),l=i[r]=a[r](t),{c(){B(e.$$.fragment),n=q(),l.c(),u=ae()},m(f,g){R(e,f,g),C(f,n,g),i[r].m(f,g),C(f,u,g),s=!0},p(f,[g]){const o={};g&4&&(o.show_label=f[2]),g&2&&(o.label=f[1]||"Image"),e.$set(o);let _=r;r=h(f),r===_?i[r].p(f,g):(K(),A(i[_],1,1,()=>{i[_]=null}),$(),l=i[r],l?l.p(f,g):(l=i[r]=a[r](f),l.c()),k(l,1),l.m(u.parentNode,u))},i(f){s||(k(e.$$.fragment,f),k(l),s=!0)},o(f){A(e.$$.fragment,f),A(l),s=!1},d(f){S(e,f),f&&z(n),i[r].d(f),f&&z(u)}}}function Sn(t,e,n){let{value:r}=e,{label:l=void 0}=e,{show_label:u}=e;const s=me();return t.$$set=a=>{"value"in a&&n(0,r=a.value),"label"in a&&n(1,l=a.label),"show_label"in a&&n(2,u=a.show_label)},t.$$.update=()=>{t.$$.dirty&1&&r&&s("change",r)},[r,l,u]}class Dn extends x{constructor(e){super(),ee(this,e,Sn,Rn,Z,{value:0,label:1,show_label:2})}}function En(t){let e,n,r;function l(s){t[17](s)}let u={brush_radius:t[14],shape:t[13],source:t[5],tool:t[6],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[12],$$slots:{default:[Ln]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.value=t[0]),e=new vn({props:u}),j.push(()=>X(e,"value",l)),e.$on("edit",t[18]),e.$on("clear",t[19]),e.$on("change",t[20]),e.$on("stream",t[21]),e.$on("drag",t[22]),e.$on("upload",t[23]),e.$on("error",t[24]),{c(){B(e.$$.fragment)},m(s,a){R(e,s,a),r=!0},p(s,a){const i={};a&16384&&(i.brush_radius=s[14]),a&8192&&(i.shape=s[13]),a&32&&(i.source=s[5]),a&64&&(i.tool=s[6]),a&128&&(i.label=s[7]),a&256&&(i.show_label=s[8]),a&1024&&(i.pending=s[10]),a&512&&(i.streaming=s[9]),a&4096&&(i.mirror_webcam=s[12]),a&67108864&&(i.$$scope={dirty:a,ctx:s}),!n&&a&1&&(n=!0,i.value=s[0],V(()=>n=!1)),e.$set(i)},i(s){r||(k(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){S(e,s)}}}function jn(t){let e,n;return e=new Dn({props:{value:t[0],label:t[7],show_label:t[8]}}),{c(){B(e.$$.fragment)},m(r,l){R(e,r,l),n=!0},p(r,l){const u={};l&1&&(u.value=r[0]),l&128&&(u.label=r[7]),l&256&&(u.show_label=r[8]),e.$set(u)},i(r){n||(k(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){S(e,r)}}}function Ln(t){let e,n;return e=new Xt({props:{type:"image"}}),{c(){B(e.$$.fragment)},m(r,l){R(e,r,l),n=!0},p:Y,i(r){n||(k(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){S(e,r)}}}function Un(t){let e,n,r,l,u,s;const a=[t[1]];let i={};for(let o=0;o<a.length;o+=1)i=Et(i,a[o]);e=new jt({props:i});const h=[jn,En],f=[];function g(o,_){return o[15]==="static"?0:1}return r=g(t),l=f[r]=h[r](t),{c(){B(e.$$.fragment),n=q(),l.c(),u=ae()},m(o,_){R(e,o,_),C(o,n,_),f[r].m(o,_),C(o,u,_),s=!0},p(o,_){const b=_&2?Lt(a,[Ut(o[1])]):{};e.$set(b);let I=r;r=g(o),r===I?f[r].p(o,_):(K(),A(f[I],1,1,()=>{f[I]=null}),$(),l=f[r],l?l.p(o,_):(l=f[r]=h[r](o),l.c()),k(l,1),l.m(u.parentNode,u))},i(o){s||(k(e.$$.fragment,o),k(l),s=!0)},o(o){A(e.$$.fragment,o),A(l),s=!1},d(o){S(e,o),o&&z(n),f[r].d(o),o&&z(u)}}}function qn(t){let e,n;return e=new qt({props:{visible:t[4],variant:t[15]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[16]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],style:{height:t[11].height,width:t[11].width},allow_overflow:!1,$$slots:{default:[Un]},$$scope:{ctx:t}}}),{c(){B(e.$$.fragment)},m(r,l){R(e,r,l),n=!0},p(r,[l]){const u={};l&16&&(u.visible=r[4]),l&32801&&(u.variant=r[15]==="dynamic"&&r[0]===null&&r[5]==="upload"?"dashed":"solid"),l&65536&&(u.border_mode=r[16]?"focus":"base"),l&4&&(u.elem_id=r[2]),l&8&&(u.elem_classes=r[3]),l&2048&&(u.style={height:r[11].height,width:r[11].width}),l&67237859&&(u.$$scope={dirty:l,ctx:r}),e.$set(u)},i(r){n||(k(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){S(e,r)}}}function Nn(t,e,n){let{elem_id:r=""}=e,{elem_classes:l=[]}=e,{visible:u=!0}=e,{value:s=null}=e,{source:a="upload"}=e,{tool:i="editor"}=e,{label:h}=e,{show_label:f}=e,{streaming:g}=e,{pending:o}=e,{style:_={}}=e,{mirror_webcam:b}=e,{shape:I}=e,{brush_radius:M}=e,{loading_status:L}=e,{mode:te}=e;const oe=me();let E;function p(w){s=w,n(0,s)}function O(w){ce.call(this,t,w)}function U(w){ce.call(this,t,w)}function ue(w){ce.call(this,t,w)}function ne(w){ce.call(this,t,w)}const re=({detail:w})=>n(16,E=w);function se(w){ce.call(this,t,w)}const D=({detail:w})=>{n(1,L=L||{}),n(1,L.status="error",L),n(1,L.message=w,L)};return t.$$set=w=>{"elem_id"in w&&n(2,r=w.elem_id),"elem_classes"in w&&n(3,l=w.elem_classes),"visible"in w&&n(4,u=w.visible),"value"in w&&n(0,s=w.value),"source"in w&&n(5,a=w.source),"tool"in w&&n(6,i=w.tool),"label"in w&&n(7,h=w.label),"show_label"in w&&n(8,f=w.show_label),"streaming"in w&&n(9,g=w.streaming),"pending"in w&&n(10,o=w.pending),"style"in w&&n(11,_=w.style),"mirror_webcam"in w&&n(12,b=w.mirror_webcam),"shape"in w&&n(13,I=w.shape),"brush_radius"in w&&n(14,M=w.brush_radius),"loading_status"in w&&n(1,L=w.loading_status),"mode"in w&&n(15,te=w.mode)},t.$$.update=()=>{t.$$.dirty&1&&n(0,s=s||null),t.$$.dirty&1&&oe("change")},[s,L,r,l,u,a,i,h,f,g,o,_,b,I,M,te,E,p,O,U,ue,ne,re,se,D]}class Fn extends x{constructor(e){super(),ee(this,e,Nn,qn,Z,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,style:11,mirror_webcam:12,shape:13,brush_radius:14,loading_status:1,mode:15})}}var er=Fn;const tr=["static","dynamic"],nr=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{er as Component,ir as ExampleComponent,nr as document,tr as modes};
//# sourceMappingURL=index.d1705916.js.map
