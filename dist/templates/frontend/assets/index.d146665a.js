import{S as ee,i as te,s as Z,A as G,B as d,f as C,D as H,E as V,p as z,a6 as vt,F,K as J,q as de,b as j,a3 as Ke,ah as rt,a5 as st,C as Mt,O,I as Y,ad as Et,a2 as $e,G as U,ak as It,o as w,k as K,t as A,n as $,N as St,r as yt,V as ke,ac as Tt,x as ge,c as E,m as S,l as T,M as Ue,an as Bt,e as _e,j as X,a as Q,L as xe,W as Dt,X as Rt,Y as qt,Z as jt,v as Lt,a7 as Ut,g as Nt,h as Pt}from"./index.b33351d4.js";import{a as Ft}from"./Empty.svelte_svelte_type_style_lang.0208edb3.js";import{B as Ct}from"./BlockLabel.0b82fded.js";/* empty css                                                    */import{I as Ne}from"./Image.7f4386aa.js";import{C as Wt,i as Ot,U as Ht,W as Vt}from"./StaticImage.svelte_svelte_type_style_lang.fbaf8903.js";import{I as pe,C as Yt,M as Pe}from"./ModifyUpload.aab8b877.js";import{C as Jt}from"./Copy.cba0334e.js";import{U as Xt}from"./Upload.d06c5ccc.js";import{E as Qt}from"./Empty.941ac377.js";import{D as Gt}from"./Download.3147c9a9.js";import"./Blocks.fce7a3bd.js";import{U as Zt}from"./UploadText.0ad0a59b.js";import{E as ur}from"./Image.ab7712cf.js";import"./ModifyUpload.svelte_svelte_type_style_lang.e946db2d.js";function Kt(t){let e,n,r;return{c(){e=G("svg"),n=G("path"),r=G("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(r,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(r,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(l,o){C(l,e,o),H(e,n),H(e,r)},p:V,i:V,o:V,d(l){l&&z(e)}}}class $t extends ee{constructor(e){super(),te(this,e,null,Kt,Z,{})}}function xt(t){let e,n,r,l,o,s,a;return{c(){e=G("svg"),n=G("circle"),r=G("circle"),l=G("circle"),o=G("circle"),s=G("circle"),a=G("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(r,"cx","16"),d(r,"cy","9"),d(r,"r","2"),d(r,"fill","currentColor"),d(l,"cx","22"),d(l,"cy","12"),d(l,"r","2"),d(l,"fill","currentColor"),d(o,"cx","23"),d(o,"cy","18"),d(o,"r","2"),d(o,"fill","currentColor"),d(s,"cx","19"),d(s,"cy","23"),d(s,"r","2"),d(s,"fill","currentColor"),d(a,"fill","currentColor"),d(a,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(i,_){C(i,e,_),H(e,n),H(e,r),H(e,l),H(e,o),H(e,s),H(e,a)},p:V,i:V,o:V,d(i){i&&z(e)}}}class en extends ee{constructor(e){super(),te(this,e,null,xt,Z,{})}}function tn(t){let e,n;return{c(){e=G("svg"),n=G("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(r,l){C(r,e,l),H(e,n)},p:V,i:V,o:V,d(r){r&&z(e)}}}class lt extends ee{constructor(e){super(),te(this,e,null,tn,Z,{})}}function nn(t){let e,n;return{c(){e=F("img"),J(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(r,l){C(r,e,l),t[4](e)},p(r,[l]){l&1&&!J(e.src,n=r[0])&&d(e,"src",n)},i:V,o:V,d(r){r&&z(e),t[4](null)}}}function rn(t,e,n){let{image:r}=e,l;const o=de();let s;function a(){s.destroy()}function i(){s&&a(),s=new Wt(l,{autoCropArea:1,cropend(){const f=s.getCroppedCanvas().toDataURL();o("crop",f)}}),o("crop",r)}function _(f){j[f?"unshift":"push"](()=>{l=f,n(1,l)})}return t.$$set=f=>{"image"in f&&n(0,r=f.image)},[r,l,a,i,_]}class zt extends ee{constructor(e){super(),te(this,e,rn,nn,Z,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),vt()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class it{constructor(e,n){this.x=e,this.y=n}}class ot extends it{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const r=e+Math.PI/2;this.x=this.x+Math.sin(r)*n,this.y=this.y-Math.cos(r)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new it(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const sn=30;class ln{constructor({radius:e=sn,enabled:n=!0,initialPoint:r={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new ot(r.x,r.y),this.brush=new ot(r.x,r.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function at(t,e,n){const r=t.slice();return r[64]=e[n].name,r[65]=e[n].zIndex,r[66]=e,r[67]=n,r}function ut(t){let e,n,r;return{c(){e=F("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-1g1hqr7")},m(l,o){C(l,e,o),r=!0},i(l){r||(Ke(()=>{n||(n=rt(e,st,{duration:50},!0)),n.run(1)}),r=!0)},o(l){n||(n=rt(e,st,{duration:50},!1)),n.run(0),r=!1},d(l){l&&z(e),l&&n&&n.end()}}}function ft(t){let e,n,r=t[64],l,o;const s=()=>t[30](e,r),a=()=>t[30](null,r);return{c(){e=F("canvas"),d(e,"key",n=t[64]),Mt(e,"z-index",t[65]),d(e,"class","svelte-1g1hqr7"),O(e,"lr",t[5]),O(e,"tb",!t[5])},m(i,_){C(i,e,_),s(),l||(o=[Y(e,"mousedown",t[64]==="interface"?t[7]:void 0),Y(e,"mousemove",t[64]==="interface"?t[8]:void 0),Y(e,"mouseup",t[64]==="interface"?t[9]:void 0),Y(e,"mouseout",t[64]==="interface"?t[9]:void 0),Y(e,"blur",t[64]==="interface"?t[9]:void 0),Y(e,"touchstart",t[64]==="interface"?t[7]:void 0),Y(e,"touchmove",t[64]==="interface"?t[8]:void 0),Y(e,"touchend",t[64]==="interface"?t[9]:void 0),Y(e,"touchcancel",t[64]==="interface"?t[9]:void 0),Y(e,"click",Et(t[29]))],l=!0)},p(i,_){t=i,r!==t[64]&&(a(),r=t[64],s()),_[0]&32&&O(e,"lr",t[5]),_[0]&32&&O(e,"tb",!t[5])},d(i){i&&z(e),a(),l=!1,$e(o)}}}function on(t){let e,n,r,l,o=t[4]===0&&ut(),s=t[6],a=[];for(let i=0;i<s.length;i+=1)a[i]=ft(at(t,s,i));return{c(){e=F("div"),o&&o.c(),n=U();for(let i=0;i<a.length;i+=1)a[i].c();d(e,"class","wrap svelte-1g1hqr7"),Ke(()=>t[32].call(e))},m(i,_){C(i,e,_),o&&o.m(e,null),H(e,n);for(let f=0;f<a.length;f+=1)a[f].m(e,null);t[31](e),r=It(e,t[32].bind(e)),l=!0},p(i,_){if(i[4]===0?o?_[0]&16&&w(o,1):(o=ut(),o.c(),w(o,1),o.m(e,n)):o&&(K(),A(o,1,1,()=>{o=null}),$()),_[0]&993){s=i[6];let f;for(f=0;f<s.length;f+=1){const g=at(i,s,f);a[f]?a[f].p(g,_):(a[f]=ft(g),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=s.length}},i(i){l||(w(o),l=!0)},o(i){A(o),l=!1},d(i){i&&z(e),o&&o.d(),St(a,i),t[31](null),r()}}}let an="#aaa";function _t(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function un(t,e,n){let r;const l=de();let{value:o}=e,{value_img:s}=e,{mode:a="sketch"}=e,{brush_color:i="#0b0f19"}=e,{brush_radius:_}=e,{source:f}=e,{width:g=400}=e,{height:u=200}=e,{container_height:m=200}=e,{shape:b}=e,I=localStorage.setItem("colorPickerEnable",!1),D,R=g,q=u,ne;const ce=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let M={},k={},W=[],N=[],re=!0,fe=!0,se=!1,le=!1,p=null,P=null,x=null,ie=0;function oe(){if(!b){k.temp.drawImage(s,0,0,g,u);return}let h=s.naturalWidth,y=s.naturalHeight;const v=b[0]/b[1],c=h/y;let B=0,L=0;v<c?(h=b[1]*c,y=b[1],B=(b[0]-h)/2):v>c?(h=b[0],y=b[0]/c,L=(b[1]-y)/2):(B=0,L=0,h=b[0],y=b[1]),k.temp.drawImage(s,B,L,h,y)}yt(async()=>{Object.keys(M).forEach(h=>{n(26,k[h]=M[h].getContext("2d"),k)}),await ke(),s&&(s.addEventListener("load",h=>{f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):oe(),k.drawing.drawImage(M.temp,0,0,g,u),ue()}),setTimeout(()=>{f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):oe(),k.drawing.drawImage(M.temp,0,0,g,u),be({lines:N.slice()}),ue()},100)),n(28,p=new ln({radius:_*.05,enabled:!0,initialPoint:{x:g/2,y:u/2}})),x=new Ot((h,y,...v)=>{Se(h,y)}),x.observe(P),Ie(),n(24,D=!0),requestAnimationFrame(()=>{ae(),requestAnimationFrame(()=>{me()})})});function ae(){const h=g/2,y=u/2;p.update({x:h,y},{both:!0}),p.update({x:h,y},{both:!1}),re=!0,fe=!0}Tt(()=>{n(24,D=!1),x.unobserve(P)});function Fe(){const h=N.slice(0,-1);Ae(),s&&(f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):oe(),(!N||!N.length)&&k.drawing.drawImage(M.temp,0,0,g,u)),be({lines:h}),n(4,ie=h.length),N.length&&n(27,N=h),N.length==0&&l("clear"),ue()}function We(){Ae(),s&&oe(),be({lines:N}),n(4,ie=N.length),N.length==0&&l("clear"),ue()}let be=({lines:h})=>{const y=i;h.forEach(v=>{let{points:c,brush_color:B,brush_radius:L}=v;we(a==="mask"?{points:c,brush_color:y,brush_radius:L}:{points:c,brush_color:B,brush_radius:L}),a==="mask"&&De({points:c,brush_color:y,brush_radius:L}),W=c}),qe({brush_color:i,brush_radius:_}),a==="mask"&&Re()},Oe=h=>{h.preventDefault();const{x:y,y:v}=Te(h);if(I=localStorage.getItem("colorPickerEnable")==="true",I&&a!=="mask"){n(13,i=Ye(y,v)),localStorage.setItem("colorPickerEnable","false");return}le=!0,h.touches&&h.touches.length>0&&p.update({x:y,y:v},{both:!0}),Be(y,v),n(4,ie+=1)},Ce=h=>{h.preventDefault();const{x:y,y:v}=Te(h);Be(y,v)},He=h=>{h.preventDefault(),Ce(h),se=!1,le=!1,qe(),a==="mask"&&Re()},ze=0,ve=0,Me=0,Ee=!1,Se=async()=>{if(b&&P){const v=P?.getBoundingClientRect(),c=b[0]/b[1],B=v.width/v.height;n(5,Ee=c<B)}if(g===ze&&u===ve&&Me===m)return;const h={width:g,height:u},y={height:m,width:m*(h.width/h.height)};await Promise.all([he(M.interface,h,y),he(M.drawing,h,y),he(M.temp,h,y),he(M.temp_fake,h,y),he(M.mask,h,y,!1)]),_||n(10,_=20*(h.width/y.width)),Ie({once:!0}),setTimeout(()=>{ve=u,ze=g,Me=m},10),await ke(),me()},he=async(h,y,v,c=!0)=>{if(!D)return;await ke();const B=window.devicePixelRatio||1;h.width=y.width*(c?B:1),h.height=y.height*(c?B:1);const L=h.getContext("2d");c&&L.scale(B,B),h.style.width=`${v.width}px`,h.style.height=`${v.height}px`},Te=h=>{const y=M.interface.getBoundingClientRect();let v=h.clientX,c=h.clientY;return h.changedTouches&&h.changedTouches.length>0&&(v=h.changedTouches[0].clientX,c=h.changedTouches[0].clientY),{x:(v-y.left)/y.width*g,y:(c-y.top)/y.height*u}};function Ve(){if(I=localStorage.getItem("colorPickerEnable")==="true",I&&a!=="mask")for(const h in M)n(0,M[h].style.cursor="crosshair",M);else for(const h in M)n(0,M[h].style.cursor="none",M)}let Be=(h,y)=>{if(I=localStorage.getItem("colorPickerEnable")==="true",Ve(),I&&a!=="mask")return;p.update({x:h,y});const v=!p.isEnabled();(le&&!se||v&&le)&&(se=!0,W.push(p.brush.toObject())),se&&(W.push(p.brush.toObject()),we({points:W,brush_color:i,brush_radius:_}),a==="mask"&&De({points:W,brush_color:i,brush_radius:_})),re=!0},we=({points:h,brush_color:y,brush_radius:v})=>{if(!h||h.length<2||(n(26,k.temp.lineJoin="round",k),n(26,k.temp.lineCap="round",k),n(26,k.temp.strokeStyle=y,k),n(26,k.temp.lineWidth=v,k),!h||h.length<2))return;let c=h[0],B=h[1];k.temp.moveTo(B.x,B.y),k.temp.beginPath();for(var L=1,Le=h.length;L<Le;L++){var ye=_t(c,B);k.temp.quadraticCurveTo(c.x,c.y,ye.x,ye.y),c=h[L],B=h[L+1]}k.temp.lineTo(c.x,c.y),k.temp.stroke()},De=({points:h,brush_color:y,brush_radius:v})=>{if(!h||h.length<2)return;n(26,k.temp_fake.lineJoin="round",k),n(26,k.temp_fake.lineCap="round",k),n(26,k.temp_fake.strokeStyle="#fff",k),n(26,k.temp_fake.lineWidth=v,k);let c=h[0],B=h[1];k.temp_fake.moveTo(B.x,B.y),k.temp_fake.beginPath();for(var L=1,Le=h.length;L<Le;L++){var ye=_t(c,B);k.temp_fake.quadraticCurveTo(c.x,c.y,ye.x,ye.y),c=h[L],B=h[L+1]}k.temp_fake.lineTo(c.x,c.y),k.temp_fake.stroke()};function Ye(h,y){const v=k.drawing.getImageData(h,y,1,1),[c,B,L,Le]=v.data;return`rgb(${c}, ${B}, ${L})`}let Re=()=>{W.length<1||(W.length=0,k.mask.drawImage(M.temp_fake,0,0,g,u),ue())},qe=()=>{W.length<1||(N.push({points:W.slice(),brush_color:i,brush_radius:_}),a!=="mask"&&(W.length=0),k.drawing.drawImage(M.temp,0,0,g,u),ue())},ue=()=>{const h=je();l("change",h)};function me(){return n(27,N=[]),Ae(),n(4,ie=0),!0}function Ae(){fe=!0,k.temp.clearRect(0,0,g,u),n(26,k.temp.fillStyle=a==="mask"?"transparent":"#FFFFFF",k),k.temp.fillRect(0,0,g,u),a==="mask"&&(k.temp_fake.clearRect(0,0,M.temp_fake.width,M.temp_fake.height),k.mask.clearRect(0,0,g,u),n(26,k.mask.fillStyle="#000",k),k.mask.fillRect(0,0,g,u))}let Ie=({once:h=!1}={})=>{if(re||fe){const y=p.getPointerCoordinates(),v=p.getBrushCoordinates();Je(k.interface,y,v),re=!1,fe=!1}h||window.requestAnimationFrame(()=>{Ie()})},Je=(h,y,v)=>{h.clearRect(0,0,g,u),h.beginPath(),h.fillStyle=i,h.arc(v.x,v.y,_/2,0,Math.PI*2,!0),h.fill(),h.beginPath(),h.fillStyle=an,h.arc(v.x,v.y,r,0,Math.PI*2,!0),h.fill()};function je(){return a==="mask"?M.mask.toDataURL("image/jpg"):M.drawing.toDataURL("image/jpg")}function Xe(h){ge.call(this,t,h)}function Qe(h,y){j[h?"unshift":"push"](()=>{M[y]=h,n(0,M)})}function Ge(h){j[h?"unshift":"push"](()=>{P=h,n(3,P)})}function Ze(){R=this.offsetWidth,q=this.offsetHeight,n(1,R),n(2,q)}return t.$$set=h=>{"value"in h&&n(14,o=h.value),"value_img"in h&&n(15,s=h.value_img),"mode"in h&&n(16,a=h.mode),"brush_color"in h&&n(13,i=h.brush_color),"brush_radius"in h&&n(10,_=h.brush_radius),"source"in h&&n(17,f=h.source),"width"in h&&n(11,g=h.width),"height"in h&&n(12,u=h.height),"container_height"in h&&n(18,m=h.container_height),"shape"in h&&n(19,b=h.shape)},t.$$.update=()=>{t.$$.dirty[0]&530432&&b&&(g||u)&&(n(11,g=b[0]),n(12,u=b[1])),t.$$.dirty[0]&16793600&&D&&!o&&me(),t.$$.dirty[0]&251828225&&D&&s!==ne&&(n(25,ne=s),me(),setTimeout(()=>{f==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):oe(),k.drawing.drawImage(M.temp,0,0,g,u),be({lines:N.slice()}),ue()},50)),t.$$.dirty[0]&268436480&&p&&(ae(),p.setRadius(_*.05)),t.$$.dirty[0]&6144&&(g||u)&&Se(),t.$$.dirty[0]&1024&&(r=_*.075)},[M,R,q,P,ie,Ee,ce,Oe,Ce,He,_,g,u,i,o,s,a,f,m,b,Fe,We,me,je,D,ne,k,N,p,Xe,Qe,Ge,Ze]}class et extends ee{constructor(e){super(),te(this,e,un,on,Z,{value:14,value_img:15,mode:16,brush_color:13,brush_radius:10,source:17,width:11,height:12,container_height:18,shape:19,undo:20,redraw:21,clear:22,get_image_data:23},null,[-1,-1,-1])}get undo(){return this.$$.ctx[20]}get redraw(){return this.$$.ctx[21]}get clear(){return this.$$.ctx[22]}get get_image_data(){return this.$$.ctx[23]}}function fn(t){let e,n,r,l,o,s,a;return n=new pe({props:{Icon:Ht,label:"Undo"}}),n.$on("click",t[1]),l=new pe({props:{Icon:Jt,label:"Redraw"}}),l.$on("click",t[2]),s=new pe({props:{Icon:Yt,label:"Clear"}}),s.$on("click",t[3]),{c(){e=F("div"),E(n.$$.fragment),r=U(),E(l.$$.fragment),o=U(),E(s.$$.fragment),d(e,"class","svelte-17iq5p5")},m(i,_){C(i,e,_),S(n,e,null),H(e,r),S(l,e,null),H(e,o),S(s,e,null),a=!0},p:V,i(i){a||(w(n.$$.fragment,i),w(l.$$.fragment,i),w(s.$$.fragment,i),a=!0)},o(i){A(n.$$.fragment,i),A(l.$$.fragment,i),A(s.$$.fragment,i),a=!1},d(i){i&&z(e),T(n),T(l),T(s)}}}function _n(t){const e=de();return[e,()=>e("undo"),()=>e("redraw"),o=>{e("clear"),o.stopPropagation()}]}class tt extends ee{constructor(e){super(),te(this,e,_n,fn,Z,{})}}function ct(t){let e,n,r,l,o;return{c(){e=F("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[6])),d(e,"max",r=75*(t[2]/t[6])),d(e,"class","svelte-p4aq0j")},m(s,a){C(s,e,a),Ue(e,t[0]),l||(o=[Y(e,"change",t[11]),Y(e,"input",t[11])],l=!0)},p(s,a){a&68&&n!==(n=.5*(s[2]/s[6]))&&d(e,"min",n),a&68&&r!==(r=75*(s[2]/s[6]))&&d(e,"max",r),a&1&&Ue(e,s[0])},d(s){s&&z(e),l=!1,$e(o)}}}function cn(t){let e,n,r,l;n=new pe({props:{Icon:en,label:"Select brush color"}}),n.$on("click",t[12]);let o=t[5]&&ht(t);return{c(){e=F("span"),E(n.$$.fragment),r=U(),o&&o.c(),d(e,"class","col svelte-p4aq0j")},m(s,a){C(s,e,a),S(n,e,null),H(e,r),o&&o.m(e,null),l=!0},p(s,a){s[5]?o?o.p(s,a):(o=ht(s),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(s){l||(w(n.$$.fragment,s),l=!0)},o(s){A(n.$$.fragment,s),l=!1},d(s){s&&z(e),T(n),o&&o.d()}}}function ht(t){let e,n,r;return{c(){e=F("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-p4aq0j")},m(l,o){C(l,e,o),Ue(e,t[1]),n||(r=[Y(e,"change",t[13]),Y(e,"input",t[14])],n=!0)},p(l,o){o&2&&Ue(e,l[1])},d(l){l&&z(e),n=!1,$e(r)}}}function hn(t){let e,n,r,l,o,s;r=new pe({props:{Icon:$t,label:"Use brush"}}),r.$on("click",t[10]);let a=t[4]&&ct(t),i=cn(t);return{c(){e=F("div"),n=F("span"),E(r.$$.fragment),l=U(),a&&a.c(),o=U(),i&&i.c(),d(n,"class","brush svelte-p4aq0j"),d(e,"class","wrap svelte-p4aq0j")},m(_,f){C(_,e,f),H(e,n),S(r,n,null),H(n,l),a&&a.m(n,null),H(e,o),i&&i.m(e,null),s=!0},p(_,[f]){_[4]?a?a.p(_,f):(a=ct(_),a.c(),a.m(n,null)):a&&(a.d(1),a=null),i.p(_,f)},i(_){s||(w(r.$$.fragment,_),w(i),s=!0)},o(_){A(r.$$.fragment,_),A(i),s=!1},d(_){_&&z(e),T(r),a&&a.d(),i&&i.d()}}}function mn(t,e,n){let r;const l=de();let o=!1,s=!1,{brush_radius:a=20}=e,{brush_color:i="#000"}=e,{container_height:_}=e,{img_width:f}=e,{img_height:g}=e,{mode:u="other"}=e;const m=()=>n(4,o=!o);function b(){a=Bt(this.value),n(0,a)}const I=()=>n(5,s=!s),D=()=>{u==="mask"&&l("redraw")};function R(){i=this.value,n(1,i)}return t.$$set=q=>{"brush_radius"in q&&n(0,a=q.brush_radius),"brush_color"in q&&n(1,i=q.brush_color),"container_height"in q&&n(8,_=q.container_height),"img_width"in q&&n(2,f=q.img_width),"img_height"in q&&n(9,g=q.img_height),"mode"in q&&n(3,u=q.mode)},t.$$.update=()=>{t.$$.dirty&772&&n(6,r=_*(f/g))},[a,i,f,u,o,s,r,l,_,g,m,b,I,D,R]}class nt extends ee{constructor(e){super(),te(this,e,mn,hn,Z,{brush_radius:0,brush_color:1,container_height:8,img_width:2,img_height:9,mode:3})}}function gn(t){let e,n;return{c(){e=F("img"),J(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-rlgzoo"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(r,l){C(r,e,l)},p(r,l){l[0]&1&&!J(e.src,n=r[0].image||r[0])&&d(e,"src",n),l[0]&544&&O(e,"webcam",r[5]==="webcam"&&r[9])},i:V,o:V,d(r){r&&z(e)}}}function dn(t){let e=t[22],n,r,l,o=mt(t),s=t[17]>0&&gt(t);return{c(){o.c(),n=U(),s&&s.c(),r=_e()},m(a,i){o.m(a,i),C(a,n,i),s&&s.m(a,i),C(a,r,i),l=!0},p(a,i){i[0]&4194304&&Z(e,e=a[22])?(o.d(1),o=mt(a),o.c(),o.m(n.parentNode,n)):o.p(a,i),a[17]>0?s?(s.p(a,i),i[0]&131072&&w(s,1)):(s=gt(a),s.c(),w(s,1),s.m(r.parentNode,r)):s&&(K(),A(s,1,1,()=>{s=null}),$())},i(a){l||(w(s),l=!0)},o(a){A(s),l=!1},d(a){o.d(a),a&&z(n),s&&s.d(a),a&&z(r)}}}function bn(t){let e,n,r,l,o;return e=new Pe({props:{editable:!0}}),e.$on("edit",t[53]),e.$on("clear",t[25]),{c(){E(e.$$.fragment),n=U(),r=F("img"),J(r.src,l=t[0])||d(r,"src",l),d(r,"alt",""),d(r,"class","svelte-rlgzoo"),O(r,"webcam",t[5]==="webcam"&&t[9])},m(s,a){S(e,s,a),C(s,n,a),C(s,r,a),o=!0},p(s,a){(!o||a[0]&1&&!J(r.src,l=s[0]))&&d(r,"src",l),a[0]&544&&O(r,"webcam",s[5]==="webcam"&&s[9])},i(s){o||(w(e.$$.fragment,s),o=!0)},o(s){A(e.$$.fragment,s),o=!1},d(s){T(e,s),s&&z(n),s&&z(r)}}}function kn(t){let e,n,r,l,o={image:t[0]};return e=new zt({props:o}),t[51](e),e.$on("crop",t[26]),r=new Pe({}),r.$on("clear",t[52]),{c(){E(e.$$.fragment),n=U(),E(r.$$.fragment)},m(s,a){S(e,s,a),C(s,n,a),S(r,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(w(e.$$.fragment,s),w(r.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),A(r.$$.fragment,s),l=!1},d(s){t[51](null),T(e,s),s&&z(n),T(r,s)}}}function pn(t){let e,n,r=t[5]==="webcam"&&!t[22]&&bt(t);return{c(){r&&r.c(),e=_e()},m(l,o){r&&r.m(l,o),C(l,e,o),n=!0},p(l,o){l[5]==="webcam"&&!l[22]?r?(r.p(l,o),o[0]&4194336&&w(r,1)):(r=bt(l),r.c(),w(r,1),r.m(e.parentNode,e)):r&&(K(),A(r,1,1,()=>{r=null}),$())},i(l){n||(w(r),n=!0)},o(l){A(r),n=!1},d(l){r&&r.d(l),l&&z(e)}}}function wn(t){let e,n,r,l,o,s,a;e=new tt({}),e.$on("undo",t[42]),e.$on("redraw",t[43]),e.$on("clear",t[28]);let i=t[1]==="color-sketch"&&kt(t);function _(u){t[46](u)}function f(u){t[47](u)}let g={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],shape:t[6]};return t[2]!==void 0&&(g.brush_radius=t[2]),t[23]!==void 0&&(g.brush_color=t[23]),l=new et({props:g}),j.push(()=>Q(l,"brush_radius",_)),j.push(()=>Q(l,"brush_color",f)),t[48](l),l.$on("change",t[26]),l.$on("clear",t[28]),{c(){E(e.$$.fragment),n=U(),i&&i.c(),r=U(),E(l.$$.fragment)},m(u,m){S(e,u,m),C(u,n,m),i&&i.m(u,m),C(u,r,m),S(l,u,m),a=!0},p(u,m){u[1]==="color-sketch"?i?(i.p(u,m),m[0]&2&&w(i,1)):(i=kt(u),i.c(),w(i,1),i.m(r.parentNode,r)):i&&(K(),A(i,1,1,()=>{i=null}),$());const b={};m[0]&1&&(b.value=u[0]),m[0]&4096&&(b.mode=u[12]),m[0]&2228224&&(b.width=u[17]||u[21]),m[0]&1114112&&(b.height=u[16]||u[20]),m[0]&1310720&&(b.container_height=u[18]||u[20]),m[0]&64&&(b.shape=u[6]),!o&&m[0]&4&&(o=!0,b.brush_radius=u[2],X(()=>o=!1)),!s&&m[0]&8388608&&(s=!0,b.brush_color=u[23],X(()=>s=!1)),l.$set(b)},i(u){a||(w(e.$$.fragment,u),w(i),w(l.$$.fragment,u),a=!0)},o(u){A(e.$$.fragment,u),A(i),A(l.$$.fragment,u),a=!1},d(u){T(e,u),u&&z(n),i&&i.d(u),u&&z(r),t[48](null),T(l,u)}}}function An(t){let e,n,r;function l(s){t[41](s)}let o={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[Mn]},$$scope:{ctx:t}};return t[11]!==void 0&&(o.dragging=t[11]),e=new Xt({props:o}),j.push(()=>Q(e,"dragging",l)),e.$on("load",t[24]),{c(){E(e.$$.fragment)},m(s,a){S(e,s,a),r=!0},p(s,a){const i={};a[0]&1&&(i.disable_click=!!s[0]),a[0]&16774887|a[2]&2&&(i.$$scope={dirty:a,ctx:s}),!n&&a[0]&2048&&(n=!0,i.dragging=s[11],X(()=>n=!1)),e.$set(i)},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){T(e,s)}}}function mt(t){let e,n,r,l;return{c(){e=F("img"),d(e,"class","absolute-img svelte-rlgzoo"),J(e.src,n=t[22]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt","load-1"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){C(o,e,s),t[54](e),r||(l=Y(e,"load",t[27]),r=!0)},p(o,s){s[0]&4194305&&!J(e.src,n=o[22]||o[0]?.image||o[0])&&d(e,"src",n),s[0]&544&&O(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&z(e),t[54](null),r=!1,l()}}}function gt(t){let e,n,r,l,o,s,a,i;function _(m){t[56](m)}function f(m){t[57](m)}let g={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5]};t[2]!==void 0&&(g.brush_radius=t[2]),t[23]!==void 0&&(g.brush_color=t[23]),e=new et({props:g}),t[55](e),j.push(()=>Q(e,"brush_radius",_)),j.push(()=>Q(e,"brush_color",f)),e.$on("change",t[26]),o=new tt({}),o.$on("undo",t[58]),o.$on("redraw",t[59]),o.$on("clear",t[28]);let u=(t[1]==="color-sketch"||t[1]==="sketch")&&dt(t);return{c(){E(e.$$.fragment),l=U(),E(o.$$.fragment),s=U(),u&&u.c(),a=_e()},m(m,b){S(e,m,b),C(m,l,b),S(o,m,b),C(m,s,b),u&&u.m(m,b),C(m,a,b),i=!0},p(m,b){const I={};b[0]&1&&(I.value=m[0]),b[0]&4096&&(I.mode=m[12]),b[0]&2228224&&(I.width=m[17]||m[21]),b[0]&1114112&&(I.height=m[16]||m[20]),b[0]&1310720&&(I.container_height=m[18]||m[20]),b[0]&524288&&(I.value_img=m[19]),b[0]&32&&(I.source=m[5]),!n&&b[0]&4&&(n=!0,I.brush_radius=m[2],X(()=>n=!1)),!r&&b[0]&8388608&&(r=!0,I.brush_color=m[23],X(()=>r=!1)),e.$set(I),m[1]==="color-sketch"||m[1]==="sketch"?u?(u.p(m,b),b[0]&2&&w(u,1)):(u=dt(m),u.c(),w(u,1),u.m(a.parentNode,a)):u&&(K(),A(u,1,1,()=>{u=null}),$())},i(m){i||(w(e.$$.fragment,m),w(o.$$.fragment,m),w(u),i=!0)},o(m){A(e.$$.fragment,m),A(o.$$.fragment,m),A(u),i=!1},d(m){t[55](null),T(e,m),m&&z(l),T(o,m),m&&z(s),u&&u.d(m),m&&z(a)}}}function dt(t){let e,n,r,l;function o(i){t[60](i)}function s(i){t[61](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new nt({props:a}),j.push(()=>Q(e,"brush_radius",o)),j.push(()=>Q(e,"brush_color",s)),{c(){E(e.$$.fragment)},m(i,_){S(e,i,_),l=!0},p(i,_){const f={};_[0]&1310720&&(f.container_height=i[18]||i[20]),_[0]&2228224&&(f.img_width=i[17]||i[21]),_[0]&1114112&&(f.img_height=i[16]||i[20]),_[0]&4096&&(f.mode=i[12]),!n&&_[0]&4&&(n=!0,f.brush_radius=i[2],X(()=>n=!1)),!r&&_[0]&8388608&&(r=!0,f.brush_color=i[23],X(()=>r=!1)),e.$set(f)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){T(e,i)}}}function bt(t){let e,n;return e=new Vt({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[49]),e.$on("stream",t[26]),e.$on("error",t[50]),{c(){E(e.$$.fragment)},m(r,l){S(e,r,l),n=!0},p(r,l){const o={};l[0]&128&&(o.streaming=r[7]),l[0]&256&&(o.pending=r[8]),l[0]&512&&(o.mirror_webcam=r[9]),e.$set(o)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function kt(t){let e,n,r,l;function o(i){t[44](i)}function s(i){t[45](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new nt({props:a}),j.push(()=>Q(e,"brush_radius",o)),j.push(()=>Q(e,"brush_color",s)),e.$on("redraw",function(){xe(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){E(e.$$.fragment)},m(i,_){S(e,i,_),l=!0},p(i,_){t=i;const f={};_[0]&1310720&&(f.container_height=t[18]||t[20]),_[0]&2228224&&(f.img_width=t[17]||t[21]),_[0]&1114112&&(f.img_height=t[16]||t[20]),!n&&_[0]&4&&(n=!0,f.brush_radius=t[2],X(()=>n=!1)),!r&&_[0]&8388608&&(r=!0,f.brush_color=t[23],X(()=>r=!1)),e.$set(f)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){T(e,i)}}}function In(t){let e,n;return{c(){e=F("img"),J(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt","hello"),d(e,"class","svelte-rlgzoo"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(r,l){C(r,e,l)},p(r,l){l[0]&1&&!J(e.src,n=r[0].image||r[0])&&d(e,"src",n),l[0]&544&&O(e,"webcam",r[5]==="webcam"&&r[9])},i:V,o:V,d(r){r&&z(e)}}}function yn(t){let e=t[22],n,r,l,o=pt(t),s=t[17]>0&&wt(t);return{c(){o.c(),n=U(),s&&s.c(),r=_e()},m(a,i){o.m(a,i),C(a,n,i),s&&s.m(a,i),C(a,r,i),l=!0},p(a,i){i[0]&4194304&&Z(e,e=a[22])?(o.d(1),o=pt(a),o.c(),o.m(n.parentNode,n)):o.p(a,i),a[17]>0?s?(s.p(a,i),i[0]&131072&&w(s,1)):(s=wt(a),s.c(),w(s,1),s.m(r.parentNode,r)):s&&(K(),A(s,1,1,()=>{s=null}),$())},i(a){l||(w(s),l=!0)},o(a){A(s),l=!1},d(a){o.d(a),a&&z(n),s&&s.d(a),a&&z(r)}}}function Cn(t){let e,n,r,l,o;return e=new Pe({props:{editable:!0}}),e.$on("edit",t[32]),e.$on("clear",t[25]),{c(){E(e.$$.fragment),n=U(),r=F("img"),J(r.src,l=t[0])||d(r,"src",l),d(r,"alt",""),d(r,"class","svelte-rlgzoo"),O(r,"scale-x-[-1]",t[5]==="webcam"&&t[9])},m(s,a){S(e,s,a),C(s,n,a),C(s,r,a),o=!0},p(s,a){(!o||a[0]&1&&!J(r.src,l=s[0]))&&d(r,"src",l),a[0]&544&&O(r,"scale-x-[-1]",s[5]==="webcam"&&s[9])},i(s){o||(w(e.$$.fragment,s),o=!0)},o(s){A(e.$$.fragment,s),o=!1},d(s){T(e,s),s&&z(n),s&&z(r)}}}function zn(t){let e,n,r,l,o={image:t[0]};return e=new zt({props:o}),t[30](e),e.$on("crop",t[26]),r=new Pe({}),r.$on("clear",t[31]),{c(){E(e.$$.fragment),n=U(),E(r.$$.fragment)},m(s,a){S(e,s,a),C(s,n,a),S(r,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(w(e.$$.fragment,s),w(r.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),A(r.$$.fragment,s),l=!1},d(s){t[30](null),T(e,s),s&&z(n),T(r,s)}}}function vn(t){let e;const n=t[29].default,r=Dt(n,t,t[63],null);return{c(){r&&r.c()},m(l,o){r&&r.m(l,o),e=!0},p(l,o){r&&r.p&&(!e||o[2]&2)&&Rt(r,n,l,l[63],e?jt(n,l[63],o,null):qt(l[63]),null)},i(l){e||(w(r,l),e=!0)},o(l){A(r,l),e=!1},d(l){r&&r.d(l)}}}function pt(t){let e,n,r,l;return{c(){e=F("img"),d(e,"class","absolute-img svelte-rlgzoo"),J(e.src,n=t[22]||t[0].image||t[0])||d(e,"src",n),d(e,"data-source",t[14]),d(e,"data-isupload",t[15]),d(e,"alt","load-2"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){C(o,e,s),t[33](e),r||(l=Y(e,"load",t[27]),r=!0)},p(o,s){s[0]&4194305&&!J(e.src,n=o[22]||o[0].image||o[0])&&d(e,"src",n),s[0]&16384&&d(e,"data-source",o[14]),s[0]&32768&&d(e,"data-isupload",o[15]),s[0]&544&&O(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&z(e),t[33](null),r=!1,l()}}}function wt(t){let e,n,r,l,o,s,a,i;function _(m){t[35](m)}function f(m){t[36](m)}let g={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5],shape:t[6]};t[2]!==void 0&&(g.brush_radius=t[2]),t[23]!==void 0&&(g.brush_color=t[23]),e=new et({props:g}),t[34](e),j.push(()=>Q(e,"brush_radius",_)),j.push(()=>Q(e,"brush_color",f)),e.$on("change",t[26]),e.$on("redraw",function(){xe(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),o=new tt({}),o.$on("undo",t[37]),o.$on("redraw",t[38]),o.$on("clear",t[28]);let u=(t[1]==="color-sketch"||t[1]==="sketch")&&At(t);return{c(){E(e.$$.fragment),l=U(),E(o.$$.fragment),s=U(),u&&u.c(),a=_e()},m(m,b){S(e,m,b),C(m,l,b),S(o,m,b),C(m,s,b),u&&u.m(m,b),C(m,a,b),i=!0},p(m,b){t=m;const I={};b[0]&1&&(I.value=t[0]),b[0]&4096&&(I.mode=t[12]),b[0]&2228224&&(I.width=t[17]||t[21]),b[0]&1114112&&(I.height=t[16]||t[20]),b[0]&1310720&&(I.container_height=t[18]||t[20]),b[0]&524288&&(I.value_img=t[19]),b[0]&32&&(I.source=t[5]),b[0]&64&&(I.shape=t[6]),!n&&b[0]&4&&(n=!0,I.brush_radius=t[2],X(()=>n=!1)),!r&&b[0]&8388608&&(r=!0,I.brush_color=t[23],X(()=>r=!1)),e.$set(I),t[1]==="color-sketch"||t[1]==="sketch"?u?(u.p(t,b),b[0]&2&&w(u,1)):(u=At(t),u.c(),w(u,1),u.m(a.parentNode,a)):u&&(K(),A(u,1,1,()=>{u=null}),$())},i(m){i||(w(e.$$.fragment,m),w(o.$$.fragment,m),w(u),i=!0)},o(m){A(e.$$.fragment,m),A(o.$$.fragment,m),A(u),i=!1},d(m){t[34](null),T(e,m),m&&z(l),T(o,m),m&&z(s),u&&u.d(m),m&&z(a)}}}function At(t){let e,n,r,l;function o(i){t[39](i)}function s(i){t[40](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new nt({props:a}),j.push(()=>Q(e,"brush_radius",o)),j.push(()=>Q(e,"brush_color",s)),e.$on("redraw",function(){xe(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){E(e.$$.fragment)},m(i,_){S(e,i,_),l=!0},p(i,_){t=i;const f={};_[0]&1310720&&(f.container_height=t[18]||t[20]),_[0]&2228224&&(f.img_width=t[17]||t[21]),_[0]&1114112&&(f.img_height=t[16]||t[20]),_[0]&4096&&(f.mode=t[12]),!n&&_[0]&4&&(n=!0,f.brush_radius=t[2],X(()=>n=!1)),!r&&_[0]&8388608&&(r=!0,f.brush_color=t[23],X(()=>r=!1)),e.$set(f)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){A(e.$$.fragment,i),l=!1},d(i){T(e,i)}}}function Mn(t){let e,n,r,l;const o=[vn,zn,Cn,yn,In],s=[];function a(i,_){return i[0]===null&&!i[22]||i[7]?0:i[1]==="select"?1:i[1]==="editor"?2:(i[1]==="sketch"||i[1]==="color-sketch")&&(i[0]!==null||i[22])?3:4}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),r=_e()},m(i,_){s[e].m(i,_),C(i,r,_),l=!0},p(i,_){let f=e;e=a(i),e===f?s[e].p(i,_):(K(),A(s[f],1,1,()=>{s[f]=null}),$(),n=s[e],n?n.p(i,_):(n=s[e]=o[e](i),n.c()),w(n,1),n.m(r.parentNode,r))},i(i){l||(w(n),l=!0)},o(i){A(n),l=!1},d(i){s[e].d(i),i&&z(r)}}}function En(t){let e,n,r,l,o,s,a;e=new Ct({props:{show_label:t[4],Icon:t[5]==="canvas"?lt:Ne,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const i=[An,wn,pn,kn,bn,dn,gn],_=[];function f(g,u){return g[5]==="upload"?0:g[5]==="canvas"?1:g[0]===null&&!g[22]||g[7]?2:g[1]==="select"?3:g[1]==="editor"?4:(g[1]==="sketch"||g[1]==="color-sketch")&&(g[0]!==null||g[22])?5:6}return l=f(t),o=_[l]=i[l](t),{c(){E(e.$$.fragment),n=U(),r=F("div"),o.c(),d(r,"data-testid","image"),d(r,"class","svelte-rlgzoo"),Ke(()=>t[62].call(r)),O(r,"fixed-height",t[5]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(g,u){S(e,g,u),C(g,n,u),C(g,r,u),_[l].m(r,null),s=It(r,t[62].bind(r)),a=!0},p(g,u){const m={};u[0]&16&&(m.show_label=g[4]),u[0]&32&&(m.Icon=g[5]==="canvas"?lt:Ne),u[0]&40&&(m.label=g[3]||(g[5]==="canvas"?"Sketch":"Image")),e.$set(m);let b=l;l=f(g),l===b?_[l].p(g,u):(K(),A(_[b],1,1,()=>{_[b]=null}),$(),o=_[l],o?o.p(g,u):(o=_[l]=i[l](g),o.c()),w(o,1),o.m(r,null)),u[0]&34&&O(r,"fixed-height",g[5]!=="webcam"||g[1]==="sketch"||g[1]==="color-sketch")},i(g){a||(w(e.$$.fragment,g),w(o),a=!0)},o(g){A(e.$$.fragment,g),A(o),a=!1},d(g){T(e,g),g&&z(n),g&&z(r),_[l].d(),s()}}}function Sn(t,e,n){let r,{$$slots:l={},$$scope:o}=e,{value:s}=e,{label:a=void 0}=e,{show_label:i}=e,{source:_="upload"}=e,{tool:f="editor"}=e,{shape:g}=e,{streaming:u=!1}=e,{pending:m=!1}=e,{mirror_webcam:b}=e,{brush_radius:I}=e,D,R,q="",ne=!1;s&&(_==="upload"||_==="webcam")&&f==="sketch"&&(s={image:s,mask:null});function ce({detail:c}){f==="color-sketch"?n(22,ae=c):n(0,s=(_==="upload"||_==="webcam")&&f==="sketch"?{image:c,mask:null}:c),n(15,ne=!0),console.log(1),W("upload",c)}function M({detail:c}){n(0,s=null),n(22,ae=void 0),W("clear")}async function k({detail:c},B,L=!1){P==="mask"?_==="webcam"&&B?n(0,s={image:c,mask:null}):n(0,s={image:typeof s=="string"?s:s?.image||null,mask:c}):(_==="upload"||_==="webcam")&&f==="sketch"?n(0,s={image:c,mask:null}):(q===""&&n(14,q=c),n(0,s=c)),await ke(),W(u?"stream":"edit")}const W=de();let N=!1;function re(c){const B=c.currentTarget;n(17,le=B.naturalWidth),n(16,se=B.naturalHeight),n(18,p=B.getBoundingClientRect().height)}async function fe(){D.clear(),await ke(),n(0,s=null),n(22,ae=void 0),n(14,q=""),n(15,ne=!1)}let se=0,le=0,p=0,P,x,ie,oe,ae;yt(async()=>{f==="color-sketch"&&s&&typeof s=="string"&&(n(22,ae=s),await ke(),re({currentTarget:x}))});function Fe(c){j[c?"unshift":"push"](()=>{R=c,n(10,R),n(0,s)})}const We=c=>(M(c),n(1,f="editor")),be=()=>n(1,f="select");function Oe(c){j[c?"unshift":"push"](()=>{x=c,n(19,x)})}function Ce(c){j[c?"unshift":"push"](()=>{D=c,n(13,D)})}function He(c){I=c,n(2,I)}function ze(c){r=c,n(23,r),n(12,P),n(5,_),n(1,f)}const ve=()=>D.undo(),Me=()=>D.redraw();function Ee(c){I=c,n(2,I)}function Se(c){r=c,n(23,r),n(12,P),n(5,_),n(1,f)}function he(c){N=c,n(11,N)}const Te=()=>D.undo(),Ve=()=>D.redraw();function Be(c){I=c,n(2,I)}function we(c){r=c,n(23,r),n(12,P),n(5,_),n(1,f)}function De(c){I=c,n(2,I)}function Ye(c){r=c,n(23,r),n(12,P),n(5,_),n(1,f)}function Re(c){j[c?"unshift":"push"](()=>{D=c,n(13,D)})}const qe=c=>f==="color-sketch"?ce(c):k(c,!0,"pizda");function ue(c){ge.call(this,t,c)}function me(c){j[c?"unshift":"push"](()=>{R=c,n(10,R),n(0,s)})}const Ae=c=>(M(c),n(1,f="editor")),Ie=()=>n(1,f="select");function Je(c){j[c?"unshift":"push"](()=>{x=c,n(19,x)})}function je(c){j[c?"unshift":"push"](()=>{D=c,n(13,D)})}function Xe(c){I=c,n(2,I)}function Qe(c){r=c,n(23,r),n(12,P),n(5,_),n(1,f)}const Ge=()=>D.undo(),Ze=()=>D.redraw();function h(c){I=c,n(2,I)}function y(c){r=c,n(23,r),n(12,P),n(5,_),n(1,f)}function v(){ie=this.offsetHeight,oe=this.offsetWidth,n(20,ie),n(21,oe)}return t.$$set=c=>{"value"in c&&n(0,s=c.value),"label"in c&&n(3,a=c.label),"show_label"in c&&n(4,i=c.show_label),"source"in c&&n(5,_=c.source),"tool"in c&&n(1,f=c.tool),"shape"in c&&n(6,g=c.shape),"streaming"in c&&n(7,u=c.streaming),"pending"in c&&n(8,m=c.pending),"mirror_webcam"in c&&n(9,b=c.mirror_webcam),"brush_radius"in c&&n(2,I=c.brush_radius),"$$scope"in c&&n(63,o=c.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&W("change",s),t.$$.dirty[0]&2048&&W("drag",N),t.$$.dirty[0]&34&&(_==="canvas"&&f==="sketch"?n(12,P="bw-sketch"):f==="color-sketch"?n(12,P="color-sketch"):(_==="upload"||_==="webcam")&&f==="sketch"?n(12,P="mask"):n(12,P="editor")),t.$$.dirty[0]&4096&&n(23,r=P=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&n(22,ae=void 0),t.$$.dirty[0]&1025&&R&&(s?(n(10,R.image=s,R),R.create()):R.destroy())},[s,f,I,a,i,_,g,u,m,b,R,N,P,D,q,ne,se,le,p,x,ie,oe,ae,r,ce,M,k,re,fe,l,Fe,We,be,Oe,Ce,He,ze,ve,Me,Ee,Se,he,Te,Ve,Be,we,De,Ye,Re,qe,ue,me,Ae,Ie,Je,je,Xe,Qe,Ge,Ze,h,y,v,o]}class Tn extends ee{constructor(e){super(),te(this,e,Sn,En,Z,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2},null,[-1,-1,-1])}}function Bn(t){let e,n,r,l,o,s,a;return r=new pe({props:{Icon:Gt,label:"Download"}}),{c(){e=F("div"),n=F("a"),E(r.$$.fragment),l=U(),o=F("img"),d(n,"href",t[0]),d(n,"target",window.__is_colab__?"_blank":null),d(n,"download","image"),d(e,"class","download svelte-kt1jzh"),J(o.src,s=t[0])||d(o,"src",s),d(o,"alt",""),d(o,"class","svelte-kt1jzh")},m(i,_){C(i,e,_),H(e,n),S(r,n,null),C(i,l,_),C(i,o,_),a=!0},p(i,_){(!a||_&1)&&d(n,"href",i[0]),(!a||_&1&&!J(o.src,s=i[0]))&&d(o,"src",s)},i(i){a||(w(r.$$.fragment,i),a=!0)},o(i){A(r.$$.fragment,i),a=!1},d(i){i&&z(e),T(r),i&&z(l),i&&z(o)}}}function Dn(t){let e,n;return e=new Qt({props:{size:"large",unpadded_box:!0,$$slots:{default:[Rn]},$$scope:{ctx:t}}}),{c(){E(e.$$.fragment)},m(r,l){S(e,r,l),n=!0},p(r,l){const o={};l&16&&(o.$$scope={dirty:l,ctx:r}),e.$set(o)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function Rn(t){let e,n;return e=new Ne({}),{c(){E(e.$$.fragment)},m(r,l){S(e,r,l),n=!0},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function qn(t){let e,n,r,l,o,s;e=new Ct({props:{show_label:t[2],Icon:Ne,label:t[1]||"Image"}});const a=[Dn,Bn],i=[];function _(f,g){return f[0]===null?0:1}return r=_(t),l=i[r]=a[r](t),{c(){E(e.$$.fragment),n=U(),l.c(),o=_e()},m(f,g){S(e,f,g),C(f,n,g),i[r].m(f,g),C(f,o,g),s=!0},p(f,[g]){const u={};g&4&&(u.show_label=f[2]),g&2&&(u.label=f[1]||"Image"),e.$set(u);let m=r;r=_(f),r===m?i[r].p(f,g):(K(),A(i[m],1,1,()=>{i[m]=null}),$(),l=i[r],l?l.p(f,g):(l=i[r]=a[r](f),l.c()),w(l,1),l.m(o.parentNode,o))},i(f){s||(w(e.$$.fragment,f),w(l),s=!0)},o(f){A(e.$$.fragment,f),A(l),s=!1},d(f){T(e,f),f&&z(n),i[r].d(f),f&&z(o)}}}function jn(t,e,n){let{value:r}=e,{label:l=void 0}=e,{show_label:o}=e;const s=de();return t.$$set=a=>{"value"in a&&n(0,r=a.value),"label"in a&&n(1,l=a.label),"show_label"in a&&n(2,o=a.show_label)},t.$$.update=()=>{t.$$.dirty&1&&r&&s("change",r)},[r,l,o]}class Ln extends ee{constructor(e){super(),te(this,e,jn,qn,Z,{value:0,label:1,show_label:2})}}function Un(t){let e,n,r;function l(s){t[17](s)}let o={brush_radius:t[14],shape:t[13],source:t[5],tool:t[6],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[12],$$slots:{default:[Pn]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.value=t[0]),e=new Tn({props:o}),j.push(()=>Q(e,"value",l)),e.$on("edit",t[18]),e.$on("clear",t[19]),e.$on("change",t[20]),e.$on("stream",t[21]),e.$on("drag",t[22]),e.$on("upload",t[23]),e.$on("error",t[24]),{c(){E(e.$$.fragment)},m(s,a){S(e,s,a),r=!0},p(s,a){const i={};a&16384&&(i.brush_radius=s[14]),a&8192&&(i.shape=s[13]),a&32&&(i.source=s[5]),a&64&&(i.tool=s[6]),a&128&&(i.label=s[7]),a&256&&(i.show_label=s[8]),a&1024&&(i.pending=s[10]),a&512&&(i.streaming=s[9]),a&4096&&(i.mirror_webcam=s[12]),a&67108864&&(i.$$scope={dirty:a,ctx:s}),!n&&a&1&&(n=!0,i.value=s[0],X(()=>n=!1)),e.$set(i)},i(s){r||(w(e.$$.fragment,s),r=!0)},o(s){A(e.$$.fragment,s),r=!1},d(s){T(e,s)}}}function Nn(t){let e,n;return e=new Ln({props:{value:t[0],label:t[7],show_label:t[8]}}),{c(){E(e.$$.fragment)},m(r,l){S(e,r,l),n=!0},p(r,l){const o={};l&1&&(o.value=r[0]),l&128&&(o.label=r[7]),l&256&&(o.show_label=r[8]),e.$set(o)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function Pn(t){let e,n;return e=new Zt({props:{type:"image"}}),{c(){E(e.$$.fragment)},m(r,l){S(e,r,l),n=!0},p:V,i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function Fn(t){let e,n,r,l,o,s;const a=[t[1]];let i={};for(let u=0;u<a.length;u+=1)i=Lt(i,a[u]);e=new Ut({props:i});const _=[Nn,Un],f=[];function g(u,m){return u[15]==="static"?0:1}return r=g(t),l=f[r]=_[r](t),{c(){E(e.$$.fragment),n=U(),l.c(),o=_e()},m(u,m){S(e,u,m),C(u,n,m),f[r].m(u,m),C(u,o,m),s=!0},p(u,m){const b=m&2?Nt(a,[Pt(u[1])]):{};e.$set(b);let I=r;r=g(u),r===I?f[r].p(u,m):(K(),A(f[I],1,1,()=>{f[I]=null}),$(),l=f[r],l?l.p(u,m):(l=f[r]=_[r](u),l.c()),w(l,1),l.m(o.parentNode,o))},i(u){s||(w(e.$$.fragment,u),w(l),s=!0)},o(u){A(e.$$.fragment,u),A(l),s=!1},d(u){T(e,u),u&&z(n),f[r].d(u),u&&z(o)}}}function Wn(t){let e,n;return e=new Ft({props:{visible:t[4],variant:t[15]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[16]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],style:{height:t[11].height,width:t[11].width},allow_overflow:!1,$$slots:{default:[Fn]},$$scope:{ctx:t}}}),{c(){E(e.$$.fragment)},m(r,l){S(e,r,l),n=!0},p(r,[l]){const o={};l&16&&(o.visible=r[4]),l&32801&&(o.variant=r[15]==="dynamic"&&r[0]===null&&r[5]==="upload"?"dashed":"solid"),l&65536&&(o.border_mode=r[16]?"focus":"base"),l&4&&(o.elem_id=r[2]),l&8&&(o.elem_classes=r[3]),l&2048&&(o.style={height:r[11].height,width:r[11].width}),l&67237859&&(o.$$scope={dirty:l,ctx:r}),e.$set(o)},i(r){n||(w(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){T(e,r)}}}function On(t,e,n){let{elem_id:r=""}=e,{elem_classes:l=[]}=e,{visible:o=!0}=e,{value:s=null}=e,{source:a="upload"}=e,{tool:i="editor"}=e,{label:_}=e,{show_label:f}=e,{streaming:g}=e,{pending:u}=e,{style:m={}}=e,{mirror_webcam:b}=e,{shape:I}=e,{brush_radius:D}=e,{loading_status:R}=e,{mode:q}=e;const ne=de();let ce;function M(p){s=p,n(0,s)}function k(p){ge.call(this,t,p)}function W(p){ge.call(this,t,p)}function N(p){ge.call(this,t,p)}function re(p){ge.call(this,t,p)}const fe=({detail:p})=>n(16,ce=p);function se(p){ge.call(this,t,p)}const le=({detail:p})=>{n(1,R=R||{}),n(1,R.status="error",R),n(1,R.message=p,R)};return t.$$set=p=>{"elem_id"in p&&n(2,r=p.elem_id),"elem_classes"in p&&n(3,l=p.elem_classes),"visible"in p&&n(4,o=p.visible),"value"in p&&n(0,s=p.value),"source"in p&&n(5,a=p.source),"tool"in p&&n(6,i=p.tool),"label"in p&&n(7,_=p.label),"show_label"in p&&n(8,f=p.show_label),"streaming"in p&&n(9,g=p.streaming),"pending"in p&&n(10,u=p.pending),"style"in p&&n(11,m=p.style),"mirror_webcam"in p&&n(12,b=p.mirror_webcam),"shape"in p&&n(13,I=p.shape),"brush_radius"in p&&n(14,D=p.brush_radius),"loading_status"in p&&n(1,R=p.loading_status),"mode"in p&&n(15,q=p.mode)},t.$$.update=()=>{t.$$.dirty&1&&n(0,s=s||null),t.$$.dirty&1&&ne("change")},[s,R,r,l,o,a,i,_,f,g,u,m,b,I,D,q,ce,M,k,W,N,re,fe,se,le]}class Hn extends ee{constructor(e){super(),te(this,e,On,Wn,Z,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,style:11,mirror_webcam:12,shape:13,brush_radius:14,loading_status:1,mode:15})}}var sr=Hn;const lr=["static","dynamic"],ir=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{sr as Component,ur as ExampleComponent,ir as document,lr as modes};
//# sourceMappingURL=index.d146665a.js.map
