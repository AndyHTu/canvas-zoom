import{S as re,i as ne,s as $,A as K,B as g,f as y,D as Y,E as X,p as C,a6 as Bt,F as P,K as V,q as de,b as L,w as vt,a3 as tt,ah as it,a5 as ot,C as Dt,O as W,I as H,L as Oe,ad as Rt,a2 as rt,G as U,ak as zt,o as p,k as ee,t as w,n as te,N as qt,r as St,V as we,ac as jt,x as ge,c as T,m as E,l as B,M as Pe,an as Lt,e as fe,j as Q,a as G,W as Ut,X as Nt,Y as Pt,Z as Ft,v as Ot,a7 as Wt,g as Ht,h as Yt}from"./index.31015beb.js";import{a as Xt}from"./Empty.svelte_svelte_type_style_lang.394bc408.js";import{B as Mt}from"./BlockLabel.83bf2d64.js";/* empty css                                                    */import{I as Fe}from"./Image.e71158de.js";import{C as Vt,i as Jt,U as Qt,W as Gt}from"./StaticImage.svelte_svelte_type_style_lang.f3438159.js";import{I as Ie,C as Zt,M as We}from"./ModifyUpload.d84e210c.js";import{C as Kt}from"./Copy.cc1be931.js";import{U as $t}from"./Upload.a4a03771.js";import{E as xt}from"./Empty.4fdfdbf6.js";import{D as er}from"./Download.cfcd2c1c.js";import"./Blocks.83d67d7d.js";import{U as tr}from"./UploadText.19b19134.js";import{E as bn}from"./Image.565d9ebf.js";import"./ModifyUpload.svelte_svelte_type_style_lang.e946db2d.js";function rr(t){let e,r,n;return{c(){e=K("svg"),r=K("path"),n=K("path"),g(r,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),g(r,"fill","currentColor"),g(n,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),g(n,"fill","currentColor"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 32 32")},m(l,o){y(l,e,o),Y(e,r),Y(e,n)},p:X,i:X,o:X,d(l){l&&C(e)}}}class nr extends re{constructor(e){super(),ne(this,e,null,rr,$,{})}}function sr(t){let e,r,n,l,o,s,u;return{c(){e=K("svg"),r=K("circle"),n=K("circle"),l=K("circle"),o=K("circle"),s=K("circle"),u=K("path"),g(r,"cx","10"),g(r,"cy","12"),g(r,"r","2"),g(r,"fill","currentColor"),g(n,"cx","16"),g(n,"cy","9"),g(n,"r","2"),g(n,"fill","currentColor"),g(l,"cx","22"),g(l,"cy","12"),g(l,"r","2"),g(l,"fill","currentColor"),g(o,"cx","23"),g(o,"cy","18"),g(o,"r","2"),g(o,"fill","currentColor"),g(s,"cx","19"),g(s,"cy","23"),g(s,"r","2"),g(s,"fill","currentColor"),g(u,"fill","currentColor"),g(u,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 32 32")},m(i,c){y(i,e,c),Y(e,r),Y(e,n),Y(e,l),Y(e,o),Y(e,s),Y(e,u)},p:X,i:X,o:X,d(i){i&&C(e)}}}class lr extends re{constructor(e){super(),ne(this,e,null,sr,$,{})}}function ir(t){let e,r;return{c(){e=K("svg"),r=K("path"),g(r,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 24 24"),g(e,"fill","none"),g(e,"stroke","currentColor"),g(e,"stroke-width","1.5"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),g(e,"class","feather feather-edit-2")},m(n,l){y(n,e,l),Y(e,r)},p:X,i:X,o:X,d(n){n&&C(e)}}}class ut extends re{constructor(e){super(),ne(this,e,null,ir,$,{})}}function or(t){let e,r;return{c(){e=P("img"),V(e.src,r=t[0])||g(e,"src",r),g(e,"alt","")},m(n,l){y(n,e,l),t[4](e)},p(n,[l]){l&1&&!V(e.src,r=n[0])&&g(e,"src",r)},i:X,o:X,d(n){n&&C(e),t[4](null)}}}function ur(t,e,r){let{image:n}=e,l;const o=de();let s;function u(){s.destroy()}function i(){s&&u(),s=new Vt(l,{autoCropArea:1,cropend(){const _=s.getCroppedCanvas().toDataURL();o("crop",_)}}),o("crop",n)}function c(_){L[_?"unshift":"push"](()=>{l=_,r(1,l)})}return t.$$set=_=>{"image"in _&&r(0,n=_.image)},[n,l,u,i,c]}class Tt extends re{constructor(e){super(),ne(this,e,ur,or,$,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),Bt()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class at{constructor(e,r){this.x=e,this.y=r}}class ft extends at{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,r){const n=e+Math.PI/2;this.x=this.x+Math.sin(n)*r,this.y=this.y-Math.cos(n)*r}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new at(this.x-e.x,this.y-e.y)}getDistanceTo(e){const r=this.getDifferenceTo(e);return Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))}getAngleTo(e){const r=this.getDifferenceTo(e);return Math.atan2(r.y,r.x)}toObject(){return{x:this.x,y:this.y}}}const ar=30;class fr{constructor({radius:e=ar,enabled:r=!0,initialPoint:n={x:0,y:0}}={}){this.radius=e,this._isEnabled=r,this.pointer=new ft(n.x,n.y),this.brush=new ft(n.x,n.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:r=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!r?!1:(this.pointer.update(e),r?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}const Et=vt("#000000");function _t(t,e,r){const n=t.slice();return n[67]=e[r].name,n[68]=e[r].zIndex,n[69]=e,n[70]=r,n}function ct(t){let e,r,n;return{c(){e=P("div"),e.textContent="Start drawing",g(e,"class","start-prompt svelte-1g1hqr7")},m(l,o){y(l,e,o),n=!0},i(l){n||(tt(()=>{r||(r=it(e,ot,{duration:50},!0)),r.run(1)}),n=!0)},o(l){r||(r=it(e,ot,{duration:50},!1)),r.run(0),n=!1},d(l){l&&C(e),l&&r&&r.end()}}}function ht(t){let e,r,n=t[67],l,o;const s=()=>t[32](e,n),u=()=>t[32](null,n);return{c(){e=P("canvas"),g(e,"key",r=t[67]),Dt(e,"z-index",t[68]),g(e,"class","svelte-1g1hqr7"),W(e,"lr",t[7]),W(e,"tb",!t[7])},m(i,c){y(i,e,c),s(),l||(o=[H(e,"mousedown",t[67]==="interface"?t[9]:void 0),H(e,"mousemove",t[67]==="interface"?t[10]:void 0),H(e,"mouseup",t[67]==="interface"?t[11]:void 0),H(e,"mouseout",t[67]==="interface"?t[11]:void 0),H(e,"mouseout",function(){Oe(t[67]==="interface"?t[33]:void 0)&&(t[67]==="interface"?t[33]:void 0).apply(this,arguments)}),H(e,"blur",t[67]==="interface"?t[11]:void 0),H(e,"touchstart",t[67]==="interface"?t[9]:void 0),H(e,"touchmove",t[67]==="interface"?t[10]:void 0),H(e,"touchend",t[67]==="interface"?t[11]:void 0),H(e,"touchcancel",t[67]==="interface"?t[11]:void 0),H(e,"click",Rt(t[31]))],l=!0)},p(i,c){t=i,n!==t[67]&&(u(),n=t[67],s()),c[0]&128&&W(e,"lr",t[7]),c[0]&128&&W(e,"tb",!t[7])},d(i){i&&C(e),u(),l=!1,rt(o)}}}function _r(t){let e,r,n,l,o=t[6]===0&&ct(),s=t[8],u=[];for(let i=0;i<s.length;i+=1)u[i]=ht(_t(t,s,i));return{c(){e=P("div"),o&&o.c(),r=U();for(let i=0;i<u.length;i+=1)u[i].c();g(e,"class","wrap svelte-1g1hqr7"),tt(()=>t[35].call(e))},m(i,c){y(i,e,c),o&&o.m(e,null),Y(e,r);for(let _=0;_<u.length;_+=1)u[_].m(e,null);t[34](e),n=zt(e,t[35].bind(e)),l=!0},p(i,c){if(i[6]===0?o?c[0]&64&&p(o,1):(o=ct(),o.c(),p(o,1),o.m(e,r)):o&&(ee(),w(o,1,1,()=>{o=null}),te()),c[0]&3975){s=i[8];let _;for(_=0;_<s.length;_+=1){const m=_t(i,s,_);u[_]?u[_].p(m,c):(u[_]=ht(m),u[_].c(),u[_].m(e,null))}for(;_<u.length;_+=1)u[_].d(1);u.length=s.length}},i(i){l||(p(o),l=!0)},o(i){w(o),l=!1},d(i){i&&C(e),o&&o.d(),qt(u,i),t[34](null),n()}}}let cr="#aaa";function mt(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function hr(t){const e=mr(t);if(e){const{r,g:n,b:l}=e;return(r*299+n*587+l*114)/1e3}return 0}function mr(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function gr(t){const[e,r,n]=t.match(/\d+/g).map(Number);function l(o){const s=o.toString(16);return s.length===1?`0${s}`:s}return`#${l(e)}${l(r)}${l(n)}`}function dr(t,e,r){let n;const l=de();let{value:o}=e,{value_img:s}=e,{mode:u="sketch"}=e,{brush_color:i="#0b0f19"}=e,{brush_radius:c}=e,{source:_}=e,{width:m=400}=e,{height:f=200}=e,{container_height:h=200}=e,{shape:d}=e,A=localStorage.setItem("colorPickerEnable",!1),q=0,R=0,v,se=m,le=f,ie;const be=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let S={},b={},J=[],F=[],oe=!0,ue=!0,k=!1,O=!1,N=null,x=null,_e=null,Z=0;function ce(){if(!d){b.temp.drawImage(s,0,0,m,f);return}let a=s.naturalWidth,I=s.naturalHeight;const M=d[0]/d[1],z=a/I;let D=0,j=0;M<z?(a=d[1]*z,I=d[1],D=(d[0]-a)/2):M>z?(a=d[0],I=d[0]/z,j=(d[1]-I)/2):(D=0,j=0,a=d[0],I=d[1]),b.temp.drawImage(s,D,j,a,I)}St(async()=>{Object.keys(S).forEach(a=>{r(28,b[a]=S[a].getContext("2d"),b)}),await we(),s&&(s.addEventListener("load",a=>{_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):ce(),b.drawing.drawImage(S.temp,0,0,m,f),ae()}),setTimeout(()=>{_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):ce(),b.drawing.drawImage(S.temp,0,0,m,f),pe({lines:F.slice()}),ae()},100)),r(30,N=new fr({radius:c*.05,enabled:!0,initialPoint:{x:m/2,y:f/2}})),_e=new Jt((a,I,...M)=>{De(a,I)}),_e.observe(x),Ce(),r(26,v=!0),requestAnimationFrame(()=>{Se(),requestAnimationFrame(()=>{me()})})});function Se(){const a=m/2,I=f/2;N.update({x:a,y:I},{both:!0}),N.update({x:a,y:I},{both:!1}),oe=!0,ue=!0}jt(()=>{r(26,v=!1),_e.unobserve(x)});function He(){const a=F.slice(0,-1);ye(),s&&(_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):ce(),(!F||!F.length)&&b.drawing.drawImage(S.temp,0,0,m,f)),pe({lines:a}),r(6,Z=a.length),F.length&&r(29,F=a),F.length==0&&l("clear"),ae()}function Ye(){ye(),s&&ce(),pe({lines:F}),r(6,Z=F.length),F.length==0&&l("clear"),ae()}let pe=({lines:a})=>{const I=i;a.forEach(M=>{let{points:z,brush_color:D,brush_radius:j}=M;Ae(u==="mask"?{points:z,brush_color:I,brush_radius:j}:{points:z,brush_color:D,brush_radius:j}),u==="mask"&&je({points:z,brush_color:I,brush_radius:j}),J=z}),Ue({brush_color:i,brush_radius:c}),u==="mask"&&Le()},Xe=a=>{a.preventDefault();const{x:I,y:M}=Re(a);if(a.button===0){if(A=localStorage.getItem("colorPickerEnable")==="true",A&&u!=="mask"){r(15,i=Qe(I,M));const z=gr(i);Et.set(z),localStorage.setItem("colorPickerEnable","false");return}O=!0,a.touches&&a.touches.length>0&&N.update({x:I,y:M},{both:!0}),qe(I,M),r(6,Z+=1)}},Me=a=>{a.preventDefault();const{x:I,y:M}=Re(a);r(1,q=I),r(2,R=M),qe(I,M)},Ve=a=>{a.preventDefault(),Me(a),k=!1,O=!1,Ue(),u==="mask"&&Le()},Te=0,Ee=0,Be=0,ve=!1,De=async()=>{if(d&&x){const M=x?.getBoundingClientRect(),z=d[0]/d[1],D=M.width/M.height;r(7,ve=z<D)}if(m===Te&&f===Ee&&Be===h)return;const a={width:m,height:f},I={height:h,width:h*(a.width/a.height)};await Promise.all([he(S.interface,a,I),he(S.drawing,a,I),he(S.temp,a,I),he(S.temp_fake,a,I),he(S.mask,a,I,!1)]),c||r(12,c=20*(a.width/I.width)),Ce({once:!0}),setTimeout(()=>{Ee=f,Te=m,Be=h},10),await we(),me()},he=async(a,I,M,z=!0)=>{if(!v)return;await we();const D=window.devicePixelRatio||1;a.width=I.width*(z?D:1),a.height=I.height*(z?D:1);const j=a.getContext("2d");z&&j.scale(D,D),a.style.width=`${M.width}px`,a.style.height=`${M.height}px`},Re=a=>{const I=S.interface.getBoundingClientRect();let M=a.clientX,z=a.clientY;return a.changedTouches&&a.changedTouches.length>0&&(M=a.changedTouches[0].clientX,z=a.changedTouches[0].clientY),{x:(M-I.left)/I.width*m,y:(z-I.top)/I.height*f}};function Je(){if(A=localStorage.getItem("colorPickerEnable")==="true",A&&u!=="mask")for(const a in S)r(0,S[a].style.cursor="crosshair",S);else for(const a in S)r(0,S[a].style.cursor="none",S)}let qe=(a,I)=>{if(A=localStorage.getItem("colorPickerEnable")==="true",Je(),A&&u!=="mask")return;N.update({x:a,y:I});const M=!N.isEnabled();(O&&!k||M&&O)&&(k=!0,J.push(N.brush.toObject())),k&&(J.push(N.brush.toObject()),Ae({points:J,brush_color:i,brush_radius:c}),u==="mask"&&je({points:J,brush_color:i,brush_radius:c})),oe=!0},Ae=({points:a,brush_color:I,brush_radius:M})=>{if(!a||a.length<2||(r(28,b.temp.lineJoin="round",b),r(28,b.temp.lineCap="round",b),r(28,b.temp.strokeStyle=I,b),r(28,b.temp.lineWidth=M,b),!a||a.length<2))return;let z=a[0],D=a[1];b.temp.moveTo(D.x,D.y),b.temp.beginPath();for(var j=1,ke=a.length;j<ke;j++){var ze=mt(z,D);b.temp.quadraticCurveTo(z.x,z.y,ze.x,ze.y),z=a[j],D=a[j+1]}b.temp.lineTo(z.x,z.y),b.temp.stroke()},je=({points:a,brush_color:I,brush_radius:M})=>{if(!a||a.length<2)return;r(28,b.temp_fake.lineJoin="round",b),r(28,b.temp_fake.lineCap="round",b),r(28,b.temp_fake.strokeStyle="#fff",b),r(28,b.temp_fake.lineWidth=M,b);let z=a[0],D=a[1];b.temp_fake.moveTo(D.x,D.y),b.temp_fake.beginPath();for(var j=1,ke=a.length;j<ke;j++){var ze=mt(z,D);b.temp_fake.quadraticCurveTo(z.x,z.y,ze.x,ze.y),z=a[j],D=a[j+1]}b.temp_fake.lineTo(z.x,z.y),b.temp_fake.stroke()};function Qe(a,I){const M=b.drawing.getImageData(a,I,1,1),[z,D,j,ke]=M.data;return`rgb(${z}, ${D}, ${j})`}let Le=()=>{J.length<1||(J.length=0,b.mask.drawImage(S.temp_fake,0,0,m,f),ae())},Ue=()=>{J.length<1||(F.push({points:J.slice(),brush_color:i,brush_radius:c}),u!=="mask"&&(J.length=0),b.drawing.drawImage(S.temp,0,0,m,f),ae())},ae=()=>{const a=Ne();l("change",a)};function me(){return r(29,F=[]),ye(),r(6,Z=0),!0}function ye(){ue=!0,b.temp.clearRect(0,0,m,f),r(28,b.temp.fillStyle=u==="mask"?"transparent":"#FFFFFF",b),b.temp.fillRect(0,0,m,f),u==="mask"&&(b.temp_fake.clearRect(0,0,S.temp_fake.width,S.temp_fake.height),b.mask.clearRect(0,0,m,f),r(28,b.mask.fillStyle="#000",b),b.mask.fillRect(0,0,m,f))}let Ce=({once:a=!1}={})=>{if(oe||ue){const I=N.getPointerCoordinates(),M=N.getBrushCoordinates();Ge(b.interface,I,M),oe=!1,ue=!1}a||window.requestAnimationFrame(()=>{Ce()})},Ge=(a,I,M)=>{a.clearRect(0,0,m,f);let z=M.x,D=M.y;q&&R&&(z=q,D=R),a.beginPath(),a.fillStyle=i;const j=localStorage.getItem("brushOutline")==="true";if(j){const ke=hr(i);a.strokeStyle=ke>128?"black":"white",a.lineWidth=2}a.arc(z,D,c/2,0,Math.PI*2,!0),a.fill(),j&&a.stroke(),a.beginPath(),a.fillStyle=cr,a.arc(z,D,n,0,Math.PI*2,!0),a.fill()};function Ne(){return u==="mask"?S.mask.toDataURL("image/jpg"):S.drawing.toDataURL("image/jpg")}function Ze(a){ge.call(this,t,a)}function Ke(a,I){L[a?"unshift":"push"](()=>{S[I]=a,r(0,S)})}const $e=()=>{r(1,q=r(2,R=0))};function xe(a){L[a?"unshift":"push"](()=>{x=a,r(5,x)})}function et(){se=this.offsetWidth,le=this.offsetHeight,r(3,se),r(4,le)}return t.$$set=a=>{"value"in a&&r(16,o=a.value),"value_img"in a&&r(17,s=a.value_img),"mode"in a&&r(18,u=a.mode),"brush_color"in a&&r(15,i=a.brush_color),"brush_radius"in a&&r(12,c=a.brush_radius),"source"in a&&r(19,_=a.source),"width"in a&&r(13,m=a.width),"height"in a&&r(14,f=a.height),"container_height"in a&&r(20,h=a.container_height),"shape"in a&&r(21,d=a.shape)},t.$$.update=()=>{t.$$.dirty[0]&2121728&&d&&(m||f)&&(r(13,m=d[0]),r(14,f=d[1])),t.$$.dirty[0]&67174400&&v&&!o&&me(),t.$$.dirty[0]&1007312897&&v&&s!==ie&&(r(27,ie=s),me(),setTimeout(()=>{_==="webcam"?(b.temp.save(),b.temp.translate(m,0),b.temp.scale(-1,1),b.temp.drawImage(s,0,0),b.temp.restore()):ce(),b.drawing.drawImage(S.temp,0,0,m,f),pe({lines:F.slice()}),ae()},50)),t.$$.dirty[0]&1073745920&&N&&(Se(),N.setRadius(c*.05)),t.$$.dirty[0]&24576&&(m||f)&&De(),t.$$.dirty[0]&4096&&(n=c*.075)},[S,q,R,se,le,x,Z,ve,be,Xe,Me,Ve,c,m,f,i,o,s,u,_,h,d,He,Ye,me,Ne,v,ie,b,F,N,Ze,Ke,$e,xe,et]}class nt extends re{constructor(e){super(),ne(this,e,dr,_r,$,{value:16,value_img:17,mode:18,brush_color:15,brush_radius:12,source:19,width:13,height:14,container_height:20,shape:21,undo:22,redraw:23,clear:24,get_image_data:25},null,[-1,-1,-1])}get undo(){return this.$$.ctx[22]}get redraw(){return this.$$.ctx[23]}get clear(){return this.$$.ctx[24]}get get_image_data(){return this.$$.ctx[25]}}function br(t){let e,r,n,l,o,s,u;return r=new Ie({props:{Icon:Qt,label:"Undo"}}),r.$on("click",t[1]),l=new Ie({props:{Icon:Kt,label:"Redraw"}}),l.$on("click",t[2]),s=new Ie({props:{Icon:Zt,label:"Clear"}}),s.$on("click",t[3]),{c(){e=P("div"),T(r.$$.fragment),n=U(),T(l.$$.fragment),o=U(),T(s.$$.fragment),g(e,"class","svelte-17iq5p5")},m(i,c){y(i,e,c),E(r,e,null),Y(e,n),E(l,e,null),Y(e,o),E(s,e,null),u=!0},p:X,i(i){u||(p(r.$$.fragment,i),p(l.$$.fragment,i),p(s.$$.fragment,i),u=!0)},o(i){w(r.$$.fragment,i),w(l.$$.fragment,i),w(s.$$.fragment,i),u=!1},d(i){i&&C(e),B(r),B(l),B(s)}}}function pr(t){const e=de();return[e,()=>e("undo"),()=>e("redraw"),o=>{e("clear"),o.stopPropagation()}]}class st extends re{constructor(e){super(),ne(this,e,pr,br,$,{})}}function gt(t){let e,r,n,l,o;return{c(){e=P("input"),g(e,"aria-label","Brush radius"),g(e,"type","range"),g(e,"min",r=.5*(t[2]/t[6])),g(e,"max",n=75*(t[2]/t[6])),g(e,"class","svelte-p4aq0j")},m(s,u){y(s,e,u),Pe(e,t[0]),l||(o=[H(e,"change",t[11]),H(e,"input",t[11])],l=!0)},p(s,u){u&68&&r!==(r=.5*(s[2]/s[6]))&&g(e,"min",r),u&68&&n!==(n=75*(s[2]/s[6]))&&g(e,"max",n),u&1&&Pe(e,s[0])},d(s){s&&C(e),l=!1,rt(o)}}}function kr(t){let e,r,n,l;r=new Ie({props:{Icon:lr,label:"Select brush color"}}),r.$on("click",t[12]);let o=t[5]&&dt(t);return{c(){e=P("span"),T(r.$$.fragment),n=U(),o&&o.c(),g(e,"class","col svelte-p4aq0j")},m(s,u){y(s,e,u),E(r,e,null),Y(e,n),o&&o.m(e,null),l=!0},p(s,u){s[5]?o?o.p(s,u):(o=dt(s),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(s){l||(p(r.$$.fragment,s),l=!0)},o(s){w(r.$$.fragment,s),l=!1},d(s){s&&C(e),B(r),o&&o.d()}}}function dt(t){let e,r,n;return{c(){e=P("input"),g(e,"aria-label","Brush color"),g(e,"type","color"),g(e,"class","svelte-p4aq0j")},m(l,o){y(l,e,o),Pe(e,t[1]),r||(n=[H(e,"change",t[13]),H(e,"input",t[14])],r=!0)},p(l,o){o&2&&Pe(e,l[1])},d(l){l&&C(e),r=!1,rt(n)}}}function wr(t){let e,r,n,l,o,s;n=new Ie({props:{Icon:nr,label:"Use brush"}}),n.$on("click",t[10]);let u=t[4]&&gt(t),i=kr(t);return{c(){e=P("div"),r=P("span"),T(n.$$.fragment),l=U(),u&&u.c(),o=U(),i&&i.c(),g(r,"class","brush svelte-p4aq0j"),g(e,"class","wrap svelte-p4aq0j")},m(c,_){y(c,e,_),Y(e,r),E(n,r,null),Y(r,l),u&&u.m(r,null),Y(e,o),i&&i.m(e,null),s=!0},p(c,[_]){c[4]?u?u.p(c,_):(u=gt(c),u.c(),u.m(r,null)):u&&(u.d(1),u=null),i.p(c,_)},i(c){s||(p(n.$$.fragment,c),p(i),s=!0)},o(c){w(n.$$.fragment,c),w(i),s=!1},d(c){c&&C(e),B(n),u&&u.d(),i&&i.d()}}}function Ir(t,e,r){let n;const l=de();let o=!1,s=!1,{brush_radius:u=20}=e,{container_height:i}=e,{img_width:c}=e,{img_height:_}=e,{mode:m="other"}=e,{brush_color:f="#000"}=e;Et.subscribe(v=>{r(1,f=v)});const h=()=>r(4,o=!o);function d(){u=Lt(this.value),r(0,u)}const A=()=>r(5,s=!s),q=()=>{m==="mask"&&l("redraw")};function R(){f=this.value,r(1,f)}return t.$$set=v=>{"brush_radius"in v&&r(0,u=v.brush_radius),"container_height"in v&&r(8,i=v.container_height),"img_width"in v&&r(2,c=v.img_width),"img_height"in v&&r(9,_=v.img_height),"mode"in v&&r(3,m=v.mode),"brush_color"in v&&r(1,f=v.brush_color)},t.$$.update=()=>{t.$$.dirty&772&&r(6,n=i*(c/_))},[u,f,c,m,o,s,n,l,i,_,h,d,A,q,R]}class lt extends re{constructor(e){super(),ne(this,e,Ir,wr,$,{brush_radius:0,container_height:8,img_width:2,img_height:9,mode:3,brush_color:1})}}function Ar(t){let e,r;return{c(){e=P("img"),V(e.src,r=t[0].image||t[0])||g(e,"src",r),g(e,"alt",""),g(e,"class","svelte-rlgzoo"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(n,l){y(n,e,l)},p(n,l){l[0]&1&&!V(e.src,r=n[0].image||n[0])&&g(e,"src",r),l[0]&544&&W(e,"webcam",n[5]==="webcam"&&n[9])},i:X,o:X,d(n){n&&C(e)}}}function yr(t){let e=t[22],r,n,l,o=bt(t),s=t[17]>0&&pt(t);return{c(){o.c(),r=U(),s&&s.c(),n=fe()},m(u,i){o.m(u,i),y(u,r,i),s&&s.m(u,i),y(u,n,i),l=!0},p(u,i){i[0]&4194304&&$(e,e=u[22])?(o.d(1),o=bt(u),o.c(),o.m(r.parentNode,r)):o.p(u,i),u[17]>0?s?(s.p(u,i),i[0]&131072&&p(s,1)):(s=pt(u),s.c(),p(s,1),s.m(n.parentNode,n)):s&&(ee(),w(s,1,1,()=>{s=null}),te())},i(u){l||(p(s),l=!0)},o(u){w(s),l=!1},d(u){o.d(u),u&&C(r),s&&s.d(u),u&&C(n)}}}function Cr(t){let e,r,n,l,o;return e=new We({props:{editable:!0}}),e.$on("edit",t[53]),e.$on("clear",t[25]),{c(){T(e.$$.fragment),r=U(),n=P("img"),V(n.src,l=t[0])||g(n,"src",l),g(n,"alt",""),g(n,"class","svelte-rlgzoo"),W(n,"webcam",t[5]==="webcam"&&t[9])},m(s,u){E(e,s,u),y(s,r,u),y(s,n,u),o=!0},p(s,u){(!o||u[0]&1&&!V(n.src,l=s[0]))&&g(n,"src",l),u[0]&544&&W(n,"webcam",s[5]==="webcam"&&s[9])},i(s){o||(p(e.$$.fragment,s),o=!0)},o(s){w(e.$$.fragment,s),o=!1},d(s){B(e,s),s&&C(r),s&&C(n)}}}function zr(t){let e,r,n,l,o={image:t[0]};return e=new Tt({props:o}),t[51](e),e.$on("crop",t[26]),n=new We({}),n.$on("clear",t[52]),{c(){T(e.$$.fragment),r=U(),T(n.$$.fragment)},m(s,u){E(e,s,u),y(s,r,u),E(n,s,u),l=!0},p(s,u){const i={};u[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(p(e.$$.fragment,s),p(n.$$.fragment,s),l=!0)},o(s){w(e.$$.fragment,s),w(n.$$.fragment,s),l=!1},d(s){t[51](null),B(e,s),s&&C(r),B(n,s)}}}function Sr(t){let e,r,n=t[5]==="webcam"&&!t[22]&&wt(t);return{c(){n&&n.c(),e=fe()},m(l,o){n&&n.m(l,o),y(l,e,o),r=!0},p(l,o){l[5]==="webcam"&&!l[22]?n?(n.p(l,o),o[0]&4194336&&p(n,1)):(n=wt(l),n.c(),p(n,1),n.m(e.parentNode,e)):n&&(ee(),w(n,1,1,()=>{n=null}),te())},i(l){r||(p(n),r=!0)},o(l){w(n),r=!1},d(l){n&&n.d(l),l&&C(e)}}}function Mr(t){let e,r,n,l,o,s,u;e=new st({}),e.$on("undo",t[42]),e.$on("redraw",t[43]),e.$on("clear",t[28]);let i=t[1]==="color-sketch"&&It(t);function c(f){t[46](f)}function _(f){t[47](f)}let m={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],shape:t[6]};return t[2]!==void 0&&(m.brush_radius=t[2]),t[23]!==void 0&&(m.brush_color=t[23]),l=new nt({props:m}),L.push(()=>G(l,"brush_radius",c)),L.push(()=>G(l,"brush_color",_)),t[48](l),l.$on("change",t[26]),l.$on("clear",t[28]),{c(){T(e.$$.fragment),r=U(),i&&i.c(),n=U(),T(l.$$.fragment)},m(f,h){E(e,f,h),y(f,r,h),i&&i.m(f,h),y(f,n,h),E(l,f,h),u=!0},p(f,h){f[1]==="color-sketch"?i?(i.p(f,h),h[0]&2&&p(i,1)):(i=It(f),i.c(),p(i,1),i.m(n.parentNode,n)):i&&(ee(),w(i,1,1,()=>{i=null}),te());const d={};h[0]&1&&(d.value=f[0]),h[0]&4096&&(d.mode=f[12]),h[0]&2228224&&(d.width=f[17]||f[21]),h[0]&1114112&&(d.height=f[16]||f[20]),h[0]&1310720&&(d.container_height=f[18]||f[20]),h[0]&64&&(d.shape=f[6]),!o&&h[0]&4&&(o=!0,d.brush_radius=f[2],Q(()=>o=!1)),!s&&h[0]&8388608&&(s=!0,d.brush_color=f[23],Q(()=>s=!1)),l.$set(d)},i(f){u||(p(e.$$.fragment,f),p(i),p(l.$$.fragment,f),u=!0)},o(f){w(e.$$.fragment,f),w(i),w(l.$$.fragment,f),u=!1},d(f){B(e,f),f&&C(r),i&&i.d(f),f&&C(n),t[48](null),B(l,f)}}}function Tr(t){let e,r,n;function l(s){t[41](s)}let o={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[qr]},$$scope:{ctx:t}};return t[11]!==void 0&&(o.dragging=t[11]),e=new $t({props:o}),L.push(()=>G(e,"dragging",l)),e.$on("load",t[24]),{c(){T(e.$$.fragment)},m(s,u){E(e,s,u),n=!0},p(s,u){const i={};u[0]&1&&(i.disable_click=!!s[0]),u[0]&16774887|u[2]&2&&(i.$$scope={dirty:u,ctx:s}),!r&&u[0]&2048&&(r=!0,i.dragging=s[11],Q(()=>r=!1)),e.$set(i)},i(s){n||(p(e.$$.fragment,s),n=!0)},o(s){w(e.$$.fragment,s),n=!1},d(s){B(e,s)}}}function bt(t){let e,r,n,l;return{c(){e=P("img"),g(e,"class","absolute-img svelte-rlgzoo"),V(e.src,r=t[22]||t[0]?.image||t[0])||g(e,"src",r),g(e,"alt","load-1"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){y(o,e,s),t[54](e),n||(l=H(e,"load",t[27]),n=!0)},p(o,s){s[0]&4194305&&!V(e.src,r=o[22]||o[0]?.image||o[0])&&g(e,"src",r),s[0]&544&&W(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&C(e),t[54](null),n=!1,l()}}}function pt(t){let e,r,n,l,o,s,u,i;function c(h){t[56](h)}function _(h){t[57](h)}let m={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5]};t[2]!==void 0&&(m.brush_radius=t[2]),t[23]!==void 0&&(m.brush_color=t[23]),e=new nt({props:m}),t[55](e),L.push(()=>G(e,"brush_radius",c)),L.push(()=>G(e,"brush_color",_)),e.$on("change",t[26]),o=new st({}),o.$on("undo",t[58]),o.$on("redraw",t[59]),o.$on("clear",t[28]);let f=(t[1]==="color-sketch"||t[1]==="sketch")&&kt(t);return{c(){T(e.$$.fragment),l=U(),T(o.$$.fragment),s=U(),f&&f.c(),u=fe()},m(h,d){E(e,h,d),y(h,l,d),E(o,h,d),y(h,s,d),f&&f.m(h,d),y(h,u,d),i=!0},p(h,d){const A={};d[0]&1&&(A.value=h[0]),d[0]&4096&&(A.mode=h[12]),d[0]&2228224&&(A.width=h[17]||h[21]),d[0]&1114112&&(A.height=h[16]||h[20]),d[0]&1310720&&(A.container_height=h[18]||h[20]),d[0]&524288&&(A.value_img=h[19]),d[0]&32&&(A.source=h[5]),!r&&d[0]&4&&(r=!0,A.brush_radius=h[2],Q(()=>r=!1)),!n&&d[0]&8388608&&(n=!0,A.brush_color=h[23],Q(()=>n=!1)),e.$set(A),h[1]==="color-sketch"||h[1]==="sketch"?f?(f.p(h,d),d[0]&2&&p(f,1)):(f=kt(h),f.c(),p(f,1),f.m(u.parentNode,u)):f&&(ee(),w(f,1,1,()=>{f=null}),te())},i(h){i||(p(e.$$.fragment,h),p(o.$$.fragment,h),p(f),i=!0)},o(h){w(e.$$.fragment,h),w(o.$$.fragment,h),w(f),i=!1},d(h){t[55](null),B(e,h),h&&C(l),B(o,h),h&&C(s),f&&f.d(h),h&&C(u)}}}function kt(t){let e,r,n,l;function o(i){t[60](i)}function s(i){t[61](i)}let u={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(u.brush_radius=t[2]),t[23]!==void 0&&(u.brush_color=t[23]),e=new lt({props:u}),L.push(()=>G(e,"brush_radius",o)),L.push(()=>G(e,"brush_color",s)),{c(){T(e.$$.fragment)},m(i,c){E(e,i,c),l=!0},p(i,c){const _={};c[0]&1310720&&(_.container_height=i[18]||i[20]),c[0]&2228224&&(_.img_width=i[17]||i[21]),c[0]&1114112&&(_.img_height=i[16]||i[20]),c[0]&4096&&(_.mode=i[12]),!r&&c[0]&4&&(r=!0,_.brush_radius=i[2],Q(()=>r=!1)),!n&&c[0]&8388608&&(n=!0,_.brush_color=i[23],Q(()=>n=!1)),e.$set(_)},i(i){l||(p(e.$$.fragment,i),l=!0)},o(i){w(e.$$.fragment,i),l=!1},d(i){B(e,i)}}}function wt(t){let e,r;return e=new Gt({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[49]),e.$on("stream",t[26]),e.$on("error",t[50]),{c(){T(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,l){const o={};l[0]&128&&(o.streaming=n[7]),l[0]&256&&(o.pending=n[8]),l[0]&512&&(o.mirror_webcam=n[9]),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){B(e,n)}}}function It(t){let e,r,n,l;function o(i){t[44](i)}function s(i){t[45](i)}let u={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20]};return t[2]!==void 0&&(u.brush_radius=t[2]),t[23]!==void 0&&(u.brush_color=t[23]),e=new lt({props:u}),L.push(()=>G(e,"brush_radius",o)),L.push(()=>G(e,"brush_color",s)),e.$on("redraw",function(){Oe(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){T(e.$$.fragment)},m(i,c){E(e,i,c),l=!0},p(i,c){t=i;const _={};c[0]&1310720&&(_.container_height=t[18]||t[20]),c[0]&2228224&&(_.img_width=t[17]||t[21]),c[0]&1114112&&(_.img_height=t[16]||t[20]),!r&&c[0]&4&&(r=!0,_.brush_radius=t[2],Q(()=>r=!1)),!n&&c[0]&8388608&&(n=!0,_.brush_color=t[23],Q(()=>n=!1)),e.$set(_)},i(i){l||(p(e.$$.fragment,i),l=!0)},o(i){w(e.$$.fragment,i),l=!1},d(i){B(e,i)}}}function Er(t){let e,r;return{c(){e=P("img"),V(e.src,r=t[0].image||t[0])||g(e,"src",r),g(e,"alt","hello"),g(e,"class","svelte-rlgzoo"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(n,l){y(n,e,l)},p(n,l){l[0]&1&&!V(e.src,r=n[0].image||n[0])&&g(e,"src",r),l[0]&544&&W(e,"webcam",n[5]==="webcam"&&n[9])},i:X,o:X,d(n){n&&C(e)}}}function Br(t){let e=t[22],r,n,l,o=At(t),s=t[17]>0&&yt(t);return{c(){o.c(),r=U(),s&&s.c(),n=fe()},m(u,i){o.m(u,i),y(u,r,i),s&&s.m(u,i),y(u,n,i),l=!0},p(u,i){i[0]&4194304&&$(e,e=u[22])?(o.d(1),o=At(u),o.c(),o.m(r.parentNode,r)):o.p(u,i),u[17]>0?s?(s.p(u,i),i[0]&131072&&p(s,1)):(s=yt(u),s.c(),p(s,1),s.m(n.parentNode,n)):s&&(ee(),w(s,1,1,()=>{s=null}),te())},i(u){l||(p(s),l=!0)},o(u){w(s),l=!1},d(u){o.d(u),u&&C(r),s&&s.d(u),u&&C(n)}}}function vr(t){let e,r,n,l,o;return e=new We({props:{editable:!0}}),e.$on("edit",t[32]),e.$on("clear",t[25]),{c(){T(e.$$.fragment),r=U(),n=P("img"),V(n.src,l=t[0])||g(n,"src",l),g(n,"alt",""),g(n,"class","svelte-rlgzoo"),W(n,"scale-x-[-1]",t[5]==="webcam"&&t[9])},m(s,u){E(e,s,u),y(s,r,u),y(s,n,u),o=!0},p(s,u){(!o||u[0]&1&&!V(n.src,l=s[0]))&&g(n,"src",l),u[0]&544&&W(n,"scale-x-[-1]",s[5]==="webcam"&&s[9])},i(s){o||(p(e.$$.fragment,s),o=!0)},o(s){w(e.$$.fragment,s),o=!1},d(s){B(e,s),s&&C(r),s&&C(n)}}}function Dr(t){let e,r,n,l,o={image:t[0]};return e=new Tt({props:o}),t[30](e),e.$on("crop",t[26]),n=new We({}),n.$on("clear",t[31]),{c(){T(e.$$.fragment),r=U(),T(n.$$.fragment)},m(s,u){E(e,s,u),y(s,r,u),E(n,s,u),l=!0},p(s,u){const i={};u[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(p(e.$$.fragment,s),p(n.$$.fragment,s),l=!0)},o(s){w(e.$$.fragment,s),w(n.$$.fragment,s),l=!1},d(s){t[30](null),B(e,s),s&&C(r),B(n,s)}}}function Rr(t){let e;const r=t[29].default,n=Ut(r,t,t[63],null);return{c(){n&&n.c()},m(l,o){n&&n.m(l,o),e=!0},p(l,o){n&&n.p&&(!e||o[2]&2)&&Nt(n,r,l,l[63],e?Ft(r,l[63],o,null):Pt(l[63]),null)},i(l){e||(p(n,l),e=!0)},o(l){w(n,l),e=!1},d(l){n&&n.d(l)}}}function At(t){let e,r,n,l;return{c(){e=P("img"),g(e,"class","absolute-img svelte-rlgzoo"),V(e.src,r=t[22]||t[0].image||t[0])||g(e,"src",r),g(e,"data-source",t[14]),g(e,"data-isupload",t[15]),g(e,"alt","load-2"),W(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){y(o,e,s),t[33](e),n||(l=H(e,"load",t[27]),n=!0)},p(o,s){s[0]&4194305&&!V(e.src,r=o[22]||o[0].image||o[0])&&g(e,"src",r),s[0]&16384&&g(e,"data-source",o[14]),s[0]&32768&&g(e,"data-isupload",o[15]),s[0]&544&&W(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&C(e),t[33](null),n=!1,l()}}}function yt(t){let e,r,n,l,o,s,u,i;function c(h){t[35](h)}function _(h){t[36](h)}let m={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5],shape:t[6]};t[2]!==void 0&&(m.brush_radius=t[2]),t[23]!==void 0&&(m.brush_color=t[23]),e=new nt({props:m}),t[34](e),L.push(()=>G(e,"brush_radius",c)),L.push(()=>G(e,"brush_color",_)),e.$on("change",t[26]),e.$on("redraw",function(){Oe(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),o=new st({}),o.$on("undo",t[37]),o.$on("redraw",t[38]),o.$on("clear",t[28]);let f=(t[1]==="color-sketch"||t[1]==="sketch")&&Ct(t);return{c(){T(e.$$.fragment),l=U(),T(o.$$.fragment),s=U(),f&&f.c(),u=fe()},m(h,d){E(e,h,d),y(h,l,d),E(o,h,d),y(h,s,d),f&&f.m(h,d),y(h,u,d),i=!0},p(h,d){t=h;const A={};d[0]&1&&(A.value=t[0]),d[0]&4096&&(A.mode=t[12]),d[0]&2228224&&(A.width=t[17]||t[21]),d[0]&1114112&&(A.height=t[16]||t[20]),d[0]&1310720&&(A.container_height=t[18]||t[20]),d[0]&524288&&(A.value_img=t[19]),d[0]&32&&(A.source=t[5]),d[0]&64&&(A.shape=t[6]),!r&&d[0]&4&&(r=!0,A.brush_radius=t[2],Q(()=>r=!1)),!n&&d[0]&8388608&&(n=!0,A.brush_color=t[23],Q(()=>n=!1)),e.$set(A),t[1]==="color-sketch"||t[1]==="sketch"?f?(f.p(t,d),d[0]&2&&p(f,1)):(f=Ct(t),f.c(),p(f,1),f.m(u.parentNode,u)):f&&(ee(),w(f,1,1,()=>{f=null}),te())},i(h){i||(p(e.$$.fragment,h),p(o.$$.fragment,h),p(f),i=!0)},o(h){w(e.$$.fragment,h),w(o.$$.fragment,h),w(f),i=!1},d(h){t[34](null),B(e,h),h&&C(l),B(o,h),h&&C(s),f&&f.d(h),h&&C(u)}}}function Ct(t){let e,r,n,l;function o(i){t[39](i)}function s(i){t[40](i)}let u={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(u.brush_radius=t[2]),t[23]!==void 0&&(u.brush_color=t[23]),e=new lt({props:u}),L.push(()=>G(e,"brush_radius",o)),L.push(()=>G(e,"brush_color",s)),e.$on("redraw",function(){Oe(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){T(e.$$.fragment)},m(i,c){E(e,i,c),l=!0},p(i,c){t=i;const _={};c[0]&1310720&&(_.container_height=t[18]||t[20]),c[0]&2228224&&(_.img_width=t[17]||t[21]),c[0]&1114112&&(_.img_height=t[16]||t[20]),c[0]&4096&&(_.mode=t[12]),!r&&c[0]&4&&(r=!0,_.brush_radius=t[2],Q(()=>r=!1)),!n&&c[0]&8388608&&(n=!0,_.brush_color=t[23],Q(()=>n=!1)),e.$set(_)},i(i){l||(p(e.$$.fragment,i),l=!0)},o(i){w(e.$$.fragment,i),l=!1},d(i){B(e,i)}}}function qr(t){let e,r,n,l;const o=[Rr,Dr,vr,Br,Er],s=[];function u(i,c){return i[0]===null&&!i[22]||i[7]?0:i[1]==="select"?1:i[1]==="editor"?2:(i[1]==="sketch"||i[1]==="color-sketch")&&(i[0]!==null||i[22])?3:4}return e=u(t),r=s[e]=o[e](t),{c(){r.c(),n=fe()},m(i,c){s[e].m(i,c),y(i,n,c),l=!0},p(i,c){let _=e;e=u(i),e===_?s[e].p(i,c):(ee(),w(s[_],1,1,()=>{s[_]=null}),te(),r=s[e],r?r.p(i,c):(r=s[e]=o[e](i),r.c()),p(r,1),r.m(n.parentNode,n))},i(i){l||(p(r),l=!0)},o(i){w(r),l=!1},d(i){s[e].d(i),i&&C(n)}}}function jr(t){let e,r,n,l,o,s,u;e=new Mt({props:{show_label:t[4],Icon:t[5]==="canvas"?ut:Fe,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const i=[Tr,Mr,Sr,zr,Cr,yr,Ar],c=[];function _(m,f){return m[5]==="upload"?0:m[5]==="canvas"?1:m[0]===null&&!m[22]||m[7]?2:m[1]==="select"?3:m[1]==="editor"?4:(m[1]==="sketch"||m[1]==="color-sketch")&&(m[0]!==null||m[22])?5:6}return l=_(t),o=c[l]=i[l](t),{c(){T(e.$$.fragment),r=U(),n=P("div"),o.c(),g(n,"data-testid","image"),g(n,"class","svelte-rlgzoo"),tt(()=>t[62].call(n)),W(n,"fixed-height",t[5]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(m,f){E(e,m,f),y(m,r,f),y(m,n,f),c[l].m(n,null),s=zt(n,t[62].bind(n)),u=!0},p(m,f){const h={};f[0]&16&&(h.show_label=m[4]),f[0]&32&&(h.Icon=m[5]==="canvas"?ut:Fe),f[0]&40&&(h.label=m[3]||(m[5]==="canvas"?"Sketch":"Image")),e.$set(h);let d=l;l=_(m),l===d?c[l].p(m,f):(ee(),w(c[d],1,1,()=>{c[d]=null}),te(),o=c[l],o?o.p(m,f):(o=c[l]=i[l](m),o.c()),p(o,1),o.m(n,null)),f[0]&34&&W(n,"fixed-height",m[5]!=="webcam"||m[1]==="sketch"||m[1]==="color-sketch")},i(m){u||(p(e.$$.fragment,m),p(o),u=!0)},o(m){w(e.$$.fragment,m),w(o),u=!1},d(m){B(e,m),m&&C(r),m&&C(n),c[l].d(),s()}}}function Lr(t,e,r){let n,{$$slots:l={},$$scope:o}=e,{value:s}=e,{label:u=void 0}=e,{show_label:i}=e,{source:c="upload"}=e,{tool:_="editor"}=e,{shape:m}=e,{streaming:f=!1}=e,{pending:h=!1}=e,{mirror_webcam:d}=e,{brush_radius:A}=e,q,R,v="",se=!1;s&&(c==="upload"||c==="webcam")&&_==="sketch"&&(s={image:s,mask:null});function le({detail:a}){_==="color-sketch"?r(22,Z=a):r(0,s=(c==="upload"||c==="webcam")&&_==="sketch"?{image:a,mask:null}:a),r(15,se=!0),console.log(1),S("upload",a)}function ie({detail:a}){r(0,s=null),r(22,Z=void 0),S("clear")}async function be({detail:a},I,M=!1){O==="mask"?c==="webcam"&&I?r(0,s={image:a,mask:null}):r(0,s={image:typeof s=="string"?s:s?.image||null,mask:a}):(c==="upload"||c==="webcam")&&_==="sketch"?r(0,s={image:a,mask:null}):(v===""&&r(14,v=a),r(0,s=a)),await we(),S(f?"stream":"edit")}const S=de();let b=!1;function J(a){const I=a.currentTarget;r(17,ue=I.naturalWidth),r(16,oe=I.naturalHeight),r(18,k=I.getBoundingClientRect().height)}async function F(){q.clear(),await we(),r(0,s=null),r(22,Z=void 0),r(14,v=""),r(15,se=!1)}let oe=0,ue=0,k=0,O,N,x,_e,Z;St(async()=>{_==="color-sketch"&&s&&typeof s=="string"&&(r(22,Z=s),await we(),J({currentTarget:N}))});function ce(a){L[a?"unshift":"push"](()=>{R=a,r(10,R),r(0,s)})}const Se=a=>(ie(a),r(1,_="editor")),He=()=>r(1,_="select");function Ye(a){L[a?"unshift":"push"](()=>{N=a,r(19,N)})}function pe(a){L[a?"unshift":"push"](()=>{q=a,r(13,q)})}function Xe(a){A=a,r(2,A)}function Me(a){n=a,r(23,n),r(12,O),r(5,c),r(1,_)}const Ve=()=>q.undo(),Te=()=>q.redraw();function Ee(a){A=a,r(2,A)}function Be(a){n=a,r(23,n),r(12,O),r(5,c),r(1,_)}function ve(a){b=a,r(11,b)}const De=()=>q.undo(),he=()=>q.redraw();function Re(a){A=a,r(2,A)}function Je(a){n=a,r(23,n),r(12,O),r(5,c),r(1,_)}function qe(a){A=a,r(2,A)}function Ae(a){n=a,r(23,n),r(12,O),r(5,c),r(1,_)}function je(a){L[a?"unshift":"push"](()=>{q=a,r(13,q)})}const Qe=a=>_==="color-sketch"?le(a):be(a,!0,"pizda");function Le(a){ge.call(this,t,a)}function Ue(a){L[a?"unshift":"push"](()=>{R=a,r(10,R),r(0,s)})}const ae=a=>(ie(a),r(1,_="editor")),me=()=>r(1,_="select");function ye(a){L[a?"unshift":"push"](()=>{N=a,r(19,N)})}function Ce(a){L[a?"unshift":"push"](()=>{q=a,r(13,q)})}function Ge(a){A=a,r(2,A)}function Ne(a){n=a,r(23,n),r(12,O),r(5,c),r(1,_)}const Ze=()=>q.undo(),Ke=()=>q.redraw();function $e(a){A=a,r(2,A)}function xe(a){n=a,r(23,n),r(12,O),r(5,c),r(1,_)}function et(){x=this.offsetHeight,_e=this.offsetWidth,r(20,x),r(21,_e)}return t.$$set=a=>{"value"in a&&r(0,s=a.value),"label"in a&&r(3,u=a.label),"show_label"in a&&r(4,i=a.show_label),"source"in a&&r(5,c=a.source),"tool"in a&&r(1,_=a.tool),"shape"in a&&r(6,m=a.shape),"streaming"in a&&r(7,f=a.streaming),"pending"in a&&r(8,h=a.pending),"mirror_webcam"in a&&r(9,d=a.mirror_webcam),"brush_radius"in a&&r(2,A=a.brush_radius),"$$scope"in a&&r(63,o=a.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&S("change",s),t.$$.dirty[0]&2048&&S("drag",b),t.$$.dirty[0]&34&&(c==="canvas"&&_==="sketch"?r(12,O="bw-sketch"):_==="color-sketch"?r(12,O="color-sketch"):(c==="upload"||c==="webcam")&&_==="sketch"?r(12,O="mask"):r(12,O="editor")),t.$$.dirty[0]&4096&&r(23,n=O=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&r(22,Z=void 0),t.$$.dirty[0]&1025&&R&&(s?(r(10,R.image=s,R),R.create()):R.destroy())},[s,_,A,u,i,c,m,f,h,d,R,b,O,q,v,se,oe,ue,k,N,x,_e,Z,n,le,ie,be,J,F,l,ce,Se,He,Ye,pe,Xe,Me,Ve,Te,Ee,Be,ve,De,he,Re,Je,qe,Ae,je,Qe,Le,Ue,ae,me,ye,Ce,Ge,Ne,Ze,Ke,$e,xe,et,o]}class Ur extends re{constructor(e){super(),ne(this,e,Lr,jr,$,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2},null,[-1,-1,-1])}}function Nr(t){let e,r,n,l,o,s,u;return n=new Ie({props:{Icon:er,label:"Download"}}),{c(){e=P("div"),r=P("a"),T(n.$$.fragment),l=U(),o=P("img"),g(r,"href",t[0]),g(r,"target",window.__is_colab__?"_blank":null),g(r,"download","image"),g(e,"class","download svelte-kt1jzh"),V(o.src,s=t[0])||g(o,"src",s),g(o,"alt",""),g(o,"class","svelte-kt1jzh")},m(i,c){y(i,e,c),Y(e,r),E(n,r,null),y(i,l,c),y(i,o,c),u=!0},p(i,c){(!u||c&1)&&g(r,"href",i[0]),(!u||c&1&&!V(o.src,s=i[0]))&&g(o,"src",s)},i(i){u||(p(n.$$.fragment,i),u=!0)},o(i){w(n.$$.fragment,i),u=!1},d(i){i&&C(e),B(n),i&&C(l),i&&C(o)}}}function Pr(t){let e,r;return e=new xt({props:{size:"large",unpadded_box:!0,$$slots:{default:[Fr]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,l){const o={};l&16&&(o.$$scope={dirty:l,ctx:n}),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){B(e,n)}}}function Fr(t){let e,r;return e=new Fe({}),{c(){T(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){B(e,n)}}}function Or(t){let e,r,n,l,o,s;e=new Mt({props:{show_label:t[2],Icon:Fe,label:t[1]||"Image"}});const u=[Pr,Nr],i=[];function c(_,m){return _[0]===null?0:1}return n=c(t),l=i[n]=u[n](t),{c(){T(e.$$.fragment),r=U(),l.c(),o=fe()},m(_,m){E(e,_,m),y(_,r,m),i[n].m(_,m),y(_,o,m),s=!0},p(_,[m]){const f={};m&4&&(f.show_label=_[2]),m&2&&(f.label=_[1]||"Image"),e.$set(f);let h=n;n=c(_),n===h?i[n].p(_,m):(ee(),w(i[h],1,1,()=>{i[h]=null}),te(),l=i[n],l?l.p(_,m):(l=i[n]=u[n](_),l.c()),p(l,1),l.m(o.parentNode,o))},i(_){s||(p(e.$$.fragment,_),p(l),s=!0)},o(_){w(e.$$.fragment,_),w(l),s=!1},d(_){B(e,_),_&&C(r),i[n].d(_),_&&C(o)}}}function Wr(t,e,r){let{value:n}=e,{label:l=void 0}=e,{show_label:o}=e;const s=de();return t.$$set=u=>{"value"in u&&r(0,n=u.value),"label"in u&&r(1,l=u.label),"show_label"in u&&r(2,o=u.show_label)},t.$$.update=()=>{t.$$.dirty&1&&n&&s("change",n)},[n,l,o]}class Hr extends re{constructor(e){super(),ne(this,e,Wr,Or,$,{value:0,label:1,show_label:2})}}function Yr(t){let e,r,n;function l(s){t[17](s)}let o={brush_radius:t[14],shape:t[13],source:t[5],tool:t[6],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[12],$$slots:{default:[Vr]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.value=t[0]),e=new Ur({props:o}),L.push(()=>G(e,"value",l)),e.$on("edit",t[18]),e.$on("clear",t[19]),e.$on("change",t[20]),e.$on("stream",t[21]),e.$on("drag",t[22]),e.$on("upload",t[23]),e.$on("error",t[24]),{c(){T(e.$$.fragment)},m(s,u){E(e,s,u),n=!0},p(s,u){const i={};u&16384&&(i.brush_radius=s[14]),u&8192&&(i.shape=s[13]),u&32&&(i.source=s[5]),u&64&&(i.tool=s[6]),u&128&&(i.label=s[7]),u&256&&(i.show_label=s[8]),u&1024&&(i.pending=s[10]),u&512&&(i.streaming=s[9]),u&4096&&(i.mirror_webcam=s[12]),u&67108864&&(i.$$scope={dirty:u,ctx:s}),!r&&u&1&&(r=!0,i.value=s[0],Q(()=>r=!1)),e.$set(i)},i(s){n||(p(e.$$.fragment,s),n=!0)},o(s){w(e.$$.fragment,s),n=!1},d(s){B(e,s)}}}function Xr(t){let e,r;return e=new Hr({props:{value:t[0],label:t[7],show_label:t[8]}}),{c(){T(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,l){const o={};l&1&&(o.value=n[0]),l&128&&(o.label=n[7]),l&256&&(o.show_label=n[8]),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){B(e,n)}}}function Vr(t){let e,r;return e=new tr({props:{type:"image"}}),{c(){T(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p:X,i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){B(e,n)}}}function Jr(t){let e,r,n,l,o,s;const u=[t[1]];let i={};for(let f=0;f<u.length;f+=1)i=Ot(i,u[f]);e=new Wt({props:i});const c=[Xr,Yr],_=[];function m(f,h){return f[15]==="static"?0:1}return n=m(t),l=_[n]=c[n](t),{c(){T(e.$$.fragment),r=U(),l.c(),o=fe()},m(f,h){E(e,f,h),y(f,r,h),_[n].m(f,h),y(f,o,h),s=!0},p(f,h){const d=h&2?Ht(u,[Yt(f[1])]):{};e.$set(d);let A=n;n=m(f),n===A?_[n].p(f,h):(ee(),w(_[A],1,1,()=>{_[A]=null}),te(),l=_[n],l?l.p(f,h):(l=_[n]=c[n](f),l.c()),p(l,1),l.m(o.parentNode,o))},i(f){s||(p(e.$$.fragment,f),p(l),s=!0)},o(f){w(e.$$.fragment,f),w(l),s=!1},d(f){B(e,f),f&&C(r),_[n].d(f),f&&C(o)}}}function Qr(t){let e,r;return e=new Xt({props:{visible:t[4],variant:t[15]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[16]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],style:{height:t[11].height,width:t[11].width},allow_overflow:!1,$$slots:{default:[Jr]},$$scope:{ctx:t}}}),{c(){T(e.$$.fragment)},m(n,l){E(e,n,l),r=!0},p(n,[l]){const o={};l&16&&(o.visible=n[4]),l&32801&&(o.variant=n[15]==="dynamic"&&n[0]===null&&n[5]==="upload"?"dashed":"solid"),l&65536&&(o.border_mode=n[16]?"focus":"base"),l&4&&(o.elem_id=n[2]),l&8&&(o.elem_classes=n[3]),l&2048&&(o.style={height:n[11].height,width:n[11].width}),l&67237859&&(o.$$scope={dirty:l,ctx:n}),e.$set(o)},i(n){r||(p(e.$$.fragment,n),r=!0)},o(n){w(e.$$.fragment,n),r=!1},d(n){B(e,n)}}}function Gr(t,e,r){let{elem_id:n=""}=e,{elem_classes:l=[]}=e,{visible:o=!0}=e,{value:s=null}=e,{source:u="upload"}=e,{tool:i="editor"}=e,{label:c}=e,{show_label:_}=e,{streaming:m}=e,{pending:f}=e,{style:h={}}=e,{mirror_webcam:d}=e,{shape:A}=e,{brush_radius:q}=e,{loading_status:R}=e,{mode:v}=e;const se=de();let le;function ie(k){s=k,r(0,s)}function be(k){ge.call(this,t,k)}function S(k){ge.call(this,t,k)}function b(k){ge.call(this,t,k)}function J(k){ge.call(this,t,k)}const F=({detail:k})=>r(16,le=k);function oe(k){ge.call(this,t,k)}const ue=({detail:k})=>{r(1,R=R||{}),r(1,R.status="error",R),r(1,R.message=k,R)};return t.$$set=k=>{"elem_id"in k&&r(2,n=k.elem_id),"elem_classes"in k&&r(3,l=k.elem_classes),"visible"in k&&r(4,o=k.visible),"value"in k&&r(0,s=k.value),"source"in k&&r(5,u=k.source),"tool"in k&&r(6,i=k.tool),"label"in k&&r(7,c=k.label),"show_label"in k&&r(8,_=k.show_label),"streaming"in k&&r(9,m=k.streaming),"pending"in k&&r(10,f=k.pending),"style"in k&&r(11,h=k.style),"mirror_webcam"in k&&r(12,d=k.mirror_webcam),"shape"in k&&r(13,A=k.shape),"brush_radius"in k&&r(14,q=k.brush_radius),"loading_status"in k&&r(1,R=k.loading_status),"mode"in k&&r(15,v=k.mode)},t.$$.update=()=>{t.$$.dirty&1&&r(0,s=s||null),t.$$.dirty&1&&se("change")},[s,R,n,l,o,u,i,c,_,m,f,h,d,A,q,v,le,ie,be,S,b,J,F,oe,ue]}class Zr extends re{constructor(e){super(),ne(this,e,Gr,Qr,$,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,style:11,mirror_webcam:12,shape:13,brush_radius:14,loading_status:1,mode:15})}}var cn=Zr;const hn=["static","dynamic"],mn=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{cn as Component,bn as ExampleComponent,mn as document,hn as modes};
//# sourceMappingURL=index.16fa4240.js.map
